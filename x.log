05:15:19 INFO:root:Logging to /lambda/nfs/xnotes/communitynotes-mod/scoring/src/../logs/run_20260222_051519.log
05:15:19 INFO:birdwatch.runner:scorer python version: 3.10.12 (main, Aug 15 2025, 14:32:43) [GCC 11.4.0]
05:15:19 INFO:birdwatch.runner:scorer pandas version: 2.2.2
05:15:19 INFO:birdwatch.dev_cache:Dev cache enabled: /lambda/nfs/xnotes/communitynotes-mod/scoring/src/.cache10
05:15:19 INFO:birdwatch.runner:beginning scorer execution
05:15:19 INFO:birdwatch.dev_cache:Cache miss: 'runner_data' (no file at /lambda/nfs/xnotes/communitynotes-mod/scoring/src/.cache10/runner_data.pkl)
05:15:45 INFO:birdwatch.process_data:Read notes for 2380443 notes
05:15:54 INFO:birdwatch.process_data:Timestamp of latest rating in data: 2026-02-01 23:02:41.892000
05:15:55 INFO:birdwatch.process_data:Timestamp of latest note in data: 2026-02-01 23:01:46.167000
05:15:55 INFO:birdwatch.process_data:Removing duplicate ratings for 197174531 ratings
05:16:51 INFO:birdwatch.process_data:Removed 0 duplicate ratings, 197174531 remaining
05:16:51 INFO:birdwatch.process_data:Removed duplicate ratings for 197174531 ratings
05:16:54 INFO:birdwatch.process_data:Computed helpful num for 197174531 ratings
05:17:22 INFO:birdwatch.process_data:Filtered out ratings with no helpful num for 197173932 ratings
05:17:22 INFO:birdwatch.process_data:Computed helpful num for 197173932 ratings
05:17:31 INFO:birdwatch.process_data:Total raters: 1371306
05:17:31 INFO:birdwatch.process_data:Identifying high volume raters
05:17:31 INFO:birdwatch.process_data:Total ratings: 197173932
05:17:32 INFO:birdwatch.process_data:High volume threshold for 7 days: 170.0
05:17:32 INFO:birdwatch.process_data:High volume raters for 7 days: 255
05:17:35 INFO:birdwatch.process_data:High volume threshold for 28 days: 558.0
05:17:35 INFO:birdwatch.process_data:High volume raters for 28 days: 465
05:17:39 INFO:birdwatch.process_data:Total high volume raters: 495
05:17:39 INFO:birdwatch.process_data:Total ratings: 197173932
05:17:39 INFO:birdwatch.process_data:Total ratings from high volume raters: 5089385
05:17:39 INFO:birdwatch.process_data:Tagged high volume raters for 197173932 ratings
05:17:45 INFO:birdwatch.note_status_history:total notes added to noteStatusHistory: 147866
05:18:08 INFO:birdwatch.process_data:Mapped note status history for 197173932 ratings
05:18:20 INFO:birdwatch.process_data:added deleted note key column
05:18:27 INFO:birdwatch.process_data:added not deleted misleading key column
05:18:28 INFO:birdwatch.process_data:added deleted but in note status history key column
05:18:28 INFO:birdwatch.process_data:added deleted not in note status history column
05:18:28 INFO:birdwatch.process_data:added not deleted not misleading old UI column
05:18:28 INFO:birdwatch.process_data:added not deleted not misleading new UI column
05:18:32 INFO:birdwatch.process_data:Preprocess Data: Filter misleading notes, starting with 197173932 ratings on 2430552 notes
05:18:36 INFO:birdwatch.process_data:  Keeping 143671330 ratings on 1649121 misleading notes
05:18:38 INFO:birdwatch.process_data:  Keeping 17573322 ratings on 274169 deleted notes that were previously scored (in note status history)
05:18:38 INFO:birdwatch.process_data:  Removing 54931 ratings on 2753 older notes that aren't deleted, but are not-misleading.
05:18:38 INFO:birdwatch.process_data:  Removing 12325 ratings on 1477 notes that were deleted and not in note status history (e.g. old).
05:19:33 INFO:birdwatch.process_data:Num Ratings: 197106676, Num Unique Notes Rated: 2426322, Num Unique Raters: 1371241
05:19:34 INFO:birdwatch.process_data:Preprocessed notes for 2380443 notes
05:19:52 INFO:birdwatch.runner:ratings reduced from 197106676 to 19710668
05:20:04 INFO:birdwatch.runner:Participant IDs converted from strings to integers.
05:20:18 INFO:birdwatch.dev_cache:Saved cache 'runner_data' (3153.4 MB, 14.0s) -> /lambda/nfs/xnotes/communitynotes-mod/scoring/src/.cache10/runner_data.pkl
05:20:18 INFO:birdwatch.process_data:Called filter_input_data_for_testing.
        Notes: 2380443, Ratings: 19710668. Max note createdAt: 2026-02-01 23:01:46.167000; Max rating createAt: 2026-02-01 23:02:39.668000
05:20:18 INFO:birdwatch.process_data:After filtering notes and ratings after particular timestamp (=None). 
        Notes: 2380443, Ratings: 19710668. Max note createdAt: 2026-02-01 23:01:46.167000; Max rating createAt: 2026-02-01 23:02:39.668000
05:20:18 INFO:birdwatch.process_data:After filtering ratings after first status (plus None hours) for notes created in last 14 days. 
        Notes: 2380443, Ratings: 19710668. Max note createdAt: 2026-02-01 23:01:46.167000; Max rating createAt: 2026-02-01 23:02:39.668000
05:20:18 INFO:birdwatch.process_data:After filtering prescoring notes and ratings to simulate a delay of None hours: 
        Notes: 2380443, Ratings: 19710668. Max note createdAt: 2026-02-01 23:01:46.167000; Max rating createAt: 2026-02-01 23:02:39.668000
05:20:18 INFO:birdwatch.dev_cache:Cache miss: 'pre_get_scorers' (no file at /lambda/nfs/xnotes/communitynotes-mod/scoring/src/.cache10/pre_get_scorers.pkl)
05:20:42 INFO:birdwatch.constants:Compute pair counts dict elapsed time: 7.17 secs (0.12 mins)
05:20:42 INFO:birdwatch.constants:Compute PMI and minSim elapsed time: 0.00 secs (0.00 mins)
05:20:42 INFO:birdwatch.constants:Delete unneeded pairs from pairCountsDict elapsed time: 0.00 secs (0.00 mins)
05:20:42 INFO:birdwatch.constants:Aggregate into cliques by post selection similarity elapsed time: 0.00 secs (0.00 mins)
05:20:42 INFO:birdwatch.constants:Compute Post Selection Similarity elapsed time: 23.77 secs (0.40 mins)
05:20:42 INFO:birdwatch.quasi_clique_detection:initial rating length: 19710668
05:20:50 INFO:birdwatch.quasi_clique_detection:ratings after merges: 17952586
05:20:50 INFO:birdwatch.quasi_clique_detection:recent ratings: 1700814
05:20:50 INFO:birdwatch.quasi_clique_detection:ratings on non-deleted tweets: 1700814
05:20:50 INFO:birdwatch.quasi_clique_detection:ratings on misleading posts: 1413782
05:20:51 INFO:birdwatch.quasi_clique_detection:Total pair events: 29,036,939 across 202,069 groups
05:20:52 INFO:birdwatch.quasi_clique_detection:ratings after filter to raters included in pair counts: 131964
05:20:52 INFO:birdwatch.quasi_clique_detection:Prepared grow-clique arrays: 1,525 raters, 52,660 actions, 34,001 tweets, 131,964 unique (rater,action) pairs
05:20:52 INFO:birdwatch.quasi_clique_detection:orig raterPairCounts: 4643
05:20:52 INFO:birdwatch.quasi_clique_detection:pruned raterPairCounts: 0
05:20:52 INFO:birdwatch.constants:Compute Quasi-Cliques elapsed time: 10.27 secs (0.17 mins)
05:20:52 INFO:birdwatch.run_scoring:postSelectionSimilarityValues: 74
05:20:52 INFO:birdwatch.run_scoring:quasiCliques: 0
05:20:52 INFO:birdwatch.run_scoring:result: 74
05:20:52 INFO:birdwatch.run_scoring:logging environment variables
05:20:52 INFO:birdwatch.run_scoring:notes total RAM: 188055369 bytes (0.188 GB)
                                    column     dtype       RAM
0                                   noteId     int64  19043544
1                  noteAuthorParticipantId     int64  19043544
2                          createdAtMillis     int64  19043544
3                                  tweetId    object  19043544
4                           classification    object  19043544
5                               believable  category   2380567
6                                  harmful  category   2380567
7                     validationDifficulty  category   2380567
8                          misleadingOther      Int8   4760886
9                   misleadingFactualError      Int8   4760886
10              misleadingManipulatedMedia      Int8   4760886
11           misleadingOutdatedInformation      Int8   4760886
12       misleadingMissingImportantContext      Int8   4760886
13         misleadingUnverifiedClaimAsFact      Int8   4760886
14                        misleadingSatire      Int8   4760886
15                      notMisleadingOther      Int8   4760886
16           notMisleadingFactuallyCorrect      Int8   4760886
17  notMisleadingOutdatedButNotWhenWritten      Int8   4760886
18              notMisleadingClearlySatire      Int8   4760886
19            notMisleadingPersonalOpinion      Int8   4760886
20                      trustworthySources      Int8   4760886
21                                 summary    object  19043544
22                             isMediaNote      Int8   4760886
05:20:52 INFO:birdwatch.run_scoring:ratings total RAM: 1911935052 bytes (1.912 GB)
                                  column     dtype        RAM
0                                  agree      Int8   39421336
1                        createdAtMillis     int64  157685344
2                               disagree      Int8   39421336
3                                helpful      Int8   39421336
4                  helpfulAddressesClaim      Int8   39421336
5                           helpfulClear      Int8   39421336
6                      helpfulEmpathetic      Int8   39421336
7                     helpfulGoodSources      Int8   39421336
8                helpfulImportantContext      Int8   39421336
9                     helpfulInformative      Int8   39421336
10                            helpfulNum   float64  157685344
11                          helpfulOther      Int8   39421336
12               helpfulUnbiasedLanguage      Int8   39421336
13                  helpfulUniqueContext      Int8   39421336
14                      helpfulnessLevel  category   19710800
15                       highVolumeRater      bool   19710668
16                            notHelpful      Int8   39421336
17       notHelpfulArgumentativeOrBiased      Int8   39421336
18            notHelpfulHardToUnderstand      Int8   39421336
19                   notHelpfulIncorrect      Int8   39421336
20           notHelpfulIrrelevantSources      Int8   39421336
21            notHelpfulMissingKeyPoints      Int8   39421336
22               notHelpfulNoteNotNeeded      Int8   39421336
23                    notHelpfulOffTopic      Int8   39421336
24          notHelpfulOpinionSpeculation      Int8   39421336
25    notHelpfulOpinionSpeculationOrBias      Int8   39421336
26                       notHelpfulOther      Int8   39421336
27                    notHelpfulOutdated      Int8   39421336
28  notHelpfulSourcesMissingOrUnreliable      Int8   39421336
29       notHelpfulSpamHarassmentOrAbuse      Int8   39421336
30                                noteId     int64  157685344
31                        ratedOnTweetId     int64  157685344
32                    raterParticipantId     int64  157685344
33                  ratingSourceBucketed  category   19710792
34                               version      Int8   39421336
05:20:52 INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 349023508 bytes (0.349 GB)
                                            column     dtype       RAM
0                                           noteId     int64  21644704
1                          noteAuthorParticipantId     int64  21644704
2                                  createdAtMillis   float64  21644704
3               timestampMillisOfFirstNonNMRStatus   float64  21644704
4                                firstNonNMRStatus  category   2705712
5                   timestampMillisOfCurrentStatus   float64  21644704
6                                    currentStatus  category   2705720
7              timestampMillisOfLatestNonNMRStatus   float64  21644704
8                           mostRecentNonNMRStatus  category   2705712
9                      timestampMillisOfStatusLock   float64  21644704
10                                    lockedStatus  category   2705720
11                      timestampMillisOfRetroLock   float64  21644704
12                               currentCoreStatus  category   2705800
13                          currentExpansionStatus  category   2705800
14                              currentGroupStatus  category   2705792
15                                currentDecidedBy  category   2706900
16                            currentModelingGroup   float64  21644704
17         timestampMillisOfMostRecentStatusChange   float64  21644704
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  21644704
19                         currentMultiGroupStatus  category   2705792
20                       currentModelingMultiGroup   float64  21644704
21             timestampMinuteOfFinalScoringOutput   float64  21644704
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  21644704
23                                  classification    object  21644704
05:20:52 INFO:birdwatch.run_scoring:userEnrollment total RAM: 78201795 bytes (0.078 GB)
                           column     dtype       RAM
0                   participantId     int64  10975672
1                 enrollmentState    object  10975672
2  successfulRatingNeededToEarnIn     int64  10975672
3      timestampOfLastStateChange     int64  10975672
4          timestampOfLastEarnOut   float64  10975672
5              modelingPopulation  category   1372091
6                   modelingGroup   float64  10975672
7          numberOfTimesEarnedOut     int64  10975672
05:20:52 INFO:birdwatch.constants:Logging Prescoring Inputs Initial RAM usage elapsed time: 0.04 secs (0.00 mins)
05:21:15 INFO:birdwatch.constants:Get Note Topics: Prepare Post Text elapsed time: 22.40 secs (0.37 mins)
05:22:02 INFO:birdwatch.topic_model:  Notes unassigned due to multiple matches: 2103
05:22:02 INFO:birdwatch.constants:Get Note Topics: Make Seed Labels elapsed time: 47.23 secs (0.79 mins)
05:25:05 INFO:birdwatch.topic_model:  Initial vocabulary length: 3376265
05:25:05 INFO:birdwatch.topic_model:  Total tokens to filter: 34
05:25:13 INFO:birdwatch.topic_model:  Total identified stopwords: 2747
05:25:14 INFO:birdwatch.constants:Get Note Topics: Get Stop Words elapsed time: 191.40 secs (3.19 mins)
05:36:22 INFO:birdwatch.constants:Get Note Topics: Train Model elapsed time: 668.42 secs (11.14 mins)
05:36:22 INFO:birdwatch.topic_model:Assigning notes to topics:
05:36:44 INFO:birdwatch.constants:Get Note Topics: Prepare Post Text elapsed time: 21.87 secs (0.36 mins)
05:38:00 INFO:birdwatch.topic_model:  Balanced accuracy on raw predictions: 0.6749756537466575
05:38:01 INFO:birdwatch.topic_model:  Post Topic assignment results: [1358321   34019   61184    4012  108792]
05:38:03 INFO:birdwatch.constants:Get Note Topics: Merge and assign predictions elapsed time: 2.28 secs (0.04 mins)
05:38:03 INFO:birdwatch.topic_model:  Note Topic assignment results:
noteTopic
Scams              157192
GazaConflict       124082
UkraineConflict     58324
MessiRonaldo         6353
Name: count, dtype: int64
05:38:03 INFO:birdwatch.constants:Get Note Topics: Predict elapsed time: 78.84 secs (1.31 mins)
05:38:03 INFO:birdwatch.constants:Note Topic Assignment elapsed time: 1030.42 secs (17.17 mins)
05:38:14 INFO:birdwatch.run_scoring:ratings summary before PSS: 8bf4debef97566d51243ba3be0c3ba0641f23081e9f8e0e9a81812451e32b995
05:38:14 INFO:birdwatch.run_scoring:Post Selection Similarity Prescoring: begin with 19710668 ratings.
05:38:14 INFO:birdwatch.post_selection_similarity:Total ratings prior to applying post selection similarity: 19710668
05:38:14 INFO:birdwatch.post_selection_similarity:Summary of postSelectionSimilarityValues: 
postSelectionValue    74
quasiCliqueValue       0
dtype: Int64
05:38:14 INFO:birdwatch.post_selection_similarity:correlatedRater set on 0 ratings from 0 unique raters
05:38:22 INFO:birdwatch.post_selection_similarity:Total ratings after to applying post selection similarity: 19679338
05:38:22 INFO:birdwatch.run_scoring:Post Selection Similarity Prescoring: 19679338 ratings remaining.
05:38:22 INFO:birdwatch.constants:Filter ratings by Post Selection Similarity elapsed time: 8.78 secs (0.15 mins)
05:38:33 INFO:birdwatch.run_scoring:ratings summary after PSS: e4fda33fa987f92dc5c4a46f45ce1aea57a5cbe901cb9dd630c618098e30b6dc
05:39:27 INFO:birdwatch.dev_cache:Saved cache 'pre_get_scorers' (4322.8 MB, 53.9s) -> /lambda/nfs/xnotes/communitynotes-mod/scoring/src/.cache10/pre_get_scorers.pkl
05:39:27 INFO:birdwatch.run_scoring:User IDs for ratings, noteStatusHistory and userEnrollment converted to Int64Dtype.
05:39:27 INFO:birdwatch.run_scoring:notes total RAM: 188055369 bytes (0.188 GB)
                                    column     dtype       RAM
0                                   noteId     int64  19043544
1                  noteAuthorParticipantId     int64  19043544
2                          createdAtMillis     int64  19043544
3                                  tweetId    object  19043544
4                           classification    object  19043544
5                               believable  category   2380567
6                                  harmful  category   2380567
7                     validationDifficulty  category   2380567
8                          misleadingOther      Int8   4760886
9                   misleadingFactualError      Int8   4760886
10              misleadingManipulatedMedia      Int8   4760886
11           misleadingOutdatedInformation      Int8   4760886
12       misleadingMissingImportantContext      Int8   4760886
13         misleadingUnverifiedClaimAsFact      Int8   4760886
14                        misleadingSatire      Int8   4760886
15                      notMisleadingOther      Int8   4760886
16           notMisleadingFactuallyCorrect      Int8   4760886
17  notMisleadingOutdatedButNotWhenWritten      Int8   4760886
18              notMisleadingClearlySatire      Int8   4760886
19            notMisleadingPersonalOpinion      Int8   4760886
20                      trustworthySources      Int8   4760886
21                                 summary    object  19043544
22                             isMediaNote      Int8   4760886
05:39:27 INFO:birdwatch.run_scoring:ratings total RAM: 2263124126 bytes (2.263 GB)
                                  column     dtype        RAM
0                                  agree      Int8   39358676
1                        createdAtMillis     int64  157434704
2                               disagree      Int8   39358676
3                                helpful      Int8   39358676
4                  helpfulAddressesClaim      Int8   39358676
5                           helpfulClear      Int8   39358676
6                      helpfulEmpathetic      Int8   39358676
7                     helpfulGoodSources      Int8   39358676
8                helpfulImportantContext      Int8   39358676
9                     helpfulInformative      Int8   39358676
10                            helpfulNum   float64  157434704
11                          helpfulOther      Int8   39358676
12               helpfulUnbiasedLanguage      Int8   39358676
13                  helpfulUniqueContext      Int8   39358676
14                      helpfulnessLevel  category   19679470
15                       highVolumeRater      bool   19679338
16                            notHelpful      Int8   39358676
17       notHelpfulArgumentativeOrBiased      Int8   39358676
18            notHelpfulHardToUnderstand      Int8   39358676
19                   notHelpfulIncorrect      Int8   39358676
20           notHelpfulIrrelevantSources      Int8   39358676
21            notHelpfulMissingKeyPoints      Int8   39358676
22               notHelpfulNoteNotNeeded      Int8   39358676
23                    notHelpfulOffTopic      Int8   39358676
24          notHelpfulOpinionSpeculation      Int8   39358676
25    notHelpfulOpinionSpeculationOrBias      Int8   39358676
26                       notHelpfulOther      Int8   39358676
27                    notHelpfulOutdated      Int8   39358676
28  notHelpfulSourcesMissingOrUnreliable      Int8   39358676
29       notHelpfulSpamHarassmentOrAbuse      Int8   39358676
30                                noteId     int64  157434704
31                        ratedOnTweetId     int64  157434704
32                    raterParticipantId     Int64  177114042
33                  ratingSourceBucketed  category   19679462
34                               version      Int8   39358676
35                       correlatedRater      bool   19679338
36                    postSelectionValue   float64  157434704
37        postSelectionValue_note_author   float64  157434704
05:39:27 INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 351729096 bytes (0.352 GB)
                                            column     dtype       RAM
0                                           noteId     int64  21644704
1                          noteAuthorParticipantId     Int64  24350292
2                                  createdAtMillis   float64  21644704
3               timestampMillisOfFirstNonNMRStatus   float64  21644704
4                                firstNonNMRStatus  category   2705712
5                   timestampMillisOfCurrentStatus   float64  21644704
6                                    currentStatus  category   2705720
7              timestampMillisOfLatestNonNMRStatus   float64  21644704
8                           mostRecentNonNMRStatus  category   2705712
9                      timestampMillisOfStatusLock   float64  21644704
10                                    lockedStatus  category   2705720
11                      timestampMillisOfRetroLock   float64  21644704
12                               currentCoreStatus  category   2705800
13                          currentExpansionStatus  category   2705800
14                              currentGroupStatus  category   2705792
15                                currentDecidedBy  category   2706900
16                            currentModelingGroup   float64  21644704
17         timestampMillisOfMostRecentStatusChange   float64  21644704
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  21644704
19                         currentMultiGroupStatus  category   2705792
20                       currentModelingMultiGroup   float64  21644704
21             timestampMinuteOfFinalScoringOutput   float64  21644704
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  21644704
23                                  classification    object  21644704
05:39:27 INFO:birdwatch.run_scoring:userEnrollment total RAM: 79573754 bytes (0.080 GB)
                           column     dtype       RAM
0                   participantId     Int64  12347631
1                 enrollmentState    object  10975672
2  successfulRatingNeededToEarnIn     int64  10975672
3      timestampOfLastStateChange     int64  10975672
4          timestampOfLastEarnOut   float64  10975672
5              modelingPopulation  category   1372091
6                   modelingGroup   float64  10975672
7          numberOfTimesEarnedOut     int64  10975672
05:39:27 INFO:birdwatch.constants:Logging Prescoring Inputs RAM usage before _run_scorers elapsed time: 0.04 secs (0.00 mins)
05:39:31 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFCoreWithTopicsScorer set to: 12
05:39:31 INFO:birdwatch.scorer:Filtering ratings for MFCoreWithTopicsScorer.  Original rating length: 19679338
05:39:31 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
05:39:35 INFO:birdwatch.scorer:  Ratings without assigned group: 0
05:39:38 INFO:birdwatch.scorer:  Ratings after group filter: 16919910
05:39:38 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Filter input elapsed time: 7.19 secs (0.12 mins)
05:39:46 INFO:birdwatch.mf_base_scorer:ratings summary MFCoreWithTopicsScorer: 163443fa16a0aab2d4ba20d91caabad3cb6fcf22bed2b323d1b40c33dd511ee5
05:39:50 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 13006990, Num Unique Notes Rated: 736749, Num Unique Raters: 284437
05:39:50 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Prepare ratings elapsed time: 3.35 secs (0.06 mins)
05:39:56 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFCoreWithTopicsScorer: 4cc6d869a764d0f8a6afdc2a40982617dab566887708e2d79db1011f7ff183fa
05:39:57 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFCoreWithTopicsScorer: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
05:39:57 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFCoreWithTopicsScorer: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
05:40:00 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Prepare data for stable initialization elapsed time: 2.32 secs (0.04 mins)
05:40:00 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:40:00 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:40:00 INFO:birdwatch.wandb_utils:W&B is disabled
05:40:00 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:40:00 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:40:00 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:40:00 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:40:00 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:40:00 DEBUG:wandb:no default config file found in config-defaults.yaml
05:40:00 INFO:birdwatch.matrix_factorization:------------------
05:40:00 INFO:birdwatch.matrix_factorization:Users: 95324, Notes: 123599
05:40:00 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
05:40:03 INFO:birdwatch.matrix_factorization:cuda:0
05:40:04 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 16.342009239556955
05:40:04 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 21.189375183584406
05:40:04 INFO:birdwatch.matrix_factorization:epoch 0 6.564961910247803
05:40:04 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.120167255401611
05:40:04 INFO:birdwatch.matrix_factorization:epoch 20 0.2663998007774353
05:40:04 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.19798290729522705
05:40:05 INFO:birdwatch.matrix_factorization:epoch 40 0.10663425922393799
05:40:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07280322164297104
05:40:05 INFO:birdwatch.matrix_factorization:epoch 60 0.08685918897390366
05:40:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.057120054960250854
05:40:05 INFO:birdwatch.matrix_factorization:epoch 80 0.0841759443283081
05:40:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05452416092157364
05:40:05 INFO:birdwatch.matrix_factorization:epoch 100 0.08381463587284088
05:40:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05437839403748512
05:40:05 INFO:birdwatch.matrix_factorization:epoch 120 0.08376932144165039
05:40:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.054369788616895676
05:40:05 INFO:birdwatch.matrix_factorization:Num epochs: 134
05:40:05 INFO:birdwatch.matrix_factorization:epoch 134 0.08376413583755493
05:40:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05440791696310043
05:40:05 INFO:birdwatch.matrix_factorization:Global Intercept: 0.14910976588726044
05:40:05 INFO:birdwatch.wandb_utils:Finishing W&B run
05:40:05 INFO:birdwatch.scorer:MFCoreWithTopicsScorer MF on stable-initialization subset elapsed time: 5.48 secs (0.09 mins)
05:40:05 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:40:05 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:40:05 INFO:birdwatch.wandb_utils:W&B is disabled
05:40:05 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:40:05 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:40:05 DEBUG:wandb:no default config file found in config-defaults.yaml
05:40:08 INFO:birdwatch.matrix_factorization:------------------
05:40:08 INFO:birdwatch.matrix_factorization:Users: 284437, Notes: 736749
05:40:08 INFO:birdwatch.matrix_factorization:initializing notes
05:40:08 INFO:birdwatch.matrix_factorization:initializing users
05:40:08 INFO:birdwatch.matrix_factorization:initialized global intercept
05:40:08 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
05:40:08 INFO:birdwatch.matrix_factorization:cuda:0
05:40:08 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 17.654574353002175
05:40:08 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 45.72889602970078
05:40:08 INFO:birdwatch.matrix_factorization:epoch 0 0.24838754534721375
05:40:08 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21067705750465393
05:40:09 INFO:birdwatch.matrix_factorization:epoch 20 0.10966749489307404
05:40:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07784084230661392
05:40:09 INFO:birdwatch.matrix_factorization:epoch 40 0.09966175258159637
05:40:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0672817975282669
05:40:10 INFO:birdwatch.matrix_factorization:epoch 60 0.09844131767749786
05:40:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0666053295135498
05:40:11 INFO:birdwatch.matrix_factorization:epoch 80 0.0982745885848999
05:40:11 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06659315526485443
05:40:11 INFO:birdwatch.matrix_factorization:epoch 100 0.09825170040130615
05:40:11 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06658247113227844
05:40:12 INFO:birdwatch.matrix_factorization:Num epochs: 117
05:40:12 INFO:birdwatch.matrix_factorization:epoch 117 0.0982469916343689
05:40:12 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0665830746293068
05:40:12 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17047300934791565
05:40:12 INFO:birdwatch.wandb_utils:Finishing W&B run
05:40:12 INFO:birdwatch.scorer:MFCoreWithTopicsScorer First full MF (initializated with stable-initialization) elapsed time: 6.81 secs (0.11 mins)
05:40:12 INFO:birdwatch.scorer:MFCoreWithTopicsScorer First MF/stable init elapsed time: 14.65 secs (0.24 mins)
05:40:12 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFCoreWithTopicsScorer
05:40:31 INFO:birdwatch.note_ratings:dropped 0 out of 14798563 ratings due to NaN factor.
05:41:37 INFO:birdwatch.note_ratings:dropped 0 out of 89584 population sampled ratings due to NaN factor.
05:41:38 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
05:41:38 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:41:38 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.62 secs (0.01 mins)
05:41:38 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
05:41:38 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.12 secs (0.00 mins)
05:41:39 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.74 secs (0.01 mins)
05:41:39 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
05:41:39 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
05:41:40 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
05:41:40 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
05:41:40 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:41:40 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
05:41:40 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
05:41:40 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:41:41 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
05:41:41 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
05:41:41 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
05:41:42 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.72 secs (0.01 mins)
05:42:28 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 46.50 secs (0.77 mins)
05:42:29 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Compute scored notes elapsed time: 136.38 secs (2.27 mins)
05:42:37 INFO:birdwatch.note_ratings:Total ratings: 16896842 post-tombstones and 23068 pre-tombstones
05:42:37 INFO:birdwatch.note_ratings:Total ratings created before statuses: 13497958, including 13483084 post-tombstones and 14874 pre-tombstones.
05:42:39 INFO:birdwatch.note_ratings:Total valid ratings: 706080
05:42:39 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Compute valid ratings elapsed time: 10.40 secs (0.17 mins)
05:42:39 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Helpfulness scores pre-harassment  elapsed time: 0.40 secs (0.01 mins)
05:42:41 INFO:birdwatch.helpfulness_scores:Unique Raters: 284437
05:42:41 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 356869
05:42:41 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 236941
05:42:41 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 165255
05:42:41 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 13006990
05:42:41 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 9082756
05:42:41 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Filtering by helpfulness score elapsed time: 1.35 secs (0.02 mins)
05:42:41 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
05:42:42 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    5567092
1     517118
dtype: int64
05:42:42 INFO:birdwatch.tag_consensus:Number of rows with no tag label 2997314
05:42:43 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 4847740, Num Unique Notes Rated: 374010, Num Unique Raters: 120089
05:42:43 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    4457310
1     390430
dtype: int64
05:42:43 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
05:42:43 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.08053856023631631
05:42:43 INFO:birdwatch.matrix_factorization:Using pos weight: 11.416412673206464 with BCEWithLogitsLoss
05:42:43 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:42:43 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:42:43 INFO:birdwatch.wandb_utils:W&B is disabled
05:42:43 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:42:43 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:42:44 DEBUG:wandb:no default config file found in config-defaults.yaml
05:42:44 INFO:birdwatch.matrix_factorization:------------------
05:42:44 INFO:birdwatch.matrix_factorization:Users: 120089, Notes: 374010
05:42:44 INFO:birdwatch.matrix_factorization:initializing notes
05:42:44 INFO:birdwatch.matrix_factorization:initializing users
05:42:44 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
05:42:44 INFO:birdwatch.matrix_factorization:cuda:0
05:42:44 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 12.961525092911954
05:42:44 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 40.36789381208937
05:42:44 INFO:birdwatch.matrix_factorization:epoch 0 3.2427566051483154
05:42:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.3868868350982666
05:42:45 INFO:birdwatch.matrix_factorization:epoch 20 0.6963207721710205
05:42:45 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3357393145561218
05:42:45 INFO:birdwatch.matrix_factorization:epoch 40 0.4334237575531006
05:42:45 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.25875136256217957
05:42:45 INFO:birdwatch.matrix_factorization:epoch 60 0.39496034383773804
05:42:45 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.24419571459293365
05:42:46 INFO:birdwatch.matrix_factorization:epoch 80 0.3893659710884094
05:42:46 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2423342615365982
05:42:46 INFO:birdwatch.matrix_factorization:epoch 100 0.3884323537349701
05:42:46 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.24193531274795532
05:42:46 INFO:birdwatch.matrix_factorization:epoch 120 0.38767439126968384
05:42:46 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.24132421612739563
05:42:47 INFO:birdwatch.matrix_factorization:epoch 140 0.38135284185409546
05:42:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23401568830013275
05:42:47 INFO:birdwatch.matrix_factorization:epoch 160 0.37964168190956116
05:42:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2333245426416397
05:42:47 INFO:birdwatch.matrix_factorization:epoch 180 0.3794039487838745
05:42:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23326244950294495
05:42:47 INFO:birdwatch.matrix_factorization:Num epochs: 188
05:42:47 INFO:birdwatch.matrix_factorization:epoch 188 0.37938937544822693
05:42:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23325295746326447
05:42:47 INFO:birdwatch.matrix_factorization:Global Intercept: -0.244604229927063
05:42:47 INFO:birdwatch.wandb_utils:Finishing W&B run
05:42:47 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Harassment tag consensus elapsed time: 6.52 secs (0.11 mins)
05:42:51 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Helpfulness scores post-harassment elapsed time: 0.90 secs (0.02 mins)
05:42:55 INFO:birdwatch.helpfulness_scores:Unique Raters: 284437
05:42:55 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 356869
05:42:55 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 234452
05:42:55 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 162766
05:42:55 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 13006990
05:42:55 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 8602557
05:42:58 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:42:58 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:42:58 INFO:birdwatch.wandb_utils:W&B is disabled
05:42:58 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:42:58 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:42:58 DEBUG:wandb:no default config file found in config-defaults.yaml
05:43:00 INFO:birdwatch.matrix_factorization:------------------
05:43:00 INFO:birdwatch.matrix_factorization:Users: 162766, Notes: 735995
05:43:00 INFO:birdwatch.matrix_factorization:initializing notes
05:43:00 INFO:birdwatch.matrix_factorization:initializing users
05:43:00 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
05:43:00 INFO:birdwatch.matrix_factorization:cuda:0
05:43:00 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 11.688336197936128
05:43:00 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 52.85229716279813
05:43:00 INFO:birdwatch.matrix_factorization:epoch 0 0.38519152998924255
05:43:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.31555378437042236
05:43:00 INFO:birdwatch.matrix_factorization:epoch 20 0.09552045166492462
05:43:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.060828108340501785
05:43:01 INFO:birdwatch.matrix_factorization:epoch 40 0.093321293592453
05:43:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06210477650165558
05:43:01 INFO:birdwatch.matrix_factorization:epoch 60 0.09233299642801285
05:43:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06025146320462227
05:43:02 INFO:birdwatch.matrix_factorization:epoch 80 0.09224151074886322
05:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06000366434454918
05:43:02 INFO:birdwatch.matrix_factorization:epoch 100 0.09222845733165741
05:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05986541882157326
05:43:02 INFO:birdwatch.matrix_factorization:Num epochs: 101
05:43:02 INFO:birdwatch.matrix_factorization:epoch 101 0.09222845733165741
05:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05986541882157326
05:43:02 INFO:birdwatch.matrix_factorization:Global Intercept: 0.1714170277118683
05:43:02 INFO:birdwatch.wandb_utils:Finishing W&B run
05:43:02 INFO:birdwatch.constants:Final round MF elapsed time: 8.23 secs (0.14 mins)
05:43:02 INFO:birdwatch.mf_base_scorer:In MFCoreWithTopicsScorer prescoring, about to call diligence with 8602557 final round ratings.
05:43:09 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
        raterParticipantId  internalRaterFactor1
0                        0              0.634012
1                        3             -0.474249
2                        5              0.711415
3                        7             -0.674596
4                       13             -0.691679
...                    ...                   ...
162761              920561             -0.173995
162762              927718             -0.183892
162763              938262              0.473631
162764              942797             -0.236160
162765              987081             -0.087282

[162766 rows x 2 columns]
05:43:09 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
05:43:09 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 162766, vs. num we are initializing: 162766
05:43:09 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
05:43:09 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 162766
05:43:09 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
05:43:09 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
05:43:09 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
05:43:09 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
05:43:09 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
05:43:09 INFO:birdwatch.reputation_matrix_factorization:Round 1:
05:43:09 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=17.339169 | time=0.0s
05:43:10 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.423113 | time=0.7s
05:43:11 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.949986 | time=1.5s
05:43:12 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.857634 | time=2.2s
05:43:12 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.825234 | time=2.9s
05:43:13 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.808890 | time=3.7s
05:43:14 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.799032 | time=4.4s
05:43:15 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.792575 | time=5.1s
05:43:15 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.788163 | time=5.9s
05:43:16 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.785025 | time=6.6s
05:43:17 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.782840 | time=7.3s
05:43:17 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.0601, device='cuda:0', requires_grad=True)
05:43:17 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
05:43:17 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.782780 | time=0.0s
05:43:17 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.598068 | time=0.7s
05:43:18 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.589464 | time=1.3s
05:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.588533 | time=2.0s
05:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.588498 | time=2.2s
05:43:19 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
05:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.476652 | time=0.0s
05:43:20 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.396881 | time=0.4s
05:43:20 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.395892 | time=0.9s
05:43:20 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.395853 | time=1.1s
05:43:20 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(1.0044, device='cuda:0', requires_grad=True)
05:43:20 INFO:birdwatch.diligence_model:Low diligence training loss: 2.7828, 1.5885, 0.3959
05:43:20 INFO:birdwatch.scorer:MFCoreWithTopicsScorer Low Diligence MF elapsed time: 18.42 secs (0.31 mins)
05:43:37 INFO:birdwatch.note_ratings:dropped 0 out of 14798563 ratings due to NaN factor.
05:44:40 INFO:birdwatch.note_ratings:dropped 0 out of 89584 population sampled ratings due to NaN factor.
05:44:41 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
05:44:41 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:44:42 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
05:44:42 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
05:44:42 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.12 secs (0.00 mins)
05:44:42 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.74 secs (0.01 mins)
05:44:42 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
05:44:42 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
05:44:43 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.63 secs (0.01 mins)
05:44:43 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
05:44:43 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
05:44:44 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
05:44:44 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
05:44:44 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:44:44 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
05:44:44 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
05:44:44 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
05:44:45 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.72 secs (0.01 mins)
05:45:34 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.57 secs (0.81 mins)
05:45:50 INFO:birdwatch.constants:MFCoreWithTopicsScorer: Compute tag thresholds for percentiles elapsed time: 15.81 secs (0.26 mins)
05:46:11 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFCoreScorer set to: 12
05:46:11 INFO:birdwatch.scorer:Filtering ratings for MFCoreScorer.  Original rating length: 19679338
05:46:14 INFO:birdwatch.scorer:  Ratings after topic filter: 16480113
05:46:16 INFO:birdwatch.scorer:  Ratings without assigned group: 0
05:46:18 INFO:birdwatch.scorer:  Ratings after group filter: 14269359
05:46:18 INFO:birdwatch.scorer:MFCoreScorer Filter input elapsed time: 7.18 secs (0.12 mins)
05:46:26 INFO:birdwatch.mf_base_scorer:ratings summary MFCoreScorer: dd80e919c1a7687757c85776573d52125171aff1717dc04e12fe46877da31d54
05:46:29 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 10610514, Num Unique Notes Rated: 616705, Num Unique Raters: 252302
05:46:29 INFO:birdwatch.scorer:MFCoreScorer Prepare ratings elapsed time: 2.73 secs (0.05 mins)
05:46:34 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFCoreScorer: 2683aff5af4ea999f2d021b7f10f02636ce59f2cfb4ca5a9d24c6a55a389c416
05:46:35 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFCoreScorer: 62b2781d977a7feee1937d417726f758827c4b5ced160489bc7855966453269f
05:46:35 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFCoreScorer: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
05:46:37 INFO:birdwatch.scorer:MFCoreScorer Prepare data for stable initialization elapsed time: 1.88 secs (0.03 mins)
05:46:37 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:46:37 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:46:37 INFO:birdwatch.wandb_utils:W&B is disabled
05:46:37 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:46:37 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:46:37 DEBUG:wandb:no default config file found in config-defaults.yaml
05:46:38 INFO:birdwatch.matrix_factorization:------------------
05:46:38 INFO:birdwatch.matrix_factorization:Users: 86163, Notes: 114146
05:46:38 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
05:46:38 INFO:birdwatch.matrix_factorization:cuda:0
05:46:38 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 16.194479000578205
05:46:38 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 21.453930341329805
05:46:38 INFO:birdwatch.matrix_factorization:epoch 0 6.5726094245910645
05:46:38 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.125704288482666
05:46:38 INFO:birdwatch.matrix_factorization:epoch 20 0.2855072617530823
05:46:38 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.22361023724079132
05:46:38 INFO:birdwatch.matrix_factorization:epoch 40 0.10986712574958801
05:46:38 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07475341856479645
05:46:38 INFO:birdwatch.matrix_factorization:epoch 60 0.08685187995433807
05:46:38 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05690605938434601
05:46:38 INFO:birdwatch.matrix_factorization:epoch 80 0.08369310945272446
05:46:38 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05385792627930641
05:46:38 INFO:birdwatch.matrix_factorization:epoch 100 0.08329178392887115
05:46:38 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.053630080074071884
05:46:38 INFO:birdwatch.matrix_factorization:epoch 120 0.08323846757411957
05:46:38 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.053659290075302124
05:46:38 INFO:birdwatch.matrix_factorization:Num epochs: 134
05:46:38 INFO:birdwatch.matrix_factorization:epoch 134 0.08323273062705994
05:46:38 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.053619056940078735
05:46:38 INFO:birdwatch.matrix_factorization:Global Intercept: 0.14940710365772247
05:46:38 INFO:birdwatch.wandb_utils:Finishing W&B run
05:46:38 INFO:birdwatch.scorer:MFCoreScorer MF on stable-initialization subset elapsed time: 1.16 secs (0.02 mins)
05:46:38 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:46:38 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:46:38 INFO:birdwatch.wandb_utils:W&B is disabled
05:46:39 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:46:39 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:46:39 DEBUG:wandb:no default config file found in config-defaults.yaml
05:46:41 INFO:birdwatch.matrix_factorization:------------------
05:46:41 INFO:birdwatch.matrix_factorization:Users: 252302, Notes: 616705
05:46:41 INFO:birdwatch.matrix_factorization:initializing notes
05:46:41 INFO:birdwatch.matrix_factorization:initializing users
05:46:41 INFO:birdwatch.matrix_factorization:initialized global intercept
05:46:41 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
05:46:41 INFO:birdwatch.matrix_factorization:cuda:0
05:46:41 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 17.205169408388127
05:46:41 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 42.054815261076016
05:46:41 INFO:birdwatch.matrix_factorization:epoch 0 0.2449209988117218
05:46:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.20673497021198273
05:46:41 INFO:birdwatch.matrix_factorization:epoch 20 0.10753209888935089
05:46:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07533144950866699
05:46:42 INFO:birdwatch.matrix_factorization:epoch 40 0.09740597754716873
05:46:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06473945826292038
05:46:42 INFO:birdwatch.matrix_factorization:epoch 60 0.09617546200752258
05:46:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06404520571231842
05:46:43 INFO:birdwatch.matrix_factorization:epoch 80 0.09600920975208282
05:46:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06402843445539474
05:46:44 INFO:birdwatch.matrix_factorization:epoch 100 0.09598514437675476
05:46:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06400972604751587
05:46:44 INFO:birdwatch.matrix_factorization:epoch 120 0.09598082304000854
05:46:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06400394439697266
05:46:44 INFO:birdwatch.matrix_factorization:Num epochs: 129
05:46:44 INFO:birdwatch.matrix_factorization:epoch 129 0.095979705452919
05:46:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06400340050458908
05:46:44 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17078472673892975
05:46:44 INFO:birdwatch.wandb_utils:Finishing W&B run
05:46:44 INFO:birdwatch.scorer:MFCoreScorer First full MF (initializated with stable-initialization) elapsed time: 5.93 secs (0.10 mins)
05:46:44 INFO:birdwatch.scorer:MFCoreScorer First MF/stable init elapsed time: 9.02 secs (0.15 mins)
05:46:45 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFCoreScorer
05:46:55 INFO:birdwatch.note_ratings:dropped 0 out of 12153745 ratings due to NaN factor.
05:47:49 INFO:birdwatch.note_ratings:dropped 0 out of 79327 population sampled ratings due to NaN factor.
05:47:50 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
05:47:50 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:47:51 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.51 secs (0.01 mins)
05:47:51 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
05:47:51 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
05:47:51 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.65 secs (0.01 mins)
05:47:51 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
05:47:51 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:47:52 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.53 secs (0.01 mins)
05:47:52 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
05:47:52 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
05:47:52 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.52 secs (0.01 mins)
05:47:52 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
05:47:52 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:47:53 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.52 secs (0.01 mins)
05:47:53 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
05:47:53 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.09 secs (0.00 mins)
05:47:53 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.63 secs (0.01 mins)
05:48:34 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 40.48 secs (0.67 mins)
05:48:34 INFO:birdwatch.scorer:MFCoreScorer Compute scored notes elapsed time: 109.76 secs (1.83 mins)
05:48:41 INFO:birdwatch.note_ratings:Total ratings: 14247186 post-tombstones and 22173 pre-tombstones
05:48:41 INFO:birdwatch.note_ratings:Total ratings created before statuses: 11358253, including 11343918 post-tombstones and 14335 pre-tombstones.
05:48:43 INFO:birdwatch.note_ratings:Total valid ratings: 572755
05:48:43 INFO:birdwatch.scorer:MFCoreScorer Compute valid ratings elapsed time: 8.36 secs (0.14 mins)
05:48:43 INFO:birdwatch.scorer:MFCoreScorer Helpfulness scores pre-harassment  elapsed time: 0.33 secs (0.01 mins)
05:48:44 INFO:birdwatch.helpfulness_scores:Unique Raters: 252302
05:48:44 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 324890
05:48:44 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 211855
05:48:44 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 142878
05:48:44 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 10610514
05:48:44 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 7325656
05:48:44 INFO:birdwatch.scorer:MFCoreScorer Filtering by helpfulness score elapsed time: 1.06 secs (0.02 mins)
05:48:44 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
05:48:45 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    4497479
1     412655
dtype: int64
05:48:45 INFO:birdwatch.tag_consensus:Number of rows with no tag label 2414369
05:48:46 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 3823509, Num Unique Notes Rated: 301432, Num Unique Raters: 100308
05:48:46 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    3520076
1     303433
dtype: int64
05:48:46 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
05:48:46 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.07935982365936631
05:48:46 INFO:birdwatch.matrix_factorization:Using pos weight: 11.600834451097935 with BCEWithLogitsLoss
05:48:46 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:48:46 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:48:46 INFO:birdwatch.wandb_utils:W&B is disabled
05:48:46 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:48:46 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:48:46 DEBUG:wandb:no default config file found in config-defaults.yaml
05:48:47 INFO:birdwatch.matrix_factorization:------------------
05:48:47 INFO:birdwatch.matrix_factorization:Users: 100308, Notes: 301432
05:48:47 INFO:birdwatch.matrix_factorization:initializing notes
05:48:47 INFO:birdwatch.matrix_factorization:initializing users
05:48:47 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
05:48:47 INFO:birdwatch.matrix_factorization:cuda:0
05:48:47 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 12.684482735741394
05:48:47 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 38.11768752243091
05:48:47 INFO:birdwatch.matrix_factorization:epoch 0 3.21541166305542
05:48:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.3559762239456177
05:48:47 INFO:birdwatch.matrix_factorization:epoch 20 0.7076907157897949
05:48:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.34378084540367126
05:48:47 INFO:birdwatch.matrix_factorization:epoch 40 0.4242106080055237
05:48:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.24734090268611908
05:48:48 INFO:birdwatch.matrix_factorization:epoch 60 0.38515937328338623
05:48:48 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2336636632680893
05:48:48 INFO:birdwatch.matrix_factorization:epoch 80 0.3791528046131134
05:48:48 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23139600455760956
05:48:48 INFO:birdwatch.matrix_factorization:epoch 100 0.3780752122402191
05:48:48 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2308480143547058
05:48:48 INFO:birdwatch.matrix_factorization:epoch 120 0.37786656618118286
05:48:48 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23075753450393677
05:48:48 INFO:birdwatch.matrix_factorization:Num epochs: 123
05:48:48 INFO:birdwatch.matrix_factorization:epoch 123 0.3778633177280426
05:48:48 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23075348138809204
05:48:48 INFO:birdwatch.matrix_factorization:Global Intercept: -0.24515031278133392
05:48:48 INFO:birdwatch.wandb_utils:Finishing W&B run
05:48:48 INFO:birdwatch.scorer:MFCoreScorer Harassment tag consensus elapsed time: 4.34 secs (0.07 mins)
05:48:52 INFO:birdwatch.scorer:MFCoreScorer Helpfulness scores post-harassment elapsed time: 0.72 secs (0.01 mins)
05:48:56 INFO:birdwatch.helpfulness_scores:Unique Raters: 252302
05:48:56 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 324890
05:48:56 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 209801
05:48:56 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 140824
05:48:56 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 10610514
05:48:56 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 6988192
05:48:59 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:48:59 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:48:59 INFO:birdwatch.wandb_utils:W&B is disabled
05:48:59 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:48:59 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:48:59 DEBUG:wandb:no default config file found in config-defaults.yaml
05:49:00 INFO:birdwatch.matrix_factorization:------------------
05:49:00 INFO:birdwatch.matrix_factorization:Users: 140824, Notes: 616030
05:49:00 INFO:birdwatch.matrix_factorization:initializing notes
05:49:00 INFO:birdwatch.matrix_factorization:initializing users
05:49:00 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
05:49:00 INFO:birdwatch.matrix_factorization:cuda:0
05:49:00 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 11.343915069071311
05:49:00 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 49.62358688859853
05:49:00 INFO:birdwatch.matrix_factorization:epoch 0 0.38877731561660767
05:49:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.31865260004997253
05:49:01 INFO:birdwatch.matrix_factorization:epoch 20 0.09332109987735748
05:49:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05841789022088051
05:49:01 INFO:birdwatch.matrix_factorization:epoch 40 0.09087316691875458
05:49:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05947696045041084
05:49:01 INFO:birdwatch.matrix_factorization:epoch 60 0.08990759402513504
05:49:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.057681385427713394
05:49:02 INFO:birdwatch.matrix_factorization:epoch 80 0.0898028016090393
05:49:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05742911621928215
05:49:02 INFO:birdwatch.matrix_factorization:epoch 100 0.08978946506977081
05:49:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05729854106903076
05:49:02 INFO:birdwatch.matrix_factorization:Num epochs: 101
05:49:02 INFO:birdwatch.matrix_factorization:epoch 101 0.08978946506977081
05:49:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05729854106903076
05:49:02 INFO:birdwatch.matrix_factorization:Global Intercept: 0.170681431889534
05:49:02 INFO:birdwatch.wandb_utils:Finishing W&B run
05:49:02 INFO:birdwatch.constants:Final round MF elapsed time: 7.27 secs (0.12 mins)
05:49:02 INFO:birdwatch.mf_base_scorer:In MFCoreScorer prescoring, about to call diligence with 6988192 final round ratings.
05:49:08 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
        raterParticipantId  internalRaterFactor1
0                        3             -0.494860
1                        5              0.723448
2                       13             -0.670218
3                       15             -0.420415
4                       17              0.726691
...                    ...                   ...
140819              913458              0.322289
140820              917914              0.320359
140821              927718             -0.140777
140822              942797             -0.246197
140823              987081             -0.054816

[140824 rows x 2 columns]
05:49:08 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
05:49:08 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 140824, vs. num we are initializing: 140824
05:49:08 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
05:49:08 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 140824
05:49:08 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
05:49:08 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
05:49:08 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
05:49:08 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
05:49:08 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
05:49:08 INFO:birdwatch.reputation_matrix_factorization:Round 1:
05:49:08 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=17.098892 | time=0.0s
05:49:08 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.382442 | time=0.6s
05:49:09 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.913264 | time=1.2s
05:49:10 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.818557 | time=1.8s
05:49:10 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.784371 | time=2.4s
05:49:11 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.766680 | time=3.0s
05:49:11 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.755785 | time=3.6s
05:49:12 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.748609 | time=4.2s
05:49:13 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.743695 | time=4.8s
05:49:13 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.740278 | time=5.4s
05:49:14 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.737901 | time=6.1s
05:49:14 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.1706, device='cuda:0', requires_grad=True)
05:49:14 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
05:49:14 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.737836 | time=0.0s
05:49:14 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.547153 | time=0.6s
05:49:15 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.538637 | time=1.1s
05:49:16 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.537690 | time=1.7s
05:49:16 INFO:birdwatch.reputation_matrix_factorization:epoch=105 | loss=1.537644 | time=1.9s
05:49:16 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
05:49:16 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.474871 | time=0.0s
05:49:16 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.396440 | time=0.4s
05:49:17 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.395454 | time=0.7s
05:49:17 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.395416 | time=0.9s
05:49:17 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(0.8422, device='cuda:0', requires_grad=True)
05:49:17 INFO:birdwatch.diligence_model:Low diligence training loss: 2.7379, 1.5376, 0.3954
05:49:17 INFO:birdwatch.scorer:MFCoreScorer Low Diligence MF elapsed time: 14.92 secs (0.25 mins)
05:49:28 INFO:birdwatch.note_ratings:dropped 0 out of 12153745 ratings due to NaN factor.
05:50:22 INFO:birdwatch.note_ratings:dropped 0 out of 79327 population sampled ratings due to NaN factor.
05:50:23 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
05:50:23 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:50:23 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.55 secs (0.01 mins)
05:50:23 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
05:50:24 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
05:50:24 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.64 secs (0.01 mins)
05:50:24 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
05:50:24 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:50:25 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
05:50:25 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
05:50:25 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
05:50:25 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.51 secs (0.01 mins)
05:50:25 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
05:50:25 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:50:26 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.54 secs (0.01 mins)
05:50:26 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
05:50:26 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.09 secs (0.00 mins)
05:50:26 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
05:51:05 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 38.17 secs (0.64 mins)
05:51:18 INFO:birdwatch.constants:MFCoreScorer: Compute tag thresholds for percentiles elapsed time: 12.96 secs (0.22 mins)
05:51:37 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFExpansionScorer set to: 12
05:51:37 INFO:birdwatch.scorer:Filtering ratings for MFExpansionScorer.  Original rating length: 19679338
05:51:37 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
05:51:40 INFO:birdwatch.scorer:  Ratings without assigned group: 0
05:51:43 INFO:birdwatch.scorer:  Ratings after group filter: 19600436
05:51:43 INFO:birdwatch.scorer:MFExpansionScorer Filter input elapsed time: 5.65 secs (0.09 mins)
05:51:54 INFO:birdwatch.mf_base_scorer:ratings summary MFExpansionScorer: f1f3b249e79994c82611afbf0ea8c3e3d1cdca48db90e8e4d3dd309ee4849682
05:51:58 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 15002066, Num Unique Notes Rated: 836654, Num Unique Raters: 344854
05:51:58 INFO:birdwatch.scorer:MFExpansionScorer Prepare ratings elapsed time: 4.01 secs (0.07 mins)
05:52:05 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFExpansionScorer: ef307bd3abed7bb5245f2d27d320b075eacabd8556e04fb76a2a8e31a932a47d
05:52:06 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFExpansionScorer: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
05:52:06 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFExpansionScorer: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
05:52:09 INFO:birdwatch.scorer:MFExpansionScorer Prepare data for stable initialization elapsed time: 2.65 secs (0.04 mins)
05:52:09 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:52:09 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:52:09 INFO:birdwatch.wandb_utils:W&B is disabled
05:52:09 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:52:09 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:52:09 DEBUG:wandb:no default config file found in config-defaults.yaml
05:52:09 INFO:birdwatch.matrix_factorization:------------------
05:52:09 INFO:birdwatch.matrix_factorization:Users: 93523, Notes: 102474
05:52:09 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
05:52:09 INFO:birdwatch.matrix_factorization:cuda:0
05:52:09 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 15.96024357397974
05:52:09 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 17.48778375372903
05:52:09 INFO:birdwatch.matrix_factorization:epoch 0 6.557775020599365
05:52:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.11345100402832
05:52:09 INFO:birdwatch.matrix_factorization:epoch 20 0.25566452741622925
05:52:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.20131778717041016
05:52:10 INFO:birdwatch.matrix_factorization:epoch 40 0.10717154294252396
05:52:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0721791684627533
05:52:10 INFO:birdwatch.matrix_factorization:epoch 60 0.08566892147064209
05:52:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05609961226582527
05:52:10 INFO:birdwatch.matrix_factorization:epoch 80 0.08244185149669647
05:52:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05286880210042
05:52:10 INFO:birdwatch.matrix_factorization:epoch 100 0.08204514533281326
05:52:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.052662111818790436
05:52:10 INFO:birdwatch.matrix_factorization:Num epochs: 117
05:52:10 INFO:birdwatch.matrix_factorization:epoch 117 0.08199978619813919
05:52:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05267885699868202
05:52:10 INFO:birdwatch.matrix_factorization:Global Intercept: 0.1468677520751953
05:52:10 INFO:birdwatch.wandb_utils:Finishing W&B run
05:52:10 INFO:birdwatch.scorer:MFExpansionScorer MF on stable-initialization subset elapsed time: 0.97 secs (0.02 mins)
05:52:10 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:52:10 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:52:10 INFO:birdwatch.wandb_utils:W&B is disabled
05:52:10 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:52:10 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:52:10 DEBUG:wandb:no default config file found in config-defaults.yaml
05:52:13 INFO:birdwatch.matrix_factorization:------------------
05:52:13 INFO:birdwatch.matrix_factorization:Users: 344854, Notes: 836654
05:52:13 INFO:birdwatch.matrix_factorization:initializing notes
05:52:13 INFO:birdwatch.matrix_factorization:initializing users
05:52:13 INFO:birdwatch.matrix_factorization:initialized global intercept
05:52:13 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
05:52:13 INFO:birdwatch.matrix_factorization:cuda:0
05:52:13 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 17.93102764105592
05:52:13 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 43.502659096313224
05:52:13 INFO:birdwatch.matrix_factorization:epoch 0 0.2461729794740677
05:52:13 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21035324037075043
05:52:14 INFO:birdwatch.matrix_factorization:epoch 20 0.11132240295410156
05:52:14 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07864198088645935
05:52:15 INFO:birdwatch.matrix_factorization:epoch 40 0.10119999945163727
05:52:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06860661506652832
05:52:16 INFO:birdwatch.matrix_factorization:epoch 60 0.09994547069072723
05:52:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06792204082012177
05:52:16 INFO:birdwatch.matrix_factorization:epoch 80 0.09977550059556961
05:52:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0677729994058609
05:52:17 INFO:birdwatch.matrix_factorization:epoch 100 0.0997515469789505
05:52:17 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06778836995363235
05:52:18 INFO:birdwatch.matrix_factorization:epoch 120 0.0997466892004013
05:52:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06778828799724579
05:52:18 INFO:birdwatch.matrix_factorization:Num epochs: 122
05:52:18 INFO:birdwatch.matrix_factorization:epoch 122 0.09974665194749832
05:52:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06778907030820847
05:52:18 INFO:birdwatch.matrix_factorization:Global Intercept: 0.1729438602924347
05:52:18 INFO:birdwatch.wandb_utils:Finishing W&B run
05:52:18 INFO:birdwatch.scorer:MFExpansionScorer First full MF (initializated with stable-initialization) elapsed time: 8.14 secs (0.14 mins)
05:52:18 INFO:birdwatch.scorer:MFExpansionScorer First MF/stable init elapsed time: 11.81 secs (0.20 mins)
05:52:18 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFExpansionScorer
05:52:34 INFO:birdwatch.note_ratings:dropped 0 out of 16898011 ratings due to NaN factor.
05:53:46 INFO:birdwatch.note_ratings:dropped 0 out of 108984 population sampled ratings due to NaN factor.
05:53:46 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
05:53:46 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:53:47 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.62 secs (0.01 mins)
05:53:47 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
05:53:47 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.13 secs (0.00 mins)
05:53:48 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.73 secs (0.01 mins)
05:53:48 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
05:53:48 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
05:53:48 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
05:53:48 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
05:53:48 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:53:49 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
05:53:49 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
05:53:49 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:53:50 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
05:53:50 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
05:53:50 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
05:53:50 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.72 secs (0.01 mins)
05:54:37 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 46.90 secs (0.78 mins)
05:54:38 INFO:birdwatch.scorer:MFExpansionScorer Compute scored notes elapsed time: 139.34 secs (2.32 mins)
05:54:47 INFO:birdwatch.note_ratings:Total ratings: 19576364 post-tombstones and 24072 pre-tombstones
05:54:47 INFO:birdwatch.note_ratings:Total ratings created before statuses: 15613729, including 15598393 post-tombstones and 15336 pre-tombstones.
05:54:50 INFO:birdwatch.note_ratings:Total valid ratings: 879331
05:54:50 INFO:birdwatch.scorer:MFExpansionScorer Compute valid ratings elapsed time: 11.97 secs (0.20 mins)
05:54:50 INFO:birdwatch.scorer:MFExpansionScorer Helpfulness scores pre-harassment  elapsed time: 0.46 secs (0.01 mins)
05:54:51 INFO:birdwatch.helpfulness_scores:Unique Raters: 344854
05:54:51 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 429488
05:54:51 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 302413
05:54:52 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 201616
05:54:52 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 15002066
05:54:52 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 10369728
05:54:52 INFO:birdwatch.scorer:MFExpansionScorer Filtering by helpfulness score elapsed time: 1.55 secs (0.03 mins)
05:54:52 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
05:54:53 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    6422206
1     592957
dtype: int64
05:54:53 INFO:birdwatch.tag_consensus:Number of rows with no tag label 3353308
05:54:54 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 5571671, Num Unique Notes Rated: 428488, Num Unique Raters: 144632
05:54:55 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    5123107
1     448564
dtype: int64
05:54:55 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
05:54:55 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.08050798405002736
05:54:55 INFO:birdwatch.matrix_factorization:Using pos weight: 11.421128311679047 with BCEWithLogitsLoss
05:54:55 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:54:55 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:54:55 INFO:birdwatch.wandb_utils:W&B is disabled
05:54:55 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:54:55 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:54:55 DEBUG:wandb:no default config file found in config-defaults.yaml
05:54:56 INFO:birdwatch.matrix_factorization:------------------
05:54:56 INFO:birdwatch.matrix_factorization:Users: 144632, Notes: 428488
05:54:56 INFO:birdwatch.matrix_factorization:initializing notes
05:54:56 INFO:birdwatch.matrix_factorization:initializing users
05:54:56 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
05:54:56 INFO:birdwatch.matrix_factorization:cuda:0
05:54:56 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 13.003096936203582
05:54:56 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 38.523086177332814
05:54:56 INFO:birdwatch.matrix_factorization:epoch 0 3.263026237487793
05:54:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.4093304872512817
05:54:56 INFO:birdwatch.matrix_factorization:epoch 20 0.6915160417556763
05:54:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.33599552512168884
05:54:57 INFO:birdwatch.matrix_factorization:epoch 40 0.43697500228881836
05:54:57 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2631208300590515
05:54:57 INFO:birdwatch.matrix_factorization:epoch 60 0.39644667506217957
05:54:57 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.24470315873622894
05:54:57 INFO:birdwatch.matrix_factorization:epoch 80 0.387461394071579
05:54:57 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23933814465999603
05:54:58 INFO:birdwatch.matrix_factorization:epoch 100 0.386262983083725
05:54:58 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23896771669387817
05:54:58 INFO:birdwatch.matrix_factorization:epoch 120 0.3860950469970703
05:54:58 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2388976365327835
05:54:58 INFO:birdwatch.matrix_factorization:Num epochs: 121
05:54:58 INFO:birdwatch.matrix_factorization:epoch 121 0.3860950469970703
05:54:58 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2388976365327835
05:54:58 INFO:birdwatch.matrix_factorization:Global Intercept: -0.24803675711154938
05:54:58 INFO:birdwatch.wandb_utils:Finishing W&B run
05:54:58 INFO:birdwatch.scorer:MFExpansionScorer Harassment tag consensus elapsed time: 6.24 secs (0.10 mins)
05:55:02 INFO:birdwatch.scorer:MFExpansionScorer Helpfulness scores post-harassment elapsed time: 1.00 secs (0.02 mins)
05:55:06 INFO:birdwatch.helpfulness_scores:Unique Raters: 344854
05:55:06 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 429488
05:55:06 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 299382
05:55:06 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 198585
05:55:06 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 15002066
05:55:06 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 9807323
05:55:09 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:55:09 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:55:09 INFO:birdwatch.wandb_utils:W&B is disabled
05:55:09 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:55:09 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:55:09 DEBUG:wandb:no default config file found in config-defaults.yaml
05:55:11 INFO:birdwatch.matrix_factorization:------------------
05:55:11 INFO:birdwatch.matrix_factorization:Users: 198585, Notes: 835766
05:55:11 INFO:birdwatch.matrix_factorization:initializing notes
05:55:11 INFO:birdwatch.matrix_factorization:initializing users
05:55:11 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
05:55:11 INFO:birdwatch.matrix_factorization:cuda:0
05:55:11 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 11.734532153736811
05:55:11 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 49.386021099277386
05:55:11 INFO:birdwatch.matrix_factorization:epoch 0 0.3796016573905945
05:55:11 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.30976659059524536
05:55:11 INFO:birdwatch.matrix_factorization:epoch 20 0.09664613008499146
05:55:11 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.061694830656051636
05:55:12 INFO:birdwatch.matrix_factorization:epoch 40 0.09462711215019226
05:55:12 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06314937770366669
05:55:12 INFO:birdwatch.matrix_factorization:epoch 60 0.093598872423172
05:55:12 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06115986034274101
05:55:13 INFO:birdwatch.matrix_factorization:epoch 80 0.09351629763841629
05:55:13 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06095321476459503
05:55:13 INFO:birdwatch.matrix_factorization:epoch 100 0.09350302815437317
05:55:13 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.060798756778240204
05:55:13 INFO:birdwatch.matrix_factorization:Num epochs: 101
05:55:13 INFO:birdwatch.matrix_factorization:epoch 101 0.09350302815437317
05:55:13 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.060798756778240204
05:55:13 INFO:birdwatch.matrix_factorization:Global Intercept: 0.1741964966058731
05:55:13 INFO:birdwatch.wandb_utils:Finishing W&B run
05:55:13 INFO:birdwatch.constants:Final round MF elapsed time: 8.93 secs (0.15 mins)
05:55:13 INFO:birdwatch.mf_base_scorer:In MFExpansionScorer prescoring, about to call diligence with 9807323 final round ratings.
05:55:22 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
        raterParticipantId  internalRaterFactor1
0                        0              0.614774
1                        1              0.664975
2                        3             -0.445510
3                        5              0.690771
4                       12              0.798218
...                    ...                   ...
198580              935222              0.408257
198581              936240             -0.106223
198582              938262              0.475564
198583              942797             -0.232649
198584              987081             -0.148430

[198585 rows x 2 columns]
05:55:22 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
05:55:22 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 198585, vs. num we are initializing: 198585
05:55:22 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
05:55:22 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 198585
05:55:22 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
05:55:22 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
05:55:22 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
05:55:22 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
05:55:22 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
05:55:22 INFO:birdwatch.reputation_matrix_factorization:Round 1:
05:55:22 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=17.343208 | time=0.0s
05:55:23 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.421412 | time=0.8s
05:55:24 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.949302 | time=1.7s
05:55:24 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.857109 | time=2.5s
05:55:25 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.824967 | time=3.4s
05:55:26 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.808766 | time=4.2s
05:55:27 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.798972 | time=5.0s
05:55:28 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.792546 | time=5.9s
05:55:29 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.788100 | time=6.7s
05:55:29 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.784982 | time=7.6s
05:55:30 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.782813 | time=8.4s
05:55:30 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.0429, device='cuda:0', requires_grad=True)
05:55:30 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
05:55:30 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.782753 | time=0.0s
05:55:31 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.602886 | time=0.8s
05:55:32 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.594409 | time=1.5s
05:55:33 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.593484 | time=2.3s
05:55:33 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.593450 | time=2.6s
05:55:33 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
05:55:33 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.482844 | time=0.0s
05:55:33 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.401274 | time=0.5s
05:55:34 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.400268 | time=1.0s
05:55:34 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.400228 | time=1.2s
05:55:34 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(1.0163, device='cuda:0', requires_grad=True)
05:55:34 INFO:birdwatch.diligence_model:Low diligence training loss: 2.7828, 1.5935, 0.4002
05:55:34 INFO:birdwatch.scorer:MFExpansionScorer Low Diligence MF elapsed time: 21.08 secs (0.35 mins)
05:55:50 INFO:birdwatch.note_ratings:dropped 0 out of 16898011 ratings due to NaN factor.
05:57:02 INFO:birdwatch.note_ratings:dropped 0 out of 108984 population sampled ratings due to NaN factor.
05:57:02 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
05:57:02 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:57:03 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.60 secs (0.01 mins)
05:57:03 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
05:57:03 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.12 secs (0.00 mins)
05:57:04 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.72 secs (0.01 mins)
05:57:04 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
05:57:04 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
05:57:04 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.64 secs (0.01 mins)
05:57:04 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
05:57:04 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
05:57:05 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
05:57:05 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
05:57:05 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
05:57:05 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
05:57:05 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
05:57:05 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
05:57:06 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.70 secs (0.01 mins)
05:57:49 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 43.27 secs (0.72 mins)
05:58:07 INFO:birdwatch.constants:MFExpansionScorer: Compute tag thresholds for percentiles elapsed time: 16.80 secs (0.28 mins)
05:58:30 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFExpansionPlusScorer set to: 12
05:58:30 INFO:birdwatch.scorer:Filtering ratings for MFExpansionPlusScorer.  Original rating length: 19679338
05:58:30 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
05:58:32 INFO:birdwatch.scorer:  Ratings without assigned group: 0
05:58:33 INFO:birdwatch.scorer:  Ratings after group filter: 19679338
05:58:33 INFO:birdwatch.scorer:MFExpansionPlusScorer Filter input elapsed time: 3.26 secs (0.05 mins)
05:58:44 INFO:birdwatch.mf_base_scorer:ratings summary MFExpansionPlusScorer: ae0b9ad359b8b23bad6fb4a21b566e4c564bd234af8f81b30da6c393fe0301b9
05:58:48 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 15040546, Num Unique Notes Rated: 838712, Num Unique Raters: 346667
05:58:48 INFO:birdwatch.scorer:MFExpansionPlusScorer Prepare ratings elapsed time: 4.10 secs (0.07 mins)
05:58:56 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFExpansionPlusScorer: 195657637d9208090f730b2a9809925ddc820b0c0b8ea92d65354c31b77c6989
05:58:57 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFExpansionPlusScorer: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
05:58:57 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFExpansionPlusScorer: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
05:59:00 INFO:birdwatch.scorer:MFExpansionPlusScorer Prepare data for stable initialization elapsed time: 3.00 secs (0.05 mins)
05:59:00 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:59:00 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:59:00 INFO:birdwatch.wandb_utils:W&B is disabled
05:59:00 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:59:00 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:59:00 DEBUG:wandb:no default config file found in config-defaults.yaml
05:59:00 INFO:birdwatch.matrix_factorization:------------------
05:59:00 INFO:birdwatch.matrix_factorization:Users: 93480, Notes: 102139
05:59:00 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
05:59:00 INFO:birdwatch.matrix_factorization:cuda:0
05:59:00 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 15.963921714526283
05:59:00 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 17.442650834403082
05:59:01 INFO:birdwatch.matrix_factorization:epoch 0 6.560176849365234
05:59:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.115927219390869
05:59:01 INFO:birdwatch.matrix_factorization:epoch 20 0.2688186466693878
05:59:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21114882826805115
05:59:01 INFO:birdwatch.matrix_factorization:epoch 40 0.10772165656089783
05:59:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07255882769823074
05:59:01 INFO:birdwatch.matrix_factorization:epoch 60 0.08559221029281616
05:59:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05591871961951256
05:59:01 INFO:birdwatch.matrix_factorization:epoch 80 0.0823846310377121
05:59:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.052851416170597076
05:59:01 INFO:birdwatch.matrix_factorization:epoch 100 0.0819883942604065
05:59:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05261661112308502
05:59:01 INFO:birdwatch.matrix_factorization:epoch 120 0.08193746954202652
05:59:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05260954797267914
05:59:01 INFO:birdwatch.matrix_factorization:Num epochs: 133
05:59:01 INFO:birdwatch.matrix_factorization:epoch 133 0.08193203061819077
05:59:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05257087200880051
05:59:01 INFO:birdwatch.matrix_factorization:Global Intercept: 0.14725011587142944
05:59:01 INFO:birdwatch.wandb_utils:Finishing W&B run
05:59:01 INFO:birdwatch.scorer:MFExpansionPlusScorer MF on stable-initialization subset elapsed time: 1.11 secs (0.02 mins)
05:59:01 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
05:59:01 INFO:birdwatch.wandb_utils:Reinitializing W&B run
05:59:01 INFO:birdwatch.wandb_utils:W&B is disabled
05:59:01 DEBUG:git.util:sys.platform='linux', git_executable='git'
05:59:01 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
05:59:01 DEBUG:wandb:no default config file found in config-defaults.yaml
05:59:05 INFO:birdwatch.matrix_factorization:------------------
05:59:05 INFO:birdwatch.matrix_factorization:Users: 346667, Notes: 838712
05:59:05 INFO:birdwatch.matrix_factorization:initializing notes
05:59:05 INFO:birdwatch.matrix_factorization:initializing users
05:59:05 INFO:birdwatch.matrix_factorization:initialized global intercept
05:59:05 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
05:59:05 INFO:birdwatch.matrix_factorization:cuda:0
05:59:05 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 17.93290903194422
05:59:05 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 43.38614866716474
05:59:05 INFO:birdwatch.matrix_factorization:epoch 0 0.24465787410736084
05:59:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.20888647437095642
05:59:06 INFO:birdwatch.matrix_factorization:epoch 20 0.11133464425802231
05:59:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07863815128803253
05:59:06 INFO:birdwatch.matrix_factorization:epoch 40 0.10122540593147278
05:59:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0686105340719223
05:59:07 INFO:birdwatch.matrix_factorization:epoch 60 0.09997301548719406
05:59:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06792581081390381
05:59:08 INFO:birdwatch.matrix_factorization:epoch 80 0.0998038649559021
05:59:08 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06778840720653534
05:59:09 INFO:birdwatch.matrix_factorization:epoch 100 0.09978009015321732
05:59:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06780561804771423
05:59:10 INFO:birdwatch.matrix_factorization:epoch 120 0.0997752696275711
05:59:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06780541688203812
05:59:10 INFO:birdwatch.matrix_factorization:Num epochs: 121
05:59:10 INFO:birdwatch.matrix_factorization:epoch 121 0.0997752696275711
05:59:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06780541688203812
05:59:10 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17300669848918915
05:59:10 INFO:birdwatch.wandb_utils:Finishing W&B run
05:59:10 INFO:birdwatch.scorer:MFExpansionPlusScorer First full MF (initializated with stable-initialization) elapsed time: 8.36 secs (0.14 mins)
05:59:10 INFO:birdwatch.scorer:MFExpansionPlusScorer First MF/stable init elapsed time: 12.53 secs (0.21 mins)
05:59:10 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFExpansionPlusScorer
05:59:29 INFO:birdwatch.note_ratings:dropped 0 out of 16938819 ratings due to NaN factor.
06:00:41 INFO:birdwatch.note_ratings:dropped 0 out of 109400 population sampled ratings due to NaN factor.
06:00:41 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:00:41 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:00:42 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.63 secs (0.01 mins)
06:00:42 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:00:42 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.12 secs (0.00 mins)
06:00:43 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.73 secs (0.01 mins)
06:00:43 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:00:43 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:00:43 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:00:43 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:00:43 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:00:44 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:00:44 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:00:44 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:00:45 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:00:45 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:00:45 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:00:45 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:01:32 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.10 secs (0.79 mins)
06:01:33 INFO:birdwatch.scorer:MFExpansionPlusScorer Compute scored notes elapsed time: 143.14 secs (2.39 mins)
06:01:43 INFO:birdwatch.note_ratings:Total ratings: 19655255 post-tombstones and 24083 pre-tombstones
06:01:43 INFO:birdwatch.note_ratings:Total ratings created before statuses: 15669698, including 15654362 post-tombstones and 15336 pre-tombstones.
06:01:46 INFO:birdwatch.note_ratings:Total valid ratings: 882287
06:01:46 INFO:birdwatch.scorer:MFExpansionPlusScorer Compute valid ratings elapsed time: 13.12 secs (0.22 mins)
06:01:47 INFO:birdwatch.scorer:MFExpansionPlusScorer Helpfulness scores pre-harassment  elapsed time: 0.48 secs (0.01 mins)
06:01:48 INFO:birdwatch.helpfulness_scores:Unique Raters: 346667
06:01:48 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 431834
06:01:48 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 304490
06:01:48 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 202445
06:01:48 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 15040546
06:01:48 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 10391395
06:01:48 INFO:birdwatch.scorer:MFExpansionPlusScorer Filtering by helpfulness score elapsed time: 1.59 secs (0.03 mins)
06:01:48 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:01:49 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    6435918
1     594612
dtype: int64
06:01:49 INFO:birdwatch.tag_consensus:Number of rows with no tag label 3359608
06:01:51 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 5580881, Num Unique Notes Rated: 429270, Num Unique Raters: 145049
06:01:51 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    5131032
1     449849
dtype: int64
06:01:51 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:01:51 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.08060537395439896
06:01:51 INFO:birdwatch.matrix_factorization:Using pos weight: 11.406120720508438 with BCEWithLogitsLoss
06:01:51 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:01:51 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:01:51 INFO:birdwatch.wandb_utils:W&B is disabled
06:01:51 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:01:51 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:01:51 DEBUG:wandb:no default config file found in config-defaults.yaml
06:01:52 INFO:birdwatch.matrix_factorization:------------------
06:01:52 INFO:birdwatch.matrix_factorization:Users: 145049, Notes: 429270
06:01:52 INFO:birdwatch.matrix_factorization:initializing notes
06:01:52 INFO:birdwatch.matrix_factorization:initializing users
06:01:52 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:01:52 INFO:birdwatch.matrix_factorization:cuda:0
06:01:52 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 13.000864257926247
06:01:52 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 38.47583230494523
06:01:52 INFO:birdwatch.matrix_factorization:epoch 0 3.2619571685791016
06:01:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.4083257913589478
06:01:53 INFO:birdwatch.matrix_factorization:epoch 20 0.6909278631210327
06:01:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3353438079357147
06:01:53 INFO:birdwatch.matrix_factorization:epoch 40 0.436755895614624
06:01:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.26297369599342346
06:01:53 INFO:birdwatch.matrix_factorization:epoch 60 0.39589327573776245
06:01:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2440747618675232
06:01:54 INFO:birdwatch.matrix_factorization:epoch 80 0.38735225796699524
06:01:54 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2393040955066681
06:01:54 INFO:birdwatch.matrix_factorization:epoch 100 0.386219322681427
06:01:54 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23895621299743652
06:01:54 INFO:birdwatch.matrix_factorization:epoch 120 0.3860521912574768
06:01:54 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23888985812664032
06:01:55 INFO:birdwatch.matrix_factorization:Num epochs: 131
06:01:55 INFO:birdwatch.matrix_factorization:epoch 131 0.38603419065475464
06:01:55 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2388841211795807
06:01:55 INFO:birdwatch.matrix_factorization:Global Intercept: -0.24822285771369934
06:01:55 INFO:birdwatch.wandb_utils:Finishing W&B run
06:01:55 INFO:birdwatch.scorer:MFExpansionPlusScorer Harassment tag consensus elapsed time: 6.51 secs (0.11 mins)
06:01:59 INFO:birdwatch.scorer:MFExpansionPlusScorer Helpfulness scores post-harassment elapsed time: 1.03 secs (0.02 mins)
06:02:03 INFO:birdwatch.helpfulness_scores:Unique Raters: 346667
06:02:03 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 431834
06:02:03 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 301503
06:02:03 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 199458
06:02:03 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 15040546
06:02:03 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 9848202
06:02:06 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:02:06 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:02:06 INFO:birdwatch.wandb_utils:W&B is disabled
06:02:06 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:02:06 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:02:06 DEBUG:wandb:no default config file found in config-defaults.yaml
06:02:08 INFO:birdwatch.matrix_factorization:------------------
06:02:08 INFO:birdwatch.matrix_factorization:Users: 199458, Notes: 837840
06:02:08 INFO:birdwatch.matrix_factorization:initializing notes
06:02:08 INFO:birdwatch.matrix_factorization:initializing users
06:02:08 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:02:08 INFO:birdwatch.matrix_factorization:cuda:0
06:02:08 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 11.754275279289601
06:02:08 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 49.374815750684355
06:02:08 INFO:birdwatch.matrix_factorization:epoch 0 0.3796910047531128
06:02:08 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3098577857017517
06:02:08 INFO:birdwatch.matrix_factorization:epoch 20 0.09668776392936707
06:02:08 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06174221262335777
06:02:09 INFO:birdwatch.matrix_factorization:epoch 40 0.09466683119535446
06:02:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06319573521614075
06:02:09 INFO:birdwatch.matrix_factorization:epoch 60 0.09363771975040436
06:02:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.061205483973026276
06:02:10 INFO:birdwatch.matrix_factorization:epoch 80 0.09355373680591583
06:02:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06099839136004448
06:02:11 INFO:birdwatch.matrix_factorization:epoch 100 0.0935400202870369
06:02:11 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06084156036376953
06:02:11 INFO:birdwatch.matrix_factorization:Num epochs: 101
06:02:11 INFO:birdwatch.matrix_factorization:epoch 101 0.0935400202870369
06:02:11 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06084156036376953
06:02:11 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17419341206550598
06:02:11 INFO:birdwatch.wandb_utils:Finishing W&B run
06:02:11 INFO:birdwatch.constants:Final round MF elapsed time: 9.16 secs (0.15 mins)
06:02:11 INFO:birdwatch.mf_base_scorer:In MFExpansionPlusScorer prescoring, about to call diligence with 9848202 final round ratings.
06:02:19 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
        raterParticipantId  internalRaterFactor1
0                        0              0.611001
1                        1              0.665075
2                        3             -0.445304
3                        5              0.688525
4                       12              0.800532
...                    ...                   ...
199453              935222              0.407731
199454              936240             -0.090617
199455              938262              0.475394
199456              942797             -0.239991
199457              987081             -0.147622

[199458 rows x 2 columns]
06:02:19 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:02:19 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 199458, vs. num we are initializing: 199458
06:02:19 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:02:19 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 199458
06:02:19 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:02:19 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:02:19 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:02:19 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:02:19 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:02:19 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:02:19 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=17.474976 | time=0.0s
06:02:20 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.428112 | time=0.8s
06:02:21 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.952696 | time=1.7s
06:02:22 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.859735 | time=2.5s
06:02:23 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.827312 | time=3.4s
06:02:24 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.810959 | time=4.2s
06:02:24 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.801161 | time=5.1s
06:02:25 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.794730 | time=5.9s
06:02:26 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.790332 | time=6.7s
06:02:27 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.787223 | time=7.6s
06:02:28 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.785030 | time=8.4s
06:02:28 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.0358, device='cuda:0', requires_grad=True)
06:02:28 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:02:28 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.784969 | time=0.0s
06:02:29 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.604458 | time=0.8s
06:02:29 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.595976 | time=1.5s
06:02:30 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.595063 | time=2.3s
06:02:30 INFO:birdwatch.reputation_matrix_factorization:epoch=105 | loss=1.595010 | time=2.7s
06:02:30 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:02:31 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.482660 | time=0.0s
06:02:31 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.401032 | time=0.5s
06:02:32 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.400028 | time=1.0s
06:02:32 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.399988 | time=1.2s
06:02:32 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(1.0181, device='cuda:0', requires_grad=True)
06:02:32 INFO:birdwatch.diligence_model:Low diligence training loss: 2.7850, 1.5950, 0.4000
06:02:32 INFO:birdwatch.scorer:MFExpansionPlusScorer Low Diligence MF elapsed time: 21.55 secs (0.36 mins)
06:02:48 INFO:birdwatch.note_ratings:dropped 0 out of 16938819 ratings due to NaN factor.
06:04:00 INFO:birdwatch.note_ratings:dropped 0 out of 109400 population sampled ratings due to NaN factor.
06:04:01 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:04:01 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:04:01 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:04:01 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:04:02 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.13 secs (0.00 mins)
06:04:02 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.76 secs (0.01 mins)
06:04:02 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:04:02 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:04:03 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:04:03 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:04:03 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:04:03 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:04:03 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:04:03 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:04:04 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:04:04 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:04:04 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:04:05 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:04:48 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 43.52 secs (0.73 mins)
06:05:07 INFO:birdwatch.constants:MFExpansionPlusScorer: Compute tag thresholds for percentiles elapsed time: 17.73 secs (0.30 mins)
06:05:31 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for ReputationScorer set to: 12
06:05:31 INFO:birdwatch.scorer:Filtering ratings for ReputationScorer.  Original rating length: 19679338
06:05:31 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:05:34 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:05:36 INFO:birdwatch.scorer:  Ratings after group filter: 16919910
06:05:36 INFO:birdwatch.scorer:ReputationScorer Filter input elapsed time: 5.79 secs (0.10 mins)
06:05:43 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 13006990, Num Unique Notes Rated: 736749, Num Unique Raters: 284437
06:05:46 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:05:46 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:05:46 INFO:birdwatch.wandb_utils:W&B is disabled
06:05:46 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:05:46 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:05:46 DEBUG:wandb:no default config file found in config-defaults.yaml
06:05:46 INFO:birdwatch.matrix_factorization:------------------
06:05:46 INFO:birdwatch.matrix_factorization:Users: 95324, Notes: 123599
06:05:46 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:05:46 INFO:birdwatch.matrix_factorization:cuda:0
06:05:46 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 16.342009239556955
06:05:46 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 21.189375183584406
06:05:46 INFO:birdwatch.matrix_factorization:epoch 0 6.5621337890625
06:05:46 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.1173272132873535
06:05:46 INFO:birdwatch.matrix_factorization:epoch 20 0.259143203496933
06:05:46 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1894817054271698
06:05:47 INFO:birdwatch.matrix_factorization:epoch 40 0.10684515535831451
06:05:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0731799378991127
06:05:47 INFO:birdwatch.matrix_factorization:epoch 60 0.08691340684890747
06:05:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05723351612687111
06:05:47 INFO:birdwatch.matrix_factorization:epoch 80 0.08418918401002884
06:05:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05450660362839699
06:05:47 INFO:birdwatch.matrix_factorization:epoch 100 0.08381447941064835
06:05:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05439011752605438
06:05:47 INFO:birdwatch.matrix_factorization:epoch 120 0.08376940339803696
06:05:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.054370660334825516
06:05:47 INFO:birdwatch.matrix_factorization:Num epochs: 125
06:05:47 INFO:birdwatch.matrix_factorization:epoch 125 0.08376707136631012
06:05:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05437156930565834
06:05:47 INFO:birdwatch.matrix_factorization:Global Intercept: 0.14938001334667206
06:05:47 INFO:birdwatch.wandb_utils:Finishing W&B run
06:05:57 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
                     noteId  internalNoteFactor1
0       1828784457916318001            -0.679807
1       1866559333213016175             0.042548
2       1808416641740357975            -0.060259
3       1825315946916893148            -0.642693
4       1800993240461762571             0.107034
...                     ...                  ...
123594  1660381125556989954            -0.474187
123595  1639373865359925248            -0.574772
123596  2003111322133901437            -0.631313
123597  1990592838904512869             0.438053
123598  1997076992156750205             0.264535

[123599 rows x 2 columns],
 raterInitState: 
       raterParticipantId  internalRaterFactor1
0                      13             -0.687256
1                      15             -0.570384
2                      19              0.767951
3                      30             -0.605924
4                      41             -0.594677
...                   ...                   ...
95319              216259             -0.517151
95320               85659             -0.709503
95321              408435             -0.655231
95322               31995              0.016195
95323              557780             -0.360744

[95324 rows x 2 columns]
06:05:58 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:05:58 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 284437, vs. num we are initializing: 95324
06:05:58 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 189113
06:05:58 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 95324
06:05:58 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:05:58 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:05:58 INFO:birdwatch.reputation_matrix_factorization:Initializing internalNoteFactor1:
06:05:58 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 736749, vs. num we are initializing: 123599
06:05:58 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalNoteFactor1s: 731004
06:05:58 INFO:birdwatch.reputation_matrix_factorization:  initialized internalNoteFactor1s: 5745
06:05:58 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:05:58 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:05:58 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:05:58 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.230137 | time=0.0s
06:05:59 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.021427 | time=1.1s
06:06:00 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.018498 | time=2.2s
06:06:01 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.018361 | time=3.3s
06:06:02 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=0.018354 | time=4.3s
06:06:04 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=0.018354 | time=5.4s
06:06:04 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=0.018354 | time=5.4s
06:06:04 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(0.4436, device='cuda:0', requires_grad=True)
06:06:04 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:06:04 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.129456 | time=0.0s
06:06:05 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.075817 | time=1.0s
06:06:06 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.073793 | time=2.1s
06:06:07 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.073685 | time=3.1s
06:06:08 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=0.073677 | time=4.2s
06:06:09 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=0.073676 | time=5.2s
06:06:09 INFO:birdwatch.reputation_matrix_factorization:epoch=160 | loss=0.073676 | time=5.6s
06:06:09 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:06:09 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.012985 | time=0.0s
06:06:10 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.011489 | time=0.6s
06:06:10 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.011345 | time=1.2s
06:06:11 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.011338 | time=1.9s
06:06:12 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=0.011337 | time=2.5s
06:06:12 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=0.011336 | time=3.1s
06:06:12 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=0.011336 | time=3.1s
06:06:12 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(0.6369, device='cuda:0', requires_grad=True)
06:06:12 INFO:birdwatch.helpfulness_model:Helpfulness reputation loss: 0.0184, 0.0737, 0.0113
06:06:13 INFO:birdwatch.reputation_scorer:Reputation prescoring: returning these columns:
          noteStats: Index(['noteId', 'internalNoteIntercept', 'internalNoteFactor1',
       'lowDiligenceNoteInterceptRound2'],
      dtype='object')
          raterStats: Index(['raterParticipantId', 'internalRaterReputation',
       'internalRaterIntercept', 'internalRaterFactor1',
       'lowDiligenceRaterInterceptRound2'],
      dtype='object')
          
06:06:18 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_13 set to: 8
06:06:18 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_13.  Original rating length: 19679338
06:06:18 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:06:20 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:06:22 INFO:birdwatch.scorer:  Ratings after group filter: 6549537
06:06:22 INFO:birdwatch.scorer:MFGroupScorer_13 Filter input elapsed time: 3.37 secs (0.06 mins)
06:06:25 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_13: 645e02028059fbb60a154cb415fa70085268872d37293f559e13bac1b4789961
06:06:26 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 4795708, Num Unique Notes Rated: 291337, Num Unique Raters: 91093
06:06:26 INFO:birdwatch.scorer:MFGroupScorer_13 Prepare ratings elapsed time: 1.05 secs (0.02 mins)
06:06:28 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_13: 32118aec391c9ca953ac13811c8931ec4b9982f28418bcacaa4a3d07ef2a2b5a
06:06:29 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_13: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:06:29 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_13: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:06:30 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:06:30 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:06:30 INFO:birdwatch.wandb_utils:W&B is disabled
06:06:30 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:06:30 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:06:30 DEBUG:wandb:no default config file found in config-defaults.yaml
06:06:30 INFO:birdwatch.matrix_factorization:------------------
06:06:30 INFO:birdwatch.matrix_factorization:Users: 91093, Notes: 291337
06:06:30 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:06:30 INFO:birdwatch.matrix_factorization:cuda:0
06:06:30 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 16.461033099125753
06:06:30 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 52.64628456632233
06:06:30 INFO:birdwatch.matrix_factorization:epoch 0 6.597011089324951
06:06:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.15321159362793
06:06:31 INFO:birdwatch.matrix_factorization:epoch 20 0.24868586659431458
06:06:31 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.20721422135829926
06:06:31 INFO:birdwatch.matrix_factorization:epoch 40 0.11368044465780258
06:06:31 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07953768223524094
06:06:31 INFO:birdwatch.matrix_factorization:epoch 60 0.09415578842163086
06:06:31 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06380759924650192
06:06:31 INFO:birdwatch.matrix_factorization:epoch 80 0.09149288386106491
06:06:31 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06142377480864525
06:06:32 INFO:birdwatch.matrix_factorization:epoch 100 0.09113558381795883
06:06:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.061236485838890076
06:06:32 INFO:birdwatch.matrix_factorization:epoch 120 0.09108960628509521
06:06:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0612192302942276
06:06:32 INFO:birdwatch.matrix_factorization:Num epochs: 140
06:06:32 INFO:birdwatch.matrix_factorization:epoch 140 0.09108385443687439
06:06:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06123386695981026
06:06:32 INFO:birdwatch.matrix_factorization:Global Intercept: 0.15408605337142944
06:06:32 INFO:birdwatch.wandb_utils:Finishing W&B run
06:06:32 INFO:birdwatch.scorer:MFGroupScorer_13 First MF/stable init elapsed time: 2.80 secs (0.05 mins)
06:06:32 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_13
06:06:38 INFO:birdwatch.note_ratings:dropped 0 out of 5806411 ratings due to NaN factor.
06:07:06 INFO:birdwatch.note_ratings:dropped 0 out of 14394 population sampled ratings due to NaN factor.
06:07:06 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:07:06 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:07:07 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:07:07 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:07:07 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:07:08 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:07:08 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:07:08 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:07:08 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:07:08 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:07:08 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:07:09 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:07:09 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:07:09 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:07:09 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:07:09 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:07:09 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:07:10 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:07:59 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 49.19 secs (0.82 mins)
06:08:00 INFO:birdwatch.scorer:MFGroupScorer_13 Compute scored notes elapsed time: 87.40 secs (1.46 mins)
06:08:02 INFO:birdwatch.note_ratings:Total ratings: 6528297 post-tombstones and 21240 pre-tombstones
06:08:02 INFO:birdwatch.note_ratings:Total ratings created before statuses: 5358639, including 5343793 post-tombstones and 14846 pre-tombstones.
06:08:03 INFO:birdwatch.note_ratings:Total valid ratings: 215759
06:08:03 INFO:birdwatch.scorer:MFGroupScorer_13 Compute valid ratings elapsed time: 3.43 secs (0.06 mins)
06:08:03 INFO:birdwatch.scorer:MFGroupScorer_13 Helpfulness scores pre-harassment  elapsed time: 0.17 secs (0.00 mins)
06:08:04 INFO:birdwatch.helpfulness_scores:Unique Raters: 91093
06:08:04 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 145209
06:08:04 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 71695
06:08:04 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 52283
06:08:04 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 4795708
06:08:04 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 3486815
06:08:04 INFO:birdwatch.scorer:MFGroupScorer_13 Filtering by helpfulness score elapsed time: 0.46 secs (0.01 mins)
06:08:04 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:08:04 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    1894292
1     261118
dtype: int64
06:08:04 INFO:birdwatch.tag_consensus:Number of rows with no tag label 1330185
06:08:05 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 1676566, Num Unique Notes Rated: 136522, Num Unique Raters: 37850
06:08:05 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    1484017
1     192549
dtype: int64
06:08:05 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:08:05 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.11484725325456917
06:08:05 INFO:birdwatch.matrix_factorization:Using pos weight: 7.707217383627024 with BCEWithLogitsLoss
06:08:05 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:08:05 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:08:05 INFO:birdwatch.wandb_utils:W&B is disabled
06:08:05 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:08:05 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:08:05 DEBUG:wandb:no default config file found in config-defaults.yaml
06:08:05 INFO:birdwatch.matrix_factorization:------------------
06:08:05 INFO:birdwatch.matrix_factorization:Users: 37850, Notes: 136522
06:08:05 INFO:birdwatch.matrix_factorization:initializing notes
06:08:05 INFO:birdwatch.matrix_factorization:initializing users
06:08:05 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:08:05 INFO:birdwatch.matrix_factorization:cuda:0
06:08:05 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 12.280555514862073
06:08:05 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 44.295006605019815
06:08:05 INFO:birdwatch.matrix_factorization:epoch 0 3.1093578338623047
06:08:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.2527711391448975
06:08:05 INFO:birdwatch.matrix_factorization:epoch 20 0.6534181833267212
06:08:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2729659378528595
06:08:05 INFO:birdwatch.matrix_factorization:epoch 40 0.39724016189575195
06:08:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23110385239124298
06:08:05 INFO:birdwatch.matrix_factorization:epoch 60 0.3644145727157593
06:08:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21962544322013855
06:08:06 INFO:birdwatch.matrix_factorization:epoch 80 0.35999441146850586
06:08:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21835653483867645
06:08:06 INFO:birdwatch.matrix_factorization:epoch 100 0.3594109117984772
06:08:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2182331383228302
06:08:06 INFO:birdwatch.matrix_factorization:epoch 120 0.35933297872543335
06:08:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21821172535419464
06:08:06 INFO:birdwatch.matrix_factorization:Num epochs: 125
06:08:06 INFO:birdwatch.matrix_factorization:epoch 125 0.35933059453964233
06:08:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21821485459804535
06:08:06 INFO:birdwatch.matrix_factorization:Global Intercept: -0.21739766001701355
06:08:06 INFO:birdwatch.wandb_utils:Finishing W&B run
06:08:06 INFO:birdwatch.scorer:MFGroupScorer_13 Harassment tag consensus elapsed time: 2.05 secs (0.03 mins)
06:08:09 INFO:birdwatch.scorer:MFGroupScorer_13 Helpfulness scores post-harassment elapsed time: 0.35 secs (0.01 mins)
06:08:12 INFO:birdwatch.helpfulness_scores:Unique Raters: 91093
06:08:12 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 145209
06:08:12 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 71543
06:08:12 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 52131
06:08:12 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 4795708
06:08:12 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 3457952
06:08:15 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:08:15 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:08:15 INFO:birdwatch.wandb_utils:W&B is disabled
06:08:15 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:08:15 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:08:15 DEBUG:wandb:no default config file found in config-defaults.yaml
06:08:16 INFO:birdwatch.matrix_factorization:------------------
06:08:16 INFO:birdwatch.matrix_factorization:Users: 52131, Notes: 291209
06:08:16 INFO:birdwatch.matrix_factorization:initializing notes
06:08:16 INFO:birdwatch.matrix_factorization:initializing users
06:08:16 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:08:16 INFO:birdwatch.matrix_factorization:cuda:0
06:08:16 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 11.874468165475655
06:08:16 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 66.33197137979322
06:08:16 INFO:birdwatch.matrix_factorization:epoch 0 0.4158518314361572
06:08:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.34890231490135193
06:08:16 INFO:birdwatch.matrix_factorization:epoch 20 0.09081777930259705
06:08:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0578475259244442
06:08:16 INFO:birdwatch.matrix_factorization:epoch 40 0.08711245656013489
06:08:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05812351405620575
06:08:17 INFO:birdwatch.matrix_factorization:epoch 60 0.08629551529884338
06:08:17 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.056590158492326736
06:08:17 INFO:birdwatch.matrix_factorization:epoch 80 0.08620502799749374
06:08:17 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05631332844495773
06:08:17 INFO:birdwatch.matrix_factorization:epoch 100 0.08619800209999084
06:08:17 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0562187060713768
06:08:17 INFO:birdwatch.matrix_factorization:Num epochs: 101
06:08:17 INFO:birdwatch.matrix_factorization:epoch 101 0.08619800209999084
06:08:17 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0562187060713768
06:08:17 INFO:birdwatch.matrix_factorization:Global Intercept: 0.1523544192314148
06:08:17 INFO:birdwatch.wandb_utils:Finishing W&B run
06:08:17 INFO:birdwatch.constants:Final round MF elapsed time: 5.06 secs (0.08 mins)
06:08:17 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_13 prescoring, about to call diligence with 3457952 final round ratings.
06:08:19 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
       raterParticipantId  internalRaterFactor1
0                       0              0.731403
1                       1              0.679052
2                      13             -0.629822
3                      15             -0.374483
4                      18             -0.026108
...                   ...                   ...
52126              885120             -0.386540
52127              887566             -0.195139
52128              895497             -0.419695
52129              905671              0.012539
52130              906056             -0.484430

[52131 rows x 2 columns]
06:08:19 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:08:19 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 52131, vs. num we are initializing: 52131
06:08:20 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:08:20 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 52131
06:08:20 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:08:20 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:08:20 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:08:20 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:08:20 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:08:20 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:08:20 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=19.980324 | time=0.0s
06:08:20 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.622833 | time=0.3s
06:08:20 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=3.085965 | time=0.6s
06:08:20 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.982812 | time=0.9s
06:08:21 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.948052 | time=1.2s
06:08:21 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.931185 | time=1.5s
06:08:21 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.921305 | time=1.8s
06:08:22 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.914847 | time=2.1s
06:08:22 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.910448 | time=2.4s
06:08:22 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.907374 | time=2.7s
06:08:23 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.905197 | time=3.0s
06:08:23 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(0.2259, device='cuda:0', requires_grad=True)
06:08:23 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:08:23 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.905137 | time=0.0s
06:08:23 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.698417 | time=0.3s
06:08:23 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.689569 | time=0.6s
06:08:23 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.688659 | time=0.8s
06:08:24 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.688630 | time=0.9s
06:08:24 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:08:24 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.450048 | time=0.0s
06:08:24 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.368444 | time=0.2s
06:08:24 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.367388 | time=0.4s
06:08:24 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.367346 | time=0.5s
06:08:24 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(1.2833, device='cuda:0', requires_grad=True)
06:08:24 INFO:birdwatch.diligence_model:Low diligence training loss: 2.9052, 1.6886, 0.3673
06:08:24 INFO:birdwatch.scorer:MFGroupScorer_13 Low Diligence MF elapsed time: 7.09 secs (0.12 mins)
06:08:30 INFO:birdwatch.note_ratings:dropped 0 out of 5806411 ratings due to NaN factor.
06:08:58 INFO:birdwatch.note_ratings:dropped 0 out of 14394 population sampled ratings due to NaN factor.
06:08:58 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:08:58 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:08:59 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:08:59 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:08:59 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:09:00 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:09:00 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:09:00 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:09:00 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:09:00 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:09:00 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:09:01 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:09:01 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:09:01 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:09:01 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:09:01 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:09:01 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:09:02 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:09:51 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 49.41 secs (0.82 mins)
06:09:59 INFO:birdwatch.constants:MFGroupScorer_13: Compute tag thresholds for percentiles elapsed time: 6.97 secs (0.12 mins)
06:10:12 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_12 set to: 4
06:10:12 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_12.  Original rating length: 19679338
06:10:12 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:10:14 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:10:15 INFO:birdwatch.scorer:  Ratings after group filter: 123869
06:10:15 INFO:birdwatch.scorer:MFGroupScorer_12 Filter input elapsed time: 2.85 secs (0.05 mins)
06:10:15 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_12: 59f9fd9ef37cf62d56a3b3da5de0c82f560540256c33f5f067c1f029b8309780
06:10:15 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 10228, Num Unique Notes Rated: 1364, Num Unique Raters: 803
06:10:15 INFO:birdwatch.scorer:MFGroupScorer_12 Prepare ratings elapsed time: 0.01 secs (0.00 mins)
06:10:15 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_12: 7d5650ce486c5273b2ad3e9069d469da0fd6a284954f6a64f43c3afd96fb4545
06:10:15 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_12: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:10:16 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_12: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:10:16 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:10:16 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:10:16 INFO:birdwatch.wandb_utils:W&B is disabled
06:10:16 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:10:16 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:10:16 DEBUG:wandb:no default config file found in config-defaults.yaml
06:10:16 INFO:birdwatch.matrix_factorization:------------------
06:10:16 INFO:birdwatch.matrix_factorization:Users: 803, Notes: 1364
06:10:16 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:10:16 INFO:birdwatch.matrix_factorization:cuda:0
06:10:16 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 7.4985337243401755
06:10:16 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 12.737235367372353
06:10:16 INFO:birdwatch.matrix_factorization:epoch 0 6.769792079925537
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.262111186981201
06:10:16 INFO:birdwatch.matrix_factorization:epoch 20 0.2352115362882614
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.17141026258468628
06:10:16 INFO:birdwatch.matrix_factorization:epoch 40 0.12529325485229492
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.08058447390794754
06:10:16 INFO:birdwatch.matrix_factorization:epoch 60 0.10487222671508789
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0607755184173584
06:10:16 INFO:birdwatch.matrix_factorization:epoch 80 0.0994231104850769
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.055440545082092285
06:10:16 INFO:birdwatch.matrix_factorization:epoch 100 0.07643718272447586
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.036997392773628235
06:10:16 INFO:birdwatch.matrix_factorization:epoch 120 0.061550967395305634
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.023630233481526375
06:10:16 INFO:birdwatch.matrix_factorization:epoch 140 0.06000794842839241
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.022437240928411484
06:10:16 INFO:birdwatch.matrix_factorization:epoch 160 0.05982110649347305
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.022294022142887115
06:10:16 INFO:birdwatch.matrix_factorization:epoch 180 0.059796154499053955
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.022271638736128807
06:10:16 INFO:birdwatch.matrix_factorization:Num epochs: 196
06:10:16 INFO:birdwatch.matrix_factorization:epoch 196 0.059793345630168915
06:10:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02226843312382698
06:10:16 INFO:birdwatch.matrix_factorization:Global Intercept: 0.16408495604991913
06:10:16 INFO:birdwatch.wandb_utils:Finishing W&B run
06:10:16 INFO:birdwatch.scorer:MFGroupScorer_12 First MF/stable init elapsed time: 0.50 secs (0.01 mins)
06:10:16 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_12
06:10:17 INFO:birdwatch.note_ratings:dropped 0 out of 45914 ratings due to NaN factor.
06:10:19 INFO:birdwatch.note_ratings:dropped 0 out of 443 population sampled ratings due to NaN factor.
06:10:19 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:10:19 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:10:20 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:10:20 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:10:20 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:10:21 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:10:21 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:10:21 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:10:21 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:10:21 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:10:21 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:10:22 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:10:22 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:10:22 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:10:22 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:10:22 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:10:22 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:10:23 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:11:11 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.03 secs (0.80 mins)
06:11:11 INFO:birdwatch.scorer:MFGroupScorer_12 Compute scored notes elapsed time: 55.20 secs (0.92 mins)
06:11:12 INFO:birdwatch.note_ratings:Total ratings: 123861 post-tombstones and 8 pre-tombstones
06:11:12 INFO:birdwatch.note_ratings:Total ratings created before statuses: 99354, including 99354 post-tombstones and 0 pre-tombstones.
06:11:12 INFO:birdwatch.note_ratings:Total valid ratings: 448
06:11:12 INFO:birdwatch.scorer:MFGroupScorer_12 Compute valid ratings elapsed time: 0.54 secs (0.01 mins)
06:11:12 INFO:birdwatch.scorer:MFGroupScorer_12 Helpfulness scores pre-harassment  elapsed time: 0.03 secs (0.00 mins)
06:11:12 INFO:birdwatch.helpfulness_scores:Unique Raters: 803
06:11:12 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 1058
06:11:12 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 336
06:11:12 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 198
06:11:12 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 10228
06:11:12 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 3234
06:11:12 INFO:birdwatch.scorer:MFGroupScorer_12 Filtering by helpfulness score elapsed time: 0.01 secs (0.00 mins)
06:11:12 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:11:12 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    2195
1     182
dtype: int64
06:11:12 INFO:birdwatch.tag_consensus:Number of rows with no tag label 857
06:11:12 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 0, Num Unique Notes Rated: 0, Num Unique Raters: 0
06:11:12 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown Series([], dtype: int64)
06:11:12 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:11:12 INFO:birdwatch.tag_consensus:No valid data for notHelpfulSpamHarassmentOrAbuse, returning None and aborting notHelpfulSpamHarassmentOrAbuse model training.
06:11:12 INFO:birdwatch.scorer:MFGroupScorer_12 Harassment tag consensus elapsed time: 0.02 secs (0.00 mins)
06:11:15 INFO:birdwatch.scorer:MFGroupScorer_12 Helpfulness scores post-harassment elapsed time: 0.04 secs (0.00 mins)
06:11:18 INFO:birdwatch.helpfulness_scores:Unique Raters: 803
06:11:18 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 1058
06:11:18 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 336
06:11:18 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 198
06:11:18 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 10228
06:11:18 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 3234
06:11:20 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:11:20 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:11:20 INFO:birdwatch.wandb_utils:W&B is disabled
06:11:20 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:11:20 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:11:20 DEBUG:wandb:no default config file found in config-defaults.yaml
06:11:20 INFO:birdwatch.matrix_factorization:------------------
06:11:20 INFO:birdwatch.matrix_factorization:Users: 198, Notes: 1236
06:11:20 INFO:birdwatch.matrix_factorization:initializing notes
06:11:20 INFO:birdwatch.matrix_factorization:initializing users
06:11:20 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:11:20 INFO:birdwatch.matrix_factorization:cuda:0
06:11:20 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 2.616504854368932
06:11:20 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 16.333333333333332
06:11:20 INFO:birdwatch.matrix_factorization:epoch 0 0.4380859434604645
06:11:20 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3595527112483978
06:11:20 INFO:birdwatch.matrix_factorization:epoch 20 0.05528077855706215
06:11:20 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.016370519995689392
06:11:21 INFO:birdwatch.matrix_factorization:epoch 40 0.04817485064268112
06:11:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.01296507753431797
06:11:21 INFO:birdwatch.matrix_factorization:epoch 60 0.04664336517453194
06:11:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.010881047695875168
06:11:21 INFO:birdwatch.matrix_factorization:epoch 80 0.0464644581079483
06:11:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.010633653961122036
06:11:21 INFO:birdwatch.matrix_factorization:epoch 100 0.04643457382917404
06:11:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.010431814938783646
06:11:21 INFO:birdwatch.matrix_factorization:Num epochs: 103
06:11:21 INFO:birdwatch.matrix_factorization:epoch 103 0.0464346818625927
06:11:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.010545418597757816
06:11:21 INFO:birdwatch.matrix_factorization:Global Intercept: 0.15242773294448853
06:11:21 INFO:birdwatch.wandb_utils:Finishing W&B run
06:11:21 INFO:birdwatch.constants:Final round MF elapsed time: 3.08 secs (0.05 mins)
06:11:21 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_12 prescoring, about to call diligence with 3234 final round ratings.
06:11:21 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
     raterParticipantId  internalRaterFactor1
0                   104              0.621993
1                   199             -0.652688
2                   264              0.587620
3                  2770              0.555899
4                  3171             -0.613006
..                  ...                   ...
193              594582              0.523984
194              616135             -0.537054
195              617962             -0.610972
196              636522             -0.663304
197              660819              0.116655

[198 rows x 2 columns]
06:11:21 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:11:21 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 198, vs. num we are initializing: 198
06:11:21 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:11:21 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 198
06:11:21 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:11:21 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:11:21 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:11:21 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:11:21 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:11:21 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=22.600525 | time=0.0s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=2.802044 | time=0.1s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.355289 | time=0.1s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.209185 | time=0.2s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.146754 | time=0.2s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.107722 | time=0.3s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.077941 | time=0.3s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.058496 | time=0.4s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.044242 | time=0.5s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.031894 | time=0.5s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.021634 | time=0.6s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(0.0363, device='cuda:0', requires_grad=True)
06:11:21 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.021332 | time=0.0s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.779987 | time=0.1s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.770850 | time=0.1s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.769691 | time=0.2s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=105 | loss=0.769652 | time=0.2s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.486119 | time=0.0s
06:11:21 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.411971 | time=0.0s
06:11:22 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.411023 | time=0.1s
06:11:22 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.410983 | time=0.1s
06:11:22 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-1.2168, device='cuda:0', requires_grad=True)
06:11:22 INFO:birdwatch.diligence_model:Low diligence training loss: 2.0216, 0.7697, 0.4110
06:11:22 INFO:birdwatch.scorer:MFGroupScorer_12 Low Diligence MF elapsed time: 0.92 secs (0.02 mins)
06:11:23 INFO:birdwatch.note_ratings:dropped 0 out of 45914 ratings due to NaN factor.
06:11:24 INFO:birdwatch.note_ratings:dropped 0 out of 443 population sampled ratings due to NaN factor.
06:11:25 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:11:25 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:11:25 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:11:25 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:11:26 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:11:26 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:11:26 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:11:26 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:11:27 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:11:27 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:11:27 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:11:27 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:11:27 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:11:27 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:11:28 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:11:28 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:11:28 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:11:29 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:12:17 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.42 secs (0.81 mins)
06:12:21 INFO:birdwatch.constants:MFGroupScorer_12: Compute tag thresholds for percentiles elapsed time: 2.94 secs (0.05 mins)
06:12:29 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_11 set to: 4
06:12:29 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_11.  Original rating length: 19679338
06:12:29 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:12:32 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:12:32 INFO:birdwatch.scorer:  Ratings after group filter: 228946
06:12:32 INFO:birdwatch.scorer:MFGroupScorer_11 Filter input elapsed time: 3.00 secs (0.05 mins)
06:12:32 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_11: fceef425e98ad99f0b415fb160e9045144ca4217633e82a3288d4e0abb024063
06:12:32 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 8818, Num Unique Notes Rated: 1294, Num Unique Raters: 838
06:12:32 INFO:birdwatch.scorer:MFGroupScorer_11 Prepare ratings elapsed time: 0.03 secs (0.00 mins)
06:12:32 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_11: dce9fb90d36cbad3a6f4ca117b99e202838e40f4d0bf74aab4a067b6db9957f2
06:12:33 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_11: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:12:33 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_11: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:12:33 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:12:33 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:12:33 INFO:birdwatch.wandb_utils:W&B is disabled
06:12:34 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:12:34 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:12:34 DEBUG:wandb:no default config file found in config-defaults.yaml
06:12:34 INFO:birdwatch.matrix_factorization:------------------
06:12:34 INFO:birdwatch.matrix_factorization:Users: 838, Notes: 1294
06:12:34 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:12:34 INFO:birdwatch.matrix_factorization:cuda:0
06:12:34 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 6.814528593508501
06:12:34 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 10.522673031026253
06:12:34 INFO:birdwatch.matrix_factorization:epoch 0 7.025589942932129
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.519118785858154
06:12:34 INFO:birdwatch.matrix_factorization:epoch 20 0.25038084387779236
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1908397227525711
06:12:34 INFO:birdwatch.matrix_factorization:epoch 40 0.12241952121257782
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07977218925952911
06:12:34 INFO:birdwatch.matrix_factorization:epoch 60 0.08057092875242233
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04133277386426926
06:12:34 INFO:birdwatch.matrix_factorization:epoch 80 0.0741671770811081
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.036041826009750366
06:12:34 INFO:birdwatch.matrix_factorization:epoch 100 0.07341685891151428
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.035357289016246796
06:12:34 INFO:birdwatch.matrix_factorization:epoch 120 0.0733116939663887
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03522343561053276
06:12:34 INFO:birdwatch.matrix_factorization:epoch 140 0.07329883426427841
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03519264608621597
06:12:34 INFO:birdwatch.matrix_factorization:Num epochs: 147
06:12:34 INFO:birdwatch.matrix_factorization:epoch 147 0.07329801470041275
06:12:34 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.035184595733881
06:12:34 INFO:birdwatch.matrix_factorization:Global Intercept: 0.16251195967197418
06:12:34 INFO:birdwatch.wandb_utils:Finishing W&B run
06:12:34 INFO:birdwatch.scorer:MFGroupScorer_11 First MF/stable init elapsed time: 0.40 secs (0.01 mins)
06:12:34 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_11
06:12:35 INFO:birdwatch.note_ratings:dropped 0 out of 105184 ratings due to NaN factor.
06:12:38 INFO:birdwatch.note_ratings:dropped 0 out of 265 population sampled ratings due to NaN factor.
06:12:38 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:12:38 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:12:39 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:12:39 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:12:39 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:12:39 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:12:39 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:12:39 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:12:40 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:12:40 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:12:40 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:12:40 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:12:40 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:12:40 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:12:41 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:12:41 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:12:41 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:12:42 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.72 secs (0.01 mins)
06:13:34 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 52.14 secs (0.87 mins)
06:13:34 INFO:birdwatch.scorer:MFGroupScorer_11 Compute scored notes elapsed time: 60.38 secs (1.01 mins)
06:13:35 INFO:birdwatch.note_ratings:Total ratings: 228899 post-tombstones and 47 pre-tombstones
06:13:35 INFO:birdwatch.note_ratings:Total ratings created before statuses: 187915, including 187915 post-tombstones and 0 pre-tombstones.
06:13:35 INFO:birdwatch.note_ratings:Total valid ratings: 1112
06:13:35 INFO:birdwatch.scorer:MFGroupScorer_11 Compute valid ratings elapsed time: 0.68 secs (0.01 mins)
06:13:35 INFO:birdwatch.scorer:MFGroupScorer_11 Helpfulness scores pre-harassment  elapsed time: 0.03 secs (0.00 mins)
06:13:35 INFO:birdwatch.helpfulness_scores:Unique Raters: 838
06:13:35 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 1580
06:13:35 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 702
06:13:35 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 394
06:13:35 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 8818
06:13:35 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 5050
06:13:35 INFO:birdwatch.scorer:MFGroupScorer_11 Filtering by helpfulness score elapsed time: 0.01 secs (0.00 mins)
06:13:35 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:13:35 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    3033
1     165
dtype: int64
06:13:35 INFO:birdwatch.tag_consensus:Number of rows with no tag label 1852
06:13:35 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 0, Num Unique Notes Rated: 0, Num Unique Raters: 0
06:13:35 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown Series([], dtype: int64)
06:13:35 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:13:35 INFO:birdwatch.tag_consensus:No valid data for notHelpfulSpamHarassmentOrAbuse, returning None and aborting notHelpfulSpamHarassmentOrAbuse model training.
06:13:35 INFO:birdwatch.scorer:MFGroupScorer_11 Harassment tag consensus elapsed time: 0.01 secs (0.00 mins)
06:13:38 INFO:birdwatch.scorer:MFGroupScorer_11 Helpfulness scores post-harassment elapsed time: 0.04 secs (0.00 mins)
06:13:41 INFO:birdwatch.helpfulness_scores:Unique Raters: 838
06:13:41 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 1580
06:13:41 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 702
06:13:41 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 394
06:13:41 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 8818
06:13:41 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 5050
06:13:44 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:13:44 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:13:44 INFO:birdwatch.wandb_utils:W&B is disabled
06:13:44 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:13:44 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:13:44 DEBUG:wandb:no default config file found in config-defaults.yaml
06:13:44 INFO:birdwatch.matrix_factorization:------------------
06:13:44 INFO:birdwatch.matrix_factorization:Users: 394, Notes: 1282
06:13:44 INFO:birdwatch.matrix_factorization:initializing notes
06:13:44 INFO:birdwatch.matrix_factorization:initializing users
06:13:44 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:13:44 INFO:birdwatch.matrix_factorization:cuda:0
06:13:44 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 3.939157566302652
06:13:44 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 12.817258883248732
06:13:44 INFO:birdwatch.matrix_factorization:epoch 0 0.3991122841835022
06:13:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.32219234108924866
06:13:44 INFO:birdwatch.matrix_factorization:epoch 20 0.06954709440469742
06:13:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.028948068618774414
06:13:44 INFO:birdwatch.matrix_factorization:epoch 40 0.065358005464077
06:13:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.028081271797418594
06:13:44 INFO:birdwatch.matrix_factorization:epoch 60 0.06393152475357056
06:13:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02548481523990631
06:13:44 INFO:birdwatch.matrix_factorization:epoch 80 0.06382812559604645
06:13:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02541946806013584
06:13:44 INFO:birdwatch.matrix_factorization:epoch 100 0.06379377841949463
06:13:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02517031878232956
06:13:44 INFO:birdwatch.matrix_factorization:Num epochs: 103
06:13:44 INFO:birdwatch.matrix_factorization:epoch 103 0.06379064917564392
06:13:44 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.025289254263043404
06:13:44 INFO:birdwatch.matrix_factorization:Global Intercept: 0.15915127098560333
06:13:44 INFO:birdwatch.wandb_utils:Finishing W&B run
06:13:44 INFO:birdwatch.constants:Final round MF elapsed time: 3.26 secs (0.05 mins)
06:13:44 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_11 prescoring, about to call diligence with 5050 final round ratings.
06:13:44 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
     raterParticipantId  internalRaterFactor1
0                   229             -0.480800
1                   498             -0.609504
2                   514             -0.599112
3                  1116             -0.257010
4                  1194              0.147462
..                  ...                   ...
389              566405              0.361743
390              581344             -0.328699
391              606055             -0.419396
392              616112             -0.533203
393              674065             -0.413555

[394 rows x 2 columns]
06:13:44 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:13:44 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 394, vs. num we are initializing: 394
06:13:44 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:13:44 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 394
06:13:44 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:13:44 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:13:44 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:13:44 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:13:44 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:13:44 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:13:44 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=16.718777 | time=0.0s
06:13:44 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=2.854422 | time=0.1s
06:13:44 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.394856 | time=0.1s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.261636 | time=0.2s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.196067 | time=0.2s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.154672 | time=0.3s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.126563 | time=0.4s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.108799 | time=0.4s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.096282 | time=0.5s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.087311 | time=0.6s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.080637 | time=0.6s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-1.1221, device='cuda:0', requires_grad=True)
06:13:45 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.080442 | time=0.0s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.804292 | time=0.1s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.796570 | time=0.1s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.795589 | time=0.2s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=105 | loss=0.795553 | time=0.2s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.480643 | time=0.0s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.417919 | time=0.1s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.416960 | time=0.1s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.416923 | time=0.1s
06:13:45 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-1.6550, device='cuda:0', requires_grad=True)
06:13:45 INFO:birdwatch.diligence_model:Low diligence training loss: 2.0806, 0.7956, 0.4169
06:13:45 INFO:birdwatch.scorer:MFGroupScorer_11 Low Diligence MF elapsed time: 1.02 secs (0.02 mins)
06:13:47 INFO:birdwatch.note_ratings:dropped 0 out of 105184 ratings due to NaN factor.
06:13:49 INFO:birdwatch.note_ratings:dropped 0 out of 265 population sampled ratings due to NaN factor.
06:13:50 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:13:50 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:13:50 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.66 secs (0.01 mins)
06:13:50 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:13:50 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:13:51 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.78 secs (0.01 mins)
06:13:51 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:13:51 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:13:52 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.68 secs (0.01 mins)
06:13:52 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:13:52 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:13:52 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:13:52 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:13:52 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:13:53 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.64 secs (0.01 mins)
06:13:53 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:13:53 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:13:54 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.77 secs (0.01 mins)
06:14:46 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 51.75 secs (0.86 mins)
06:14:49 INFO:birdwatch.constants:MFGroupScorer_11: Compute tag thresholds for percentiles elapsed time: 3.00 secs (0.05 mins)
06:14:58 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_10 set to: 4
06:14:58 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_10.  Original rating length: 19679338
06:14:58 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:15:00 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:15:01 INFO:birdwatch.scorer:  Ratings after group filter: 138708
06:15:01 INFO:birdwatch.scorer:MFGroupScorer_10 Filter input elapsed time: 2.98 secs (0.05 mins)
06:15:01 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_10: c51a2b31910c70d039996ea1a0f985dc902a0598bb4d656a35621c4d6a570251
06:15:01 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 1605, Num Unique Notes Rated: 257, Num Unique Raters: 299
06:15:01 INFO:birdwatch.scorer:MFGroupScorer_10 Prepare ratings elapsed time: 0.02 secs (0.00 mins)
06:15:01 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_10: 4cbdd3fa0a01529947dc94a4651d0fb5361458ba877e09b117ad5c92d3e65978
06:15:02 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_10: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:15:02 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_10: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:15:02 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:15:02 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:15:02 INFO:birdwatch.wandb_utils:W&B is disabled
06:15:02 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:15:02 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:15:02 DEBUG:wandb:no default config file found in config-defaults.yaml
06:15:02 INFO:birdwatch.matrix_factorization:------------------
06:15:02 INFO:birdwatch.matrix_factorization:Users: 299, Notes: 257
06:15:02 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:15:02 INFO:birdwatch.matrix_factorization:cuda:0
06:15:02 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 6.245136186770428
06:15:02 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 5.367892976588629
06:15:02 INFO:birdwatch.matrix_factorization:epoch 0 6.764968395233154
06:15:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.256171703338623
06:15:02 INFO:birdwatch.matrix_factorization:epoch 20 0.254555344581604
06:15:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.17603951692581177
06:15:02 INFO:birdwatch.matrix_factorization:epoch 40 0.09768995642662048
06:15:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.047965701669454575
06:15:02 INFO:birdwatch.matrix_factorization:epoch 60 0.07181967794895172
06:15:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02744276076555252
06:15:02 INFO:birdwatch.matrix_factorization:epoch 80 0.06703219562768936
06:15:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02390814572572708
06:15:02 INFO:birdwatch.matrix_factorization:epoch 100 0.06461992114782333
06:15:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02152884379029274
06:15:02 INFO:birdwatch.matrix_factorization:Num epochs: 114
06:15:02 INFO:birdwatch.matrix_factorization:epoch 114 0.06304870545864105
06:15:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.019936855882406235
06:15:02 INFO:birdwatch.matrix_factorization:Global Intercept: 0.18028292059898376
06:15:02 INFO:birdwatch.wandb_utils:Finishing W&B run
06:15:02 INFO:birdwatch.scorer:MFGroupScorer_10 First MF/stable init elapsed time: 0.28 secs (0.00 mins)
06:15:02 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_10
06:15:04 INFO:birdwatch.note_ratings:dropped 0 out of 31441 ratings due to NaN factor.
06:15:05 INFO:birdwatch.note_ratings:dropped 0 out of 45 population sampled ratings due to NaN factor.
06:15:06 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:15:06 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:15:06 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.64 secs (0.01 mins)
06:15:06 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:15:06 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:15:07 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.74 secs (0.01 mins)
06:15:07 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:15:07 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:15:08 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.64 secs (0.01 mins)
06:15:08 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:15:08 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:15:08 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:15:08 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:15:08 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:15:09 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:15:09 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:15:09 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:15:10 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.73 secs (0.01 mins)
06:16:00 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 50.20 secs (0.84 mins)
06:16:00 INFO:birdwatch.scorer:MFGroupScorer_10 Compute scored notes elapsed time: 57.64 secs (0.96 mins)
06:16:00 INFO:birdwatch.note_ratings:Total ratings: 138679 post-tombstones and 29 pre-tombstones
06:16:00 INFO:birdwatch.note_ratings:Total ratings created before statuses: 112971, including 112971 post-tombstones and 0 pre-tombstones.
06:16:01 INFO:birdwatch.note_ratings:Total valid ratings: 334
06:16:01 INFO:birdwatch.scorer:MFGroupScorer_10 Compute valid ratings elapsed time: 0.56 secs (0.01 mins)
06:16:01 INFO:birdwatch.scorer:MFGroupScorer_10 Helpfulness scores pre-harassment  elapsed time: 0.03 secs (0.00 mins)
06:16:01 INFO:birdwatch.helpfulness_scores:Unique Raters: 299
06:16:01 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 462
06:16:01 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 250
06:16:01 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 102
06:16:01 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 1605
06:16:01 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 663
06:16:01 INFO:birdwatch.scorer:MFGroupScorer_10 Filtering by helpfulness score elapsed time: 0.01 secs (0.00 mins)
06:16:01 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:16:01 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    464
1     19
dtype: int64
06:16:01 INFO:birdwatch.tag_consensus:Number of rows with no tag label 180
06:16:01 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 0, Num Unique Notes Rated: 0, Num Unique Raters: 0
06:16:01 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown Series([], dtype: int64)
06:16:01 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:16:01 INFO:birdwatch.tag_consensus:No valid data for notHelpfulSpamHarassmentOrAbuse, returning None and aborting notHelpfulSpamHarassmentOrAbuse model training.
06:16:01 INFO:birdwatch.scorer:MFGroupScorer_10 Harassment tag consensus elapsed time: 0.01 secs (0.00 mins)
06:16:04 INFO:birdwatch.scorer:MFGroupScorer_10 Helpfulness scores post-harassment elapsed time: 0.04 secs (0.00 mins)
06:16:06 INFO:birdwatch.helpfulness_scores:Unique Raters: 299
06:16:06 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 462
06:16:06 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 250
06:16:06 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 102
06:16:06 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 1605
06:16:06 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 663
06:16:09 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:16:09 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:16:09 INFO:birdwatch.wandb_utils:W&B is disabled
06:16:09 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:16:09 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:16:09 DEBUG:wandb:no default config file found in config-defaults.yaml
06:16:09 INFO:birdwatch.matrix_factorization:------------------
06:16:09 INFO:birdwatch.matrix_factorization:Users: 102, Notes: 240
06:16:09 INFO:birdwatch.matrix_factorization:initializing notes
06:16:09 INFO:birdwatch.matrix_factorization:initializing users
06:16:09 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:16:09 INFO:birdwatch.matrix_factorization:cuda:0
06:16:09 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 2.7625
06:16:09 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 6.5
06:16:09 INFO:birdwatch.matrix_factorization:epoch 0 0.40352916717529297
06:16:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3217358887195587
06:16:09 INFO:birdwatch.matrix_factorization:epoch 20 0.05494566261768341
06:16:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.01327088288962841
06:16:09 INFO:birdwatch.matrix_factorization:epoch 40 0.047730088233947754
06:16:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.009999196045100689
06:16:09 INFO:birdwatch.matrix_factorization:epoch 60 0.04580419138073921
06:16:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.007406515534967184
06:16:09 INFO:birdwatch.matrix_factorization:epoch 80 0.045608580112457275
06:16:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.007705806754529476
06:16:09 INFO:birdwatch.matrix_factorization:epoch 100 0.04541626572608948
06:16:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.007451358716934919
06:16:09 INFO:birdwatch.matrix_factorization:epoch 120 0.04518596827983856
06:16:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.007311836816370487
06:16:10 INFO:birdwatch.matrix_factorization:epoch 140 0.045163024216890335
06:16:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.007338329683989286
06:16:10 INFO:birdwatch.matrix_factorization:Num epochs: 156
06:16:10 INFO:birdwatch.matrix_factorization:epoch 156 0.04515937343239784
06:16:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.007354859262704849
06:16:10 INFO:birdwatch.matrix_factorization:Global Intercept: 0.15583619475364685
06:16:10 INFO:birdwatch.wandb_utils:Finishing W&B run
06:16:10 INFO:birdwatch.constants:Final round MF elapsed time: 3.19 secs (0.05 mins)
06:16:10 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_10 prescoring, about to call diligence with 663 final round ratings.
06:16:10 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
     raterParticipantId  internalRaterFactor1
0                    20             -0.507170
1                  1161              0.469290
2                  1913             -0.327616
3                  2120             -0.340598
4                  2334             -0.564890
..                  ...                   ...
97               428411              0.171613
98               441367              0.415246
99               443593             -0.669920
100              447560              0.348962
101              495372             -0.664693

[102 rows x 2 columns]
06:16:10 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:16:10 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 102, vs. num we are initializing: 102
06:16:10 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:16:10 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 102
06:16:10 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:16:10 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:16:10 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:16:10 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:16:10 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:16:10 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=16.327507 | time=0.0s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=2.466697 | time=0.1s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.199562 | time=0.1s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.087010 | time=0.1s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.017283 | time=0.2s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=1.965010 | time=0.2s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=1.934452 | time=0.3s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=1.912395 | time=0.3s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=1.894422 | time=0.4s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=1.871384 | time=0.4s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=1.859175 | time=0.5s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-1.4027, device='cuda:0', requires_grad=True)
06:16:10 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=1.858867 | time=0.0s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.425175 | time=0.1s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.422732 | time=0.1s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.421388 | time=0.1s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=0.421344 | time=0.2s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.324649 | time=0.0s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.281840 | time=0.0s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.281261 | time=0.1s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:epoch=065 | loss=0.281257 | time=0.1s
06:16:10 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-2.8484, device='cuda:0', requires_grad=True)
06:16:10 INFO:birdwatch.diligence_model:Low diligence training loss: 1.8592, 0.4213, 0.2813
06:16:10 INFO:birdwatch.scorer:MFGroupScorer_10 Low Diligence MF elapsed time: 0.79 secs (0.01 mins)
06:16:11 INFO:birdwatch.note_ratings:dropped 0 out of 31441 ratings due to NaN factor.
06:16:13 INFO:birdwatch.note_ratings:dropped 0 out of 45 population sampled ratings due to NaN factor.
06:16:13 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:16:13 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:16:14 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:16:14 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:16:14 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:16:15 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:16:15 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:16:15 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:16:15 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:16:15 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:16:15 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:16:16 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:16:16 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:16:16 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:16:16 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:16:16 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:16:17 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:16:17 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:17:05 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.99 secs (0.80 mins)
06:17:09 INFO:birdwatch.constants:MFGroupScorer_10: Compute tag thresholds for percentiles elapsed time: 2.88 secs (0.05 mins)
06:17:17 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_9 set to: 4
06:17:17 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_9.  Original rating length: 19679338
06:17:17 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:17:19 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:17:20 INFO:birdwatch.scorer:  Ratings after group filter: 788754
06:17:20 INFO:birdwatch.scorer:MFGroupScorer_9 Filter input elapsed time: 2.95 secs (0.05 mins)
06:17:20 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_9: d7e210759c40b070f3850943110f4ed57db024ea52b825afa17d66c0bce65f57
06:17:21 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 330021, Num Unique Notes Rated: 28886, Num Unique Raters: 12350
06:17:21 INFO:birdwatch.scorer:MFGroupScorer_9 Prepare ratings elapsed time: 0.11 secs (0.00 mins)
06:17:21 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_9: a17211ddc72672d518e9c02de4bcec8053eb5beada209752beac4175654298b4
06:17:21 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_9: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:17:22 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_9: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:17:22 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:17:22 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:17:22 INFO:birdwatch.wandb_utils:W&B is disabled
06:17:22 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:17:22 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:17:22 DEBUG:wandb:no default config file found in config-defaults.yaml
06:17:22 INFO:birdwatch.matrix_factorization:------------------
06:17:22 INFO:birdwatch.matrix_factorization:Users: 12350, Notes: 28886
06:17:22 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:17:22 INFO:birdwatch.matrix_factorization:cuda:0
06:17:22 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 11.424946340787924
06:17:22 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 26.72234817813765
06:17:22 INFO:birdwatch.matrix_factorization:epoch 0 6.486647605895996
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.000302314758301
06:17:22 INFO:birdwatch.matrix_factorization:epoch 20 0.24895718693733215
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1943657100200653
06:17:22 INFO:birdwatch.matrix_factorization:epoch 40 0.10741433501243591
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06488420069217682
06:17:22 INFO:birdwatch.matrix_factorization:epoch 60 0.08255968987941742
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.046114880591630936
06:17:22 INFO:birdwatch.matrix_factorization:epoch 80 0.0790645107626915
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.042928822338581085
06:17:22 INFO:birdwatch.matrix_factorization:epoch 100 0.07861531525850296
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04252428188920021
06:17:22 INFO:birdwatch.matrix_factorization:epoch 120 0.0785544216632843
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04237402603030205
06:17:22 INFO:birdwatch.matrix_factorization:epoch 140 0.07854656875133514
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04239139333367348
06:17:22 INFO:birdwatch.matrix_factorization:Num epochs: 142
06:17:22 INFO:birdwatch.matrix_factorization:epoch 142 0.07854647934436798
06:17:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04238958656787872
06:17:22 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17576353251934052
06:17:22 INFO:birdwatch.wandb_utils:Finishing W&B run
06:17:22 INFO:birdwatch.scorer:MFGroupScorer_9 First MF/stable init elapsed time: 0.42 secs (0.01 mins)
06:17:22 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_9
06:17:24 INFO:birdwatch.note_ratings:dropped 0 out of 580236 ratings due to NaN factor.
06:17:28 INFO:birdwatch.note_ratings:dropped 0 out of 3685 population sampled ratings due to NaN factor.
06:17:29 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:17:29 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:17:29 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:17:29 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:17:29 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:17:30 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:17:30 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:17:30 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:17:31 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:17:31 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:17:31 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:17:31 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:17:31 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:17:31 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:17:32 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:17:32 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:17:32 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:17:33 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:18:20 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.26 secs (0.79 mins)
06:18:20 INFO:birdwatch.scorer:MFGroupScorer_9 Compute scored notes elapsed time: 57.98 secs (0.97 mins)
06:18:21 INFO:birdwatch.note_ratings:Total ratings: 788673 post-tombstones and 81 pre-tombstones
06:18:21 INFO:birdwatch.note_ratings:Total ratings created before statuses: 636439, including 636438 post-tombstones and 1 pre-tombstones.
06:18:21 INFO:birdwatch.note_ratings:Total valid ratings: 24728
06:18:21 INFO:birdwatch.scorer:MFGroupScorer_9 Compute valid ratings elapsed time: 0.80 secs (0.01 mins)
06:18:21 INFO:birdwatch.scorer:MFGroupScorer_9 Helpfulness scores pre-harassment  elapsed time: 0.04 secs (0.00 mins)
06:18:21 INFO:birdwatch.helpfulness_scores:Unique Raters: 12350
06:18:21 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 20761
06:18:21 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 11475
06:18:21 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 7432
06:18:21 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 330021
06:18:21 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 232897
06:18:21 INFO:birdwatch.scorer:MFGroupScorer_9 Filtering by helpfulness score elapsed time: 0.03 secs (0.00 mins)
06:18:21 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:18:21 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    156640
1     12628
dtype: int64
06:18:21 INFO:birdwatch.tag_consensus:Number of rows with no tag label 63629
06:18:21 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 103701, Num Unique Notes Rated: 11011, Num Unique Raters: 4473
06:18:21 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    97810
1     5891
dtype: int64
06:18:21 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:18:21 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.0568075524826183
06:18:21 INFO:birdwatch.matrix_factorization:Using pos weight: 16.60329315905619 with BCEWithLogitsLoss
06:18:21 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:18:21 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:18:21 INFO:birdwatch.wandb_utils:W&B is disabled
06:18:21 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:18:21 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:18:21 DEBUG:wandb:no default config file found in config-defaults.yaml
06:18:21 INFO:birdwatch.matrix_factorization:------------------
06:18:21 INFO:birdwatch.matrix_factorization:Users: 4473, Notes: 11011
06:18:21 INFO:birdwatch.matrix_factorization:initializing notes
06:18:21 INFO:birdwatch.matrix_factorization:initializing users
06:18:21 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:18:21 INFO:birdwatch.matrix_factorization:cuda:0
06:18:21 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 9.417945690672964
06:18:21 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 23.18376928236083
06:18:21 INFO:birdwatch.matrix_factorization:epoch 0 3.2679059505462646
06:18:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.409077525138855
06:18:21 INFO:birdwatch.matrix_factorization:epoch 20 0.7949279546737671
06:18:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3971634805202484
06:18:21 INFO:birdwatch.matrix_factorization:epoch 40 0.46679651737213135
06:18:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.251438707113266
06:18:21 INFO:birdwatch.matrix_factorization:epoch 60 0.3479299545288086
06:18:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.16831721365451813
06:18:21 INFO:birdwatch.matrix_factorization:epoch 80 0.3272854685783386
06:18:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.16195815801620483
06:18:21 INFO:birdwatch.matrix_factorization:epoch 100 0.32456323504447937
06:18:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.16098351776599884
06:18:21 INFO:birdwatch.matrix_factorization:epoch 120 0.3241804242134094
06:18:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.16095009446144104
06:18:21 INFO:birdwatch.matrix_factorization:Num epochs: 124
06:18:21 INFO:birdwatch.matrix_factorization:epoch 124 0.3241659700870514
06:18:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.16095232963562012
06:18:21 INFO:birdwatch.matrix_factorization:Global Intercept: -0.25141441822052
06:18:21 INFO:birdwatch.wandb_utils:Finishing W&B run
06:18:21 INFO:birdwatch.scorer:MFGroupScorer_9 Harassment tag consensus elapsed time: 0.45 secs (0.01 mins)
06:18:24 INFO:birdwatch.scorer:MFGroupScorer_9 Helpfulness scores post-harassment elapsed time: 0.07 secs (0.00 mins)
06:18:27 INFO:birdwatch.helpfulness_scores:Unique Raters: 12350
06:18:27 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 20761
06:18:27 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 11435
06:18:27 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 7392
06:18:27 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 330021
06:18:27 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 231172
06:18:30 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:18:30 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:18:30 INFO:birdwatch.wandb_utils:W&B is disabled
06:18:30 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:18:30 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:18:30 DEBUG:wandb:no default config file found in config-defaults.yaml
06:18:30 INFO:birdwatch.matrix_factorization:------------------
06:18:30 INFO:birdwatch.matrix_factorization:Users: 7392, Notes: 28866
06:18:30 INFO:birdwatch.matrix_factorization:initializing notes
06:18:30 INFO:birdwatch.matrix_factorization:initializing users
06:18:30 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:18:30 INFO:birdwatch.matrix_factorization:cuda:0
06:18:30 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 8.008452851105107
06:18:30 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 31.2732683982684
06:18:30 INFO:birdwatch.matrix_factorization:epoch 0 0.41124457120895386
06:18:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3325308561325073
06:18:30 INFO:birdwatch.matrix_factorization:epoch 20 0.07778660207986832
06:18:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03810887411236763
06:18:30 INFO:birdwatch.matrix_factorization:epoch 40 0.07435906678438187
06:18:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.039273183792829514
06:18:30 INFO:birdwatch.matrix_factorization:epoch 60 0.07353924959897995
06:18:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.037682414054870605
06:18:30 INFO:birdwatch.matrix_factorization:epoch 80 0.07341131567955017
06:18:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03711380809545517
06:18:30 INFO:birdwatch.matrix_factorization:epoch 100 0.07340812683105469
06:18:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03699542209506035
06:18:30 INFO:birdwatch.matrix_factorization:Num epochs: 101
06:18:30 INFO:birdwatch.matrix_factorization:epoch 101 0.07340812683105469
06:18:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03699542209506035
06:18:30 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17440910637378693
06:18:30 INFO:birdwatch.wandb_utils:Finishing W&B run
06:18:30 INFO:birdwatch.constants:Final round MF elapsed time: 3.21 secs (0.05 mins)
06:18:30 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_9 prescoring, about to call diligence with 231172 final round ratings.
06:18:31 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
      raterParticipantId  internalRaterFactor1
0                      3              0.541040
1                    125             -0.649598
2                    183             -0.540044
3                    207             -0.540658
4                    221              0.656018
...                  ...                   ...
7387              801133              0.578593
7388              830806              0.180495
7389              846231             -0.488174
7390              848160              0.431786
7391              849271             -0.528652

[7392 rows x 2 columns]
06:18:31 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:18:31 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 7392, vs. num we are initializing: 7392
06:18:31 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:18:31 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 7392
06:18:31 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:18:31 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:18:31 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:18:31 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:18:31 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:18:31 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=18.737892 | time=0.0s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.157761 | time=0.1s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.632508 | time=0.1s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.520373 | time=0.2s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.482004 | time=0.2s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.462464 | time=0.3s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.450605 | time=0.4s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.442718 | time=0.4s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.437298 | time=0.5s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.433474 | time=0.5s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.430598 | time=0.6s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.1623, device='cuda:0', requires_grad=True)
06:18:31 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.430513 | time=0.0s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.228429 | time=0.1s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.221205 | time=0.1s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.220346 | time=0.2s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.220319 | time=0.2s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.493467 | time=0.0s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.426642 | time=0.0s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.425731 | time=0.1s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.425695 | time=0.1s
06:18:31 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(0.3594, device='cuda:0', requires_grad=True)
06:18:31 INFO:birdwatch.diligence_model:Low diligence training loss: 2.4306, 1.2203, 0.4257
06:18:32 INFO:birdwatch.scorer:MFGroupScorer_9 Low Diligence MF elapsed time: 1.15 secs (0.02 mins)
06:18:33 INFO:birdwatch.note_ratings:dropped 0 out of 580236 ratings due to NaN factor.
06:18:38 INFO:birdwatch.note_ratings:dropped 0 out of 3685 population sampled ratings due to NaN factor.
06:18:38 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:18:38 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:18:39 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:18:39 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:18:39 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:18:39 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:18:39 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:18:40 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:18:40 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:18:40 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:18:40 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:18:41 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:18:41 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:18:41 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:18:41 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:18:41 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:18:41 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:18:42 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:19:30 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.05 secs (0.80 mins)
06:19:34 INFO:birdwatch.constants:MFGroupScorer_9: Compute tag thresholds for percentiles elapsed time: 3.10 secs (0.05 mins)
06:19:42 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_8 set to: 4
06:19:43 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_8.  Original rating length: 19679338
06:19:43 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:19:45 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:19:45 INFO:birdwatch.scorer:  Ratings after group filter: 105461
06:19:45 INFO:birdwatch.scorer:MFGroupScorer_8 Filter input elapsed time: 2.85 secs (0.05 mins)
06:19:45 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_8: 48f94bbab79b6853e870cd80d54b20eeaf5d7213badc90cd199752dada169872
06:19:45 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 0, Num Unique Notes Rated: 0, Num Unique Raters: 0
06:19:45 INFO:birdwatch.scorer:MFGroupScorer_8 Prepare ratings elapsed time: 0.01 secs (0.00 mins)
06:19:45 INFO:birdwatch.mf_base_scorer:MFGroupScorer_8: no ratings after filtering  skipping prescoring.
06:19:45 INFO:birdwatch.scorer:EmptyRatingException raised from MFGroupScorer_8.
06:19:48 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_7 set to: 4
06:19:48 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_7.  Original rating length: 19679338
06:19:48 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:19:50 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:19:51 INFO:birdwatch.scorer:  Ratings after group filter: 297546
06:19:51 INFO:birdwatch.scorer:MFGroupScorer_7 Filter input elapsed time: 2.91 secs (0.05 mins)
06:19:51 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_7: aff37be44567d7b48f963951cee4ac666cfb7a5ce3b34407f60c02d161429762
06:19:51 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 30620, Num Unique Notes Rated: 3600, Num Unique Raters: 2311
06:19:51 INFO:birdwatch.scorer:MFGroupScorer_7 Prepare ratings elapsed time: 0.04 secs (0.00 mins)
06:19:51 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_7: 20f9862022dfa33fa298b8ad42ef1301c194a71a0ae53fa89c20fbf953dbb15c
06:19:52 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_7: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:19:52 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_7: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:19:52 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:19:52 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:19:52 INFO:birdwatch.wandb_utils:W&B is disabled
06:19:52 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:19:52 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:19:52 DEBUG:wandb:no default config file found in config-defaults.yaml
06:19:52 INFO:birdwatch.matrix_factorization:------------------
06:19:52 INFO:birdwatch.matrix_factorization:Users: 2311, Notes: 3600
06:19:52 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:19:52 INFO:birdwatch.matrix_factorization:cuda:0
06:19:52 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 8.505555555555556
06:19:52 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 13.249675465166595
06:19:52 INFO:birdwatch.matrix_factorization:epoch 0 6.9127702713012695
06:19:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.40752649307251
06:19:52 INFO:birdwatch.matrix_factorization:epoch 20 0.24376651644706726
06:19:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.18057715892791748
06:19:52 INFO:birdwatch.matrix_factorization:epoch 40 0.13518600165843964
06:19:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0940067395567894
06:19:52 INFO:birdwatch.matrix_factorization:epoch 60 0.08701963722705841
06:19:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04735163226723671
06:19:52 INFO:birdwatch.matrix_factorization:epoch 80 0.0789053738117218
06:19:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04031933844089508
06:19:53 INFO:birdwatch.matrix_factorization:epoch 100 0.07786370068788528
06:19:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.039360277354717255
06:19:53 INFO:birdwatch.matrix_factorization:epoch 120 0.07772274315357208
06:19:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03913881257176399
06:19:53 INFO:birdwatch.matrix_factorization:epoch 140 0.07769763469696045
06:19:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03912902623414993
06:19:53 INFO:birdwatch.matrix_factorization:epoch 160 0.07768671214580536
06:19:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03911559656262398
06:19:53 INFO:birdwatch.matrix_factorization:Num epochs: 162
06:19:53 INFO:birdwatch.matrix_factorization:epoch 162 0.07768665999174118
06:19:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03912169858813286
06:19:53 INFO:birdwatch.matrix_factorization:Global Intercept: 0.18288002908229828
06:19:53 INFO:birdwatch.wandb_utils:Finishing W&B run
06:19:53 INFO:birdwatch.scorer:MFGroupScorer_7 First MF/stable init elapsed time: 0.42 secs (0.01 mins)
06:19:53 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_7
06:19:54 INFO:birdwatch.note_ratings:dropped 0 out of 138916 ratings due to NaN factor.
06:19:56 INFO:birdwatch.note_ratings:dropped 0 out of 1404 population sampled ratings due to NaN factor.
06:19:57 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:19:57 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:19:57 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:19:57 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:19:58 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:19:58 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:19:58 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:19:58 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:19:59 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:19:59 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:19:59 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:19:59 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:19:59 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:19:59 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:20:00 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:20:00 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:20:00 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:20:01 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:20:50 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 49.39 secs (0.82 mins)
06:20:50 INFO:birdwatch.scorer:MFGroupScorer_7 Compute scored notes elapsed time: 57.62 secs (0.96 mins)
06:20:51 INFO:birdwatch.note_ratings:Total ratings: 297519 post-tombstones and 27 pre-tombstones
06:20:51 INFO:birdwatch.note_ratings:Total ratings created before statuses: 227447, including 227447 post-tombstones and 0 pre-tombstones.
06:20:51 INFO:birdwatch.note_ratings:Total valid ratings: 3344
06:20:51 INFO:birdwatch.scorer:MFGroupScorer_7 Compute valid ratings elapsed time: 0.77 secs (0.01 mins)
06:20:51 INFO:birdwatch.scorer:MFGroupScorer_7 Helpfulness scores pre-harassment  elapsed time: 0.04 secs (0.00 mins)
06:20:51 INFO:birdwatch.helpfulness_scores:Unique Raters: 2311
06:20:51 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 4122
06:20:51 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 2176
06:20:51 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 1072
06:20:51 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 30620
06:20:51 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 16325
06:20:51 INFO:birdwatch.scorer:MFGroupScorer_7 Filtering by helpfulness score elapsed time: 0.02 secs (0.00 mins)
06:20:51 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:20:51 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    11090
1      939
dtype: int64
06:20:51 INFO:birdwatch.tag_consensus:Number of rows with no tag label 4296
06:20:51 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 747, Num Unique Notes Rated: 116, Num Unique Raters: 150
06:20:51 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    707
1     40
dtype: int64
06:20:51 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:20:51 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.0535475234270415
06:20:51 INFO:birdwatch.matrix_factorization:Using pos weight: 17.675 with BCEWithLogitsLoss
06:20:51 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:20:51 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:20:51 INFO:birdwatch.wandb_utils:W&B is disabled
06:20:51 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:20:51 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:20:51 DEBUG:wandb:no default config file found in config-defaults.yaml
06:20:51 INFO:birdwatch.matrix_factorization:------------------
06:20:51 INFO:birdwatch.matrix_factorization:Users: 150, Notes: 116
06:20:51 INFO:birdwatch.matrix_factorization:initializing notes
06:20:51 INFO:birdwatch.matrix_factorization:initializing users
06:20:51 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:20:51 INFO:birdwatch.matrix_factorization:cuda:0
06:20:51 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 6.439655172413793
06:20:51 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 4.98
06:20:51 INFO:birdwatch.matrix_factorization:epoch 0 2.8505611419677734
06:20:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.9786124229431152
06:20:51 INFO:birdwatch.matrix_factorization:epoch 20 0.6060436964035034
06:20:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2056741714477539
06:20:51 INFO:birdwatch.matrix_factorization:epoch 40 0.35328397154808044
06:20:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.12179262191057205
06:20:51 INFO:birdwatch.matrix_factorization:epoch 60 0.27975356578826904
06:20:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09944122284650803
06:20:51 INFO:birdwatch.matrix_factorization:epoch 80 0.27287963032722473
06:20:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09974584728479385
06:20:51 INFO:birdwatch.matrix_factorization:epoch 100 0.2715415954589844
06:20:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09851504117250443
06:20:51 INFO:birdwatch.matrix_factorization:epoch 120 0.27137652039527893
06:20:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09822399169206619
06:20:51 INFO:birdwatch.matrix_factorization:Num epochs: 129
06:20:51 INFO:birdwatch.matrix_factorization:epoch 129 0.2713649570941925
06:20:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09830509126186371
06:20:51 INFO:birdwatch.matrix_factorization:Global Intercept: -0.17191262543201447
06:20:51 INFO:birdwatch.wandb_utils:Finishing W&B run
06:20:51 INFO:birdwatch.scorer:MFGroupScorer_7 Harassment tag consensus elapsed time: 0.35 secs (0.01 mins)
06:20:54 INFO:birdwatch.scorer:MFGroupScorer_7 Helpfulness scores post-harassment elapsed time: 0.04 secs (0.00 mins)
06:20:57 INFO:birdwatch.helpfulness_scores:Unique Raters: 2311
06:20:57 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 4122
06:20:57 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 2176
06:20:57 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 1072
06:20:57 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 30620
06:20:57 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 16325
06:21:00 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:21:00 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:21:00 INFO:birdwatch.wandb_utils:W&B is disabled
06:21:00 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:21:00 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:21:00 DEBUG:wandb:no default config file found in config-defaults.yaml
06:21:00 INFO:birdwatch.matrix_factorization:------------------
06:21:00 INFO:birdwatch.matrix_factorization:Users: 1072, Notes: 3568
06:21:00 INFO:birdwatch.matrix_factorization:initializing notes
06:21:00 INFO:birdwatch.matrix_factorization:initializing users
06:21:00 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:21:00 INFO:birdwatch.matrix_factorization:cuda:0
06:21:00 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 4.575392376681615
06:21:00 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 15.228544776119403
06:21:00 INFO:birdwatch.matrix_factorization:epoch 0 0.3838667869567871
06:21:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3032526969909668
06:21:00 INFO:birdwatch.matrix_factorization:epoch 20 0.07485134154558182
06:21:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03278538957238197
06:21:00 INFO:birdwatch.matrix_factorization:epoch 40 0.0701923668384552
06:21:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.032268986105918884
06:21:00 INFO:birdwatch.matrix_factorization:epoch 60 0.06873974204063416
06:21:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029258567839860916
06:21:00 INFO:birdwatch.matrix_factorization:epoch 80 0.06864237785339355
06:21:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029395539313554764
06:21:00 INFO:birdwatch.matrix_factorization:epoch 100 0.06860611587762833
06:21:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029118869453668594
06:21:00 INFO:birdwatch.matrix_factorization:Num epochs: 102
06:21:00 INFO:birdwatch.matrix_factorization:epoch 102 0.06860623508691788
06:21:00 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0291921254247427
06:21:00 INFO:birdwatch.matrix_factorization:Global Intercept: 0.18329225480556488
06:21:00 INFO:birdwatch.wandb_utils:Finishing W&B run
06:21:00 INFO:birdwatch.constants:Final round MF elapsed time: 3.17 secs (0.05 mins)
06:21:00 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_7 prescoring, about to call diligence with 16325 final round ratings.
06:21:00 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
      raterParticipantId  internalRaterFactor1
0                     33              0.794159
1                     73             -0.672458
2                    297              0.344479
3                    485             -0.267466
4                    502             -0.505632
...                  ...                   ...
1067              736804             -0.560233
1068              738824              0.308221
1069              769505             -0.525114
1070              775044             -0.563892
1071              787729             -0.387657

[1072 rows x 2 columns]
06:21:00 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:21:00 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 1072, vs. num we are initializing: 1072
06:21:00 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:21:00 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 1072
06:21:00 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:21:00 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:21:00 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:21:00 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:21:00 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:21:00 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:21:00 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=18.558975 | time=0.0s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.005693 | time=0.1s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.511857 | time=0.1s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.368394 | time=0.2s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.302117 | time=0.2s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.261804 | time=0.3s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.235067 | time=0.4s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.216964 | time=0.4s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.205235 | time=0.5s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.197124 | time=0.5s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.191535 | time=0.6s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.7230, device='cuda:0', requires_grad=True)
06:21:01 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.191382 | time=0.0s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.961360 | time=0.1s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.954839 | time=0.1s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.953974 | time=0.2s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=0.953949 | time=0.2s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.522398 | time=0.0s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.455813 | time=0.0s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.454878 | time=0.1s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.454841 | time=0.1s
06:21:01 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-1.0375, device='cuda:0', requires_grad=True)
06:21:01 INFO:birdwatch.diligence_model:Low diligence training loss: 2.1915, 0.9539, 0.4548
06:21:01 INFO:birdwatch.scorer:MFGroupScorer_7 Low Diligence MF elapsed time: 0.97 secs (0.02 mins)
06:21:03 INFO:birdwatch.note_ratings:dropped 0 out of 138916 ratings due to NaN factor.
06:21:05 INFO:birdwatch.note_ratings:dropped 0 out of 1404 population sampled ratings due to NaN factor.
06:21:06 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:21:06 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:21:06 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:21:06 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:21:06 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:21:07 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:21:07 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:21:07 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:21:08 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:21:08 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:21:08 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:21:08 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:21:08 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:21:08 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:21:09 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:21:09 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:21:09 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:21:09 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:21:58 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.25 secs (0.80 mins)
06:22:01 INFO:birdwatch.constants:MFGroupScorer_7: Compute tag thresholds for percentiles elapsed time: 2.96 secs (0.05 mins)
06:22:10 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_6 set to: 4
06:22:10 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_6.  Original rating length: 19679338
06:22:10 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:22:12 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:22:13 INFO:birdwatch.scorer:  Ratings after group filter: 747007
06:22:13 INFO:birdwatch.scorer:MFGroupScorer_6 Filter input elapsed time: 3.06 secs (0.05 mins)
06:22:13 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_6: bdbf9491dc2b09f4c9b8ee2ad1b20fa0d1d484c849586aca637d6c107876d0bb
06:22:13 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 241644, Num Unique Notes Rated: 23894, Num Unique Raters: 8715
06:22:13 INFO:birdwatch.scorer:MFGroupScorer_6 Prepare ratings elapsed time: 0.09 secs (0.00 mins)
06:22:14 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_6: b99910f00bde62c79d69ac2f1503c48f57919c449fc21cb47abb869cf78fa4b9
06:22:14 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_6: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:22:15 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_6: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:22:15 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:22:15 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:22:15 INFO:birdwatch.wandb_utils:W&B is disabled
06:22:15 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:22:15 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:22:15 DEBUG:wandb:no default config file found in config-defaults.yaml
06:22:15 INFO:birdwatch.matrix_factorization:------------------
06:22:15 INFO:birdwatch.matrix_factorization:Users: 8715, Notes: 23894
06:22:15 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:22:15 INFO:birdwatch.matrix_factorization:cuda:0
06:22:15 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 10.113166485310119
06:22:15 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 27.72736660929432
06:22:15 INFO:birdwatch.matrix_factorization:epoch 0 6.738144397735596
06:22:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.248408794403076
06:22:15 INFO:birdwatch.matrix_factorization:epoch 20 0.25766682624816895
06:22:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2022600919008255
06:22:15 INFO:birdwatch.matrix_factorization:epoch 40 0.11480394005775452
06:22:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07207696884870529
06:22:15 INFO:birdwatch.matrix_factorization:epoch 60 0.08947157859802246
06:22:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05316070839762688
06:22:15 INFO:birdwatch.matrix_factorization:epoch 80 0.08589537441730499
06:22:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04956229776144028
06:22:15 INFO:birdwatch.matrix_factorization:epoch 100 0.08542242646217346
06:22:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04930168762803078
06:22:15 INFO:birdwatch.matrix_factorization:epoch 120 0.08536188304424286
06:22:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04926634952425957
06:22:15 INFO:birdwatch.matrix_factorization:Num epochs: 139
06:22:15 INFO:birdwatch.matrix_factorization:epoch 139 0.08535420894622803
06:22:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04927365109324455
06:22:15 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17440417408943176
06:22:15 INFO:birdwatch.wandb_utils:Finishing W&B run
06:22:15 INFO:birdwatch.scorer:MFGroupScorer_6 First MF/stable init elapsed time: 0.43 secs (0.01 mins)
06:22:15 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_6
06:22:17 INFO:birdwatch.note_ratings:dropped 0 out of 549097 ratings due to NaN factor.
06:22:22 INFO:birdwatch.note_ratings:dropped 0 out of 2984 population sampled ratings due to NaN factor.
06:22:22 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:22:22 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:22:23 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:22:23 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:22:23 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:22:24 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.73 secs (0.01 mins)
06:22:24 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:22:24 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:22:24 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:22:24 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:22:24 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:22:25 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:22:25 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:22:25 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:22:26 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:22:26 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:22:26 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:22:26 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.72 secs (0.01 mins)
06:23:15 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.51 secs (0.81 mins)
06:23:15 INFO:birdwatch.scorer:MFGroupScorer_6 Compute scored notes elapsed time: 60.02 secs (1.00 mins)
06:23:16 INFO:birdwatch.note_ratings:Total ratings: 746874 post-tombstones and 133 pre-tombstones
06:23:16 INFO:birdwatch.note_ratings:Total ratings created before statuses: 605762, including 605751 post-tombstones and 11 pre-tombstones.
06:23:16 INFO:birdwatch.note_ratings:Total valid ratings: 19187
06:23:16 INFO:birdwatch.scorer:MFGroupScorer_6 Compute valid ratings elapsed time: 0.81 secs (0.01 mins)
06:23:16 INFO:birdwatch.scorer:MFGroupScorer_6 Helpfulness scores pre-harassment  elapsed time: 0.04 secs (0.00 mins)
06:23:16 INFO:birdwatch.helpfulness_scores:Unique Raters: 8715
06:23:16 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 17361
06:23:16 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 7959
06:23:16 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 5332
06:23:16 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 241644
06:23:16 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 173557
06:23:16 INFO:birdwatch.scorer:MFGroupScorer_6 Filtering by helpfulness score elapsed time: 0.03 secs (0.00 mins)
06:23:16 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:23:16 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    110801
1      7399
dtype: int64
06:23:16 INFO:birdwatch.tag_consensus:Number of rows with no tag label 55357
06:23:16 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 62383, Num Unique Notes Rated: 7249, Num Unique Raters: 3011
06:23:16 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    59798
1     2585
dtype: int64
06:23:16 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:23:16 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.04143757113316128
06:23:16 INFO:birdwatch.matrix_factorization:Using pos weight: 23.132688588007735 with BCEWithLogitsLoss
06:23:16 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:23:16 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:23:16 INFO:birdwatch.wandb_utils:W&B is disabled
06:23:16 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:23:16 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:23:16 DEBUG:wandb:no default config file found in config-defaults.yaml
06:23:16 INFO:birdwatch.matrix_factorization:------------------
06:23:16 INFO:birdwatch.matrix_factorization:Users: 3011, Notes: 7249
06:23:16 INFO:birdwatch.matrix_factorization:initializing notes
06:23:16 INFO:birdwatch.matrix_factorization:initializing users
06:23:16 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:23:16 INFO:birdwatch.matrix_factorization:cuda:0
06:23:16 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 8.605738722582425
06:23:16 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 20.718365991364994
06:23:16 INFO:birdwatch.matrix_factorization:epoch 0 3.157904863357544
06:23:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.288306474685669
06:23:16 INFO:birdwatch.matrix_factorization:epoch 20 0.7388465404510498
06:23:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.35451263189315796
06:23:16 INFO:birdwatch.matrix_factorization:epoch 40 0.47270259261131287
06:23:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.25581297278404236
06:23:16 INFO:birdwatch.matrix_factorization:epoch 60 0.42174968123435974
06:23:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23701763153076172
06:23:16 INFO:birdwatch.matrix_factorization:epoch 80 0.40769144892692566
06:23:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.22936289012432098
06:23:16 INFO:birdwatch.matrix_factorization:epoch 100 0.3955317735671997
06:23:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.22030991315841675
06:23:16 INFO:birdwatch.matrix_factorization:epoch 120 0.3829154074192047
06:23:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21104279160499573
06:23:16 INFO:birdwatch.matrix_factorization:Num epochs: 129
06:23:16 INFO:birdwatch.matrix_factorization:epoch 129 0.3810824751853943
06:23:16 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.20977914333343506
06:23:16 INFO:birdwatch.matrix_factorization:Global Intercept: -0.3643696904182434
06:23:16 INFO:birdwatch.wandb_utils:Finishing W&B run
06:23:16 INFO:birdwatch.scorer:MFGroupScorer_6 Harassment tag consensus elapsed time: 0.43 secs (0.01 mins)
06:23:19 INFO:birdwatch.scorer:MFGroupScorer_6 Helpfulness scores post-harassment elapsed time: 0.06 secs (0.00 mins)
06:23:22 INFO:birdwatch.helpfulness_scores:Unique Raters: 8715
06:23:22 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 17361
06:23:22 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 7893
06:23:22 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 5266
06:23:22 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 241644
06:23:22 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 170129
06:23:25 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:23:25 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:23:25 INFO:birdwatch.wandb_utils:W&B is disabled
06:23:25 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:23:25 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:23:25 DEBUG:wandb:no default config file found in config-defaults.yaml
06:23:25 INFO:birdwatch.matrix_factorization:------------------
06:23:25 INFO:birdwatch.matrix_factorization:Users: 5266, Notes: 23879
06:23:25 INFO:birdwatch.matrix_factorization:initializing notes
06:23:25 INFO:birdwatch.matrix_factorization:initializing users
06:23:25 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:23:25 INFO:birdwatch.matrix_factorization:cuda:0
06:23:25 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 7.124628334519871
06:23:25 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 32.30706418533992
06:23:25 INFO:birdwatch.matrix_factorization:epoch 0 0.3892778754234314
06:23:25 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3123006224632263
06:23:25 INFO:birdwatch.matrix_factorization:epoch 20 0.08365686237812042
06:23:25 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04457072541117668
06:23:25 INFO:birdwatch.matrix_factorization:epoch 40 0.08110284805297852
06:23:25 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.046008575707674026
06:23:25 INFO:birdwatch.matrix_factorization:epoch 60 0.08007588982582092
06:23:25 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04387911781668663
06:23:25 INFO:birdwatch.matrix_factorization:epoch 80 0.07999709993600845
06:23:25 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04359149560332298
06:23:25 INFO:birdwatch.matrix_factorization:epoch 100 0.07999257743358612
06:23:25 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04343363270163536
06:23:25 INFO:birdwatch.matrix_factorization:Num epochs: 101
06:23:25 INFO:birdwatch.matrix_factorization:epoch 101 0.07999257743358612
06:23:25 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04343363270163536
06:23:25 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17486587166786194
06:23:25 INFO:birdwatch.wandb_utils:Finishing W&B run
06:23:25 INFO:birdwatch.constants:Final round MF elapsed time: 3.23 secs (0.05 mins)
06:23:25 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_6 prescoring, about to call diligence with 170129 final round ratings.
06:23:26 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
      raterParticipantId  internalRaterFactor1
0                      8             -0.727665
1                    131             -0.549158
2                    305              0.599814
3                    306             -0.297640
4                    333              0.718431
...                  ...                   ...
5261              805807             -0.227611
5262              810440             -0.300276
5263              811708              0.142341
5264              814270             -0.529460
5265              815264             -0.009780

[5266 rows x 2 columns]
06:23:26 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:23:26 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 5266, vs. num we are initializing: 5266
06:23:26 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:23:26 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 5266
06:23:26 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:23:26 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:23:26 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:23:26 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:23:26 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:23:26 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=16.660213 | time=0.0s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.163346 | time=0.1s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.675908 | time=0.1s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.565574 | time=0.2s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.521646 | time=0.2s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.497321 | time=0.3s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.482041 | time=0.4s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.471762 | time=0.4s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.464199 | time=0.5s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.459047 | time=0.5s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.455419 | time=0.6s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.6067, device='cuda:0', requires_grad=True)
06:23:26 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.455317 | time=0.0s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.273772 | time=0.1s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.266482 | time=0.1s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=070 | loss=1.265850 | time=0.1s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.528206 | time=0.0s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.464071 | time=0.0s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.463180 | time=0.1s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.463146 | time=0.1s
06:23:26 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-0.1970, device='cuda:0', requires_grad=True)
06:23:26 INFO:birdwatch.diligence_model:Low diligence training loss: 2.4554, 1.2659, 0.4631
06:23:26 INFO:birdwatch.scorer:MFGroupScorer_6 Low Diligence MF elapsed time: 1.04 secs (0.02 mins)
06:23:28 INFO:birdwatch.note_ratings:dropped 0 out of 549097 ratings due to NaN factor.
06:23:33 INFO:birdwatch.note_ratings:dropped 0 out of 2984 population sampled ratings due to NaN factor.
06:23:34 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:23:34 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:23:34 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:23:34 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:23:35 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:23:35 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:23:35 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:23:35 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:23:36 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:23:36 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:23:36 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:23:36 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:23:36 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:23:36 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:23:37 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:23:37 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:23:37 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:23:38 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.72 secs (0.01 mins)
06:24:26 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.11 secs (0.80 mins)
06:24:29 INFO:birdwatch.constants:MFGroupScorer_6: Compute tag thresholds for percentiles elapsed time: 3.13 secs (0.05 mins)
06:24:38 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_5 set to: 4
06:24:38 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_5.  Original rating length: 19679338
06:24:38 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:24:41 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:24:41 INFO:birdwatch.scorer:  Ratings after group filter: 83489
06:24:41 INFO:birdwatch.scorer:MFGroupScorer_5 Filter input elapsed time: 2.94 secs (0.05 mins)
06:24:41 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_5: 159af4b0b88bf661d5cda994b9f6acf0c1cfa100d5593ee084539a17d8e56d1d
06:24:41 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 411, Num Unique Notes Rated: 70, Num Unique Raters: 139
06:24:41 INFO:birdwatch.scorer:MFGroupScorer_5 Prepare ratings elapsed time: 0.01 secs (0.00 mins)
06:24:41 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_5: 85fc45742fa2655b37c570dc82ec23d776f5e8c47e878b98197bd6a0a1e0c1bd
06:24:42 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_5: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:24:42 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_5: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:24:42 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:24:42 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:24:42 INFO:birdwatch.wandb_utils:W&B is disabled
06:24:42 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:24:42 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:24:42 DEBUG:wandb:no default config file found in config-defaults.yaml
06:24:42 INFO:birdwatch.matrix_factorization:------------------
06:24:42 INFO:birdwatch.matrix_factorization:Users: 139, Notes: 70
06:24:42 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:24:42 INFO:birdwatch.matrix_factorization:cuda:0
06:24:42 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 5.871428571428571
06:24:42 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 2.9568345323741005
06:24:42 INFO:birdwatch.matrix_factorization:epoch 0 6.348745822906494
06:24:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 5.841401100158691
06:24:42 INFO:birdwatch.matrix_factorization:epoch 20 0.2358132004737854
06:24:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1557207703590393
06:24:42 INFO:birdwatch.matrix_factorization:epoch 40 0.09156511723995209
06:24:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03828171640634537
06:24:43 INFO:birdwatch.matrix_factorization:epoch 60 0.06469303369522095
06:24:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.017892086878418922
06:24:43 INFO:birdwatch.matrix_factorization:epoch 80 0.05958348512649536
06:24:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.013299726881086826
06:24:43 INFO:birdwatch.matrix_factorization:epoch 100 0.05837088078260422
06:24:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.012729069218039513
06:24:43 INFO:birdwatch.matrix_factorization:Num epochs: 112
06:24:43 INFO:birdwatch.matrix_factorization:epoch 112 0.05631645768880844
06:24:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.010038422420620918
06:24:43 INFO:birdwatch.matrix_factorization:Global Intercept: 0.19074976444244385
06:24:43 INFO:birdwatch.wandb_utils:Finishing W&B run
06:24:43 INFO:birdwatch.scorer:MFGroupScorer_5 First MF/stable init elapsed time: 0.28 secs (0.00 mins)
06:24:43 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_5
06:24:44 INFO:birdwatch.note_ratings:dropped 0 out of 14718 ratings due to NaN factor.
06:24:45 INFO:birdwatch.note_ratings:dropped 0 out of 156 population sampled ratings due to NaN factor.
06:24:46 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:24:46 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:24:47 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 1.19 secs (0.02 mins)
06:24:47 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:24:47 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:24:47 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:24:47 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:24:47 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:24:48 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:24:48 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:24:48 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:24:49 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:24:49 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:24:49 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:24:49 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:24:49 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:24:49 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:24:50 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:25:38 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.92 secs (0.80 mins)
06:25:38 INFO:birdwatch.scorer:MFGroupScorer_5 Compute scored notes elapsed time: 55.49 secs (0.92 mins)
06:25:38 INFO:birdwatch.note_ratings:Total ratings: 83481 post-tombstones and 8 pre-tombstones
06:25:38 INFO:birdwatch.note_ratings:Total ratings created before statuses: 67374, including 67374 post-tombstones and 0 pre-tombstones.
06:25:39 INFO:birdwatch.note_ratings:Total valid ratings: 207
06:25:39 INFO:birdwatch.scorer:MFGroupScorer_5 Compute valid ratings elapsed time: 0.53 secs (0.01 mins)
06:25:39 INFO:birdwatch.scorer:MFGroupScorer_5 Helpfulness scores pre-harassment  elapsed time: 0.03 secs (0.00 mins)
06:25:39 INFO:birdwatch.helpfulness_scores:Unique Raters: 139
06:25:39 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 245
06:25:39 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 149
06:25:39 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 52
06:25:39 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 411
06:25:39 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 181
06:25:39 INFO:birdwatch.scorer:MFGroupScorer_5 Filtering by helpfulness score elapsed time: 0.01 secs (0.00 mins)
06:25:39 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:25:39 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    116
1      8
dtype: int64
06:25:39 INFO:birdwatch.tag_consensus:Number of rows with no tag label 57
06:25:39 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 0, Num Unique Notes Rated: 0, Num Unique Raters: 0
06:25:39 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown Series([], dtype: int64)
06:25:39 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:25:39 INFO:birdwatch.tag_consensus:No valid data for notHelpfulSpamHarassmentOrAbuse, returning None and aborting notHelpfulSpamHarassmentOrAbuse model training.
06:25:39 INFO:birdwatch.scorer:MFGroupScorer_5 Harassment tag consensus elapsed time: 0.01 secs (0.00 mins)
06:25:42 INFO:birdwatch.scorer:MFGroupScorer_5 Helpfulness scores post-harassment elapsed time: 0.04 secs (0.00 mins)
06:25:44 INFO:birdwatch.helpfulness_scores:Unique Raters: 139
06:25:44 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 245
06:25:44 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 149
06:25:44 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 52
06:25:44 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 411
06:25:44 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 181
06:25:47 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:25:47 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:25:47 INFO:birdwatch.wandb_utils:W&B is disabled
06:25:47 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:25:47 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:25:47 DEBUG:wandb:no default config file found in config-defaults.yaml
06:25:47 INFO:birdwatch.matrix_factorization:------------------
06:25:47 INFO:birdwatch.matrix_factorization:Users: 52, Notes: 68
06:25:47 INFO:birdwatch.matrix_factorization:initializing notes
06:25:47 INFO:birdwatch.matrix_factorization:initializing users
06:25:47 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:25:47 INFO:birdwatch.matrix_factorization:cuda:0
06:25:47 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 2.661764705882353
06:25:47 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 3.480769230769231
06:25:47 INFO:birdwatch.matrix_factorization:epoch 0 0.3305974304676056
06:25:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.24870939552783966
06:25:47 INFO:birdwatch.matrix_factorization:epoch 20 0.0506700724363327
06:25:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.01079882774502039
06:25:47 INFO:birdwatch.matrix_factorization:epoch 40 0.04582872614264488
06:25:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.009163559414446354
06:25:47 INFO:birdwatch.matrix_factorization:epoch 60 0.043072763830423355
06:25:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.004921245388686657
06:25:47 INFO:birdwatch.matrix_factorization:epoch 80 0.04147786647081375
06:25:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.00428256019949913
06:25:47 INFO:birdwatch.matrix_factorization:Num epochs: 100
06:25:47 INFO:birdwatch.matrix_factorization:epoch 100 0.041188959032297134
06:25:47 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.004349543247371912
06:25:47 INFO:birdwatch.matrix_factorization:Global Intercept: 0.16081702709197998
06:25:47 INFO:birdwatch.wandb_utils:Finishing W&B run
06:25:47 INFO:birdwatch.constants:Final round MF elapsed time: 3.07 secs (0.05 mins)
06:25:47 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_5 prescoring, about to call diligence with 181 final round ratings.
06:25:47 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
    raterParticipantId  internalRaterFactor1
0                 6467              0.532485
1                12203              0.481065
2                14602             -0.694365
3                15006              0.001856
4                23231             -0.621877
5                25227              0.496611
6                25835              0.513091
7                29930             -0.487139
8                30039             -0.712035
9                31813             -0.625020
10               46905             -0.643937
11               64519              0.358578
12               64794             -0.503824
13               67172             -0.034508
14               67294             -0.738010
15               69724             -0.599358
16               77801              0.018643
17               84539              0.720836
18               87710              0.097852
19               92988             -0.574045
20               98142              0.377715
21               99670             -0.759057
22              101082             -0.633525
23              101271             -0.016539
24              104139              0.018662
25              105339             -0.639027
26              106763              0.111063
27              110968             -0.549779
28              116579             -0.716135
29              124351              0.302502
30              125265              0.101267
31              125382              0.629463
32              127996              0.213104
33              140651              0.070290
34              145752             -0.591474
35              150056             -0.518380
36              153941             -0.685756
37              155557             -0.611297
38              159457             -0.600410
39              188183             -0.337734
40              190376             -0.678157
41              204896              0.203456
42              263540             -0.592340
43              268666              0.002871
44              303605             -0.580527
45              313395             -0.534593
46              357425              0.022380
47              424316             -0.320855
48              468420             -0.581294
49              484909              0.968011
50              487160              0.582183
51              559318             -0.611257
06:25:47 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:25:47 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 52, vs. num we are initializing: 52
06:25:47 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:25:47 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 52
06:25:47 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:25:47 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:25:47 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:25:47 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:25:47 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:25:47 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:25:47 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=20.887545 | time=0.0s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=2.587108 | time=0.0s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.192383 | time=0.1s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.071828 | time=0.1s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.015954 | time=0.2s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=1.980516 | time=0.2s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=1.954886 | time=0.3s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=1.937699 | time=0.3s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=1.924643 | time=0.4s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=1.914378 | time=0.4s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=1.906228 | time=0.5s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.4643, device='cuda:0', requires_grad=True)
06:25:48 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=1.905987 | time=0.0s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.485123 | time=0.0s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.471916 | time=0.1s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.469897 | time=0.1s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.469897 | time=0.1s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.373007 | time=0.0s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.302023 | time=0.0s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.300777 | time=0.1s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.300721 | time=0.1s
06:25:48 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-2.6893, device='cuda:0', requires_grad=True)
06:25:48 INFO:birdwatch.diligence_model:Low diligence training loss: 1.9062, 0.4699, 0.3007
06:25:48 INFO:birdwatch.scorer:MFGroupScorer_5 Low Diligence MF elapsed time: 0.79 secs (0.01 mins)
06:25:49 INFO:birdwatch.note_ratings:dropped 0 out of 14718 ratings due to NaN factor.
06:25:51 INFO:birdwatch.note_ratings:dropped 0 out of 156 population sampled ratings due to NaN factor.
06:25:51 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:25:51 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:25:52 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:25:52 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:25:52 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:25:52 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:25:52 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:25:52 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:25:53 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:25:53 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:25:53 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:25:53 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:25:53 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:25:53 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:25:54 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:25:54 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:25:54 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:25:55 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:26:43 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.99 secs (0.80 mins)
06:26:46 INFO:birdwatch.constants:MFGroupScorer_5: Compute tag thresholds for percentiles elapsed time: 2.86 secs (0.05 mins)
06:26:55 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_4 set to: 4
06:26:55 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_4.  Original rating length: 19679338
06:26:55 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:26:57 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:26:57 INFO:birdwatch.scorer:  Ratings after group filter: 290683
06:26:57 INFO:birdwatch.scorer:MFGroupScorer_4 Filter input elapsed time: 2.83 secs (0.05 mins)
06:26:58 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_4: af64da0e9077ee6548ac63d440fd0cdb338f225bbaaef29598a25d5d22bb6499
06:26:58 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 86686, Num Unique Notes Rated: 9012, Num Unique Raters: 4070
06:26:58 INFO:birdwatch.scorer:MFGroupScorer_4 Prepare ratings elapsed time: 0.04 secs (0.00 mins)
06:26:58 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_4: 9256e7b9f61adc7f1d51f3d0bc0e556d1b8fbc454b2c2e64aaf629e7c57efb39
06:26:58 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_4: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:26:59 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_4: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:26:59 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:26:59 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:26:59 INFO:birdwatch.wandb_utils:W&B is disabled
06:26:59 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:26:59 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:26:59 DEBUG:wandb:no default config file found in config-defaults.yaml
06:26:59 INFO:birdwatch.matrix_factorization:------------------
06:26:59 INFO:birdwatch.matrix_factorization:Users: 4070, Notes: 9012
06:26:59 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:26:59 INFO:birdwatch.matrix_factorization:cuda:0
06:26:59 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 9.618952507767421
06:26:59 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 21.298771498771497
06:26:59 INFO:birdwatch.matrix_factorization:epoch 0 7.009344577789307
06:26:59 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.5114264488220215
06:26:59 INFO:birdwatch.matrix_factorization:epoch 20 0.26245972514152527
06:26:59 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.20738531649112701
06:26:59 INFO:birdwatch.matrix_factorization:epoch 40 0.09902691096067429
06:26:59 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.057687729597091675
06:26:59 INFO:birdwatch.matrix_factorization:epoch 60 0.07238221913576126
06:26:59 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03563486039638519
06:26:59 INFO:birdwatch.matrix_factorization:epoch 80 0.06911106407642365
06:26:59 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03318563476204872
06:26:59 INFO:birdwatch.matrix_factorization:epoch 100 0.0686664804816246
06:26:59 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03270305320620537
06:26:59 INFO:birdwatch.matrix_factorization:epoch 120 0.06860770285129547
06:26:59 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.032560236752033234
06:26:59 INFO:birdwatch.matrix_factorization:Num epochs: 140
06:26:59 INFO:birdwatch.matrix_factorization:epoch 140 0.06860019266605377
06:26:59 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03258735314011574
06:26:59 INFO:birdwatch.matrix_factorization:Global Intercept: 0.16149859130382538
06:26:59 INFO:birdwatch.wandb_utils:Finishing W&B run
06:26:59 INFO:birdwatch.scorer:MFGroupScorer_4 First MF/stable init elapsed time: 0.38 secs (0.01 mins)
06:26:59 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_4
06:27:00 INFO:birdwatch.note_ratings:dropped 0 out of 190008 ratings due to NaN factor.
06:27:03 INFO:birdwatch.note_ratings:dropped 0 out of 1317 population sampled ratings due to NaN factor.
06:27:03 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:27:03 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:27:04 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:27:04 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:27:04 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:27:04 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:27:04 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:27:04 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:27:05 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:27:05 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:27:05 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:27:06 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:27:06 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:27:06 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:27:06 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:27:06 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:27:06 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:27:07 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:27:55 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.84 secs (0.80 mins)
06:27:55 INFO:birdwatch.scorer:MFGroupScorer_4 Compute scored notes elapsed time: 55.95 secs (0.93 mins)
06:27:55 INFO:birdwatch.note_ratings:Total ratings: 290649 post-tombstones and 34 pre-tombstones
06:27:55 INFO:birdwatch.note_ratings:Total ratings created before statuses: 240989, including 240989 post-tombstones and 0 pre-tombstones.
06:27:56 INFO:birdwatch.note_ratings:Total valid ratings: 6551
06:27:56 INFO:birdwatch.scorer:MFGroupScorer_4 Compute valid ratings elapsed time: 0.59 secs (0.01 mins)
06:27:56 INFO:birdwatch.scorer:MFGroupScorer_4 Helpfulness scores pre-harassment  elapsed time: 0.03 secs (0.00 mins)
06:27:56 INFO:birdwatch.helpfulness_scores:Unique Raters: 4070
06:27:56 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 6990
06:27:56 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 3646
06:27:56 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 2239
06:27:56 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 86686
06:27:56 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 55123
06:27:56 INFO:birdwatch.scorer:MFGroupScorer_4 Filtering by helpfulness score elapsed time: 0.02 secs (0.00 mins)
06:27:56 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:27:56 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    33443
1     4567
dtype: int64
06:27:56 INFO:birdwatch.tag_consensus:Number of rows with no tag label 17113
06:27:56 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 12636, Num Unique Notes Rated: 1787, Num Unique Raters: 912
06:27:56 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    11403
1     1233
dtype: int64
06:27:56 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:27:56 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.09757834757834757
06:27:56 INFO:birdwatch.matrix_factorization:Using pos weight: 9.248175182481752 with BCEWithLogitsLoss
06:27:56 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:27:56 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:27:56 INFO:birdwatch.wandb_utils:W&B is disabled
06:27:56 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:27:56 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:27:56 DEBUG:wandb:no default config file found in config-defaults.yaml
06:27:56 INFO:birdwatch.matrix_factorization:------------------
06:27:56 INFO:birdwatch.matrix_factorization:Users: 912, Notes: 1787
06:27:56 INFO:birdwatch.matrix_factorization:initializing notes
06:27:56 INFO:birdwatch.matrix_factorization:initializing users
06:27:56 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:27:56 INFO:birdwatch.matrix_factorization:cuda:0
06:27:56 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 7.071068830442082
06:27:56 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 13.855263157894736
06:27:56 INFO:birdwatch.matrix_factorization:epoch 0 3.399651050567627
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.5550711154937744
06:27:56 INFO:birdwatch.matrix_factorization:epoch 20 0.824771523475647
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.451128751039505
06:27:56 INFO:birdwatch.matrix_factorization:epoch 40 0.5063612461090088
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.28333544731140137
06:27:56 INFO:birdwatch.matrix_factorization:epoch 60 0.36623096466064453
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.17409592866897583
06:27:56 INFO:birdwatch.matrix_factorization:epoch 80 0.3108261823654175
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.12875135242938995
06:27:56 INFO:birdwatch.matrix_factorization:epoch 100 0.3015134334564209
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.12721329927444458
06:27:56 INFO:birdwatch.matrix_factorization:epoch 120 0.30047836899757385
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1268453747034073
06:27:56 INFO:birdwatch.matrix_factorization:epoch 140 0.3003280460834503
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1268739253282547
06:27:56 INFO:birdwatch.matrix_factorization:epoch 160 0.3003104329109192
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1268656998872757
06:27:56 INFO:birdwatch.matrix_factorization:Num epochs: 169
06:27:56 INFO:birdwatch.matrix_factorization:epoch 169 0.3003089427947998
06:27:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.12688171863555908
06:27:56 INFO:birdwatch.matrix_factorization:Global Intercept: -0.1835447996854782
06:27:56 INFO:birdwatch.wandb_utils:Finishing W&B run
06:27:56 INFO:birdwatch.scorer:MFGroupScorer_4 Harassment tag consensus elapsed time: 0.47 secs (0.01 mins)
06:27:59 INFO:birdwatch.scorer:MFGroupScorer_4 Helpfulness scores post-harassment elapsed time: 0.05 secs (0.00 mins)
06:28:02 INFO:birdwatch.helpfulness_scores:Unique Raters: 4070
06:28:02 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 6990
06:28:02 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 3646
06:28:02 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 2239
06:28:02 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 86686
06:28:02 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 55123
06:28:05 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:28:05 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:28:05 INFO:birdwatch.wandb_utils:W&B is disabled
06:28:05 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:28:05 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:28:05 DEBUG:wandb:no default config file found in config-defaults.yaml
06:28:05 INFO:birdwatch.matrix_factorization:------------------
06:28:05 INFO:birdwatch.matrix_factorization:Users: 2239, Notes: 8992
06:28:05 INFO:birdwatch.matrix_factorization:initializing notes
06:28:05 INFO:birdwatch.matrix_factorization:initializing users
06:28:05 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:28:05 INFO:birdwatch.matrix_factorization:cuda:0
06:28:05 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 6.130226868327402
06:28:05 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 24.619472979008485
06:28:05 INFO:birdwatch.matrix_factorization:epoch 0 0.41067737340927124
06:28:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.33368003368377686
06:28:05 INFO:birdwatch.matrix_factorization:epoch 20 0.0667952299118042
06:28:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.027532659471035004
06:28:05 INFO:birdwatch.matrix_factorization:epoch 40 0.06340204179286957
06:28:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02835952490568161
06:28:05 INFO:birdwatch.matrix_factorization:epoch 60 0.06263416260480881
06:28:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02702905423939228
06:28:05 INFO:birdwatch.matrix_factorization:epoch 80 0.06248629838228226
06:28:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.026401901617646217
06:28:05 INFO:birdwatch.matrix_factorization:epoch 100 0.06248190253973007
06:28:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02633158676326275
06:28:05 INFO:birdwatch.matrix_factorization:Num epochs: 101
06:28:05 INFO:birdwatch.matrix_factorization:epoch 101 0.06248190253973007
06:28:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02633158676326275
06:28:05 INFO:birdwatch.matrix_factorization:Global Intercept: 0.15922006964683533
06:28:05 INFO:birdwatch.wandb_utils:Finishing W&B run
06:28:05 INFO:birdwatch.constants:Final round MF elapsed time: 3.12 secs (0.05 mins)
06:28:05 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_4 prescoring, about to call diligence with 55123 final round ratings.
06:28:05 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
      raterParticipantId  internalRaterFactor1
0                    319              0.313332
1                    483             -0.661491
2                    547             -0.661142
3                    778              0.418479
4                    845              0.246775
...                  ...                   ...
2234              746075             -0.565644
2235              751638              0.579571
2236              766484              0.503568
2237              810237             -0.578632
2238              819827             -0.280843

[2239 rows x 2 columns]
06:28:05 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:28:05 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 2239, vs. num we are initializing: 2239
06:28:05 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:28:05 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 2239
06:28:05 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:28:05 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:28:05 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:28:05 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:28:05 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:28:05 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=23.071545 | time=0.0s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.344079 | time=0.1s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.699969 | time=0.1s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.548564 | time=0.2s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.496081 | time=0.2s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.470021 | time=0.3s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.453884 | time=0.4s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.442774 | time=0.4s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.434635 | time=0.5s
06:28:05 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.429028 | time=0.5s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.425024 | time=0.6s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(0.1881, device='cuda:0', requires_grad=True)
06:28:06 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.424904 | time=0.0s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.253989 | time=0.1s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.245882 | time=0.1s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.245075 | time=0.2s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.245051 | time=0.2s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.534111 | time=0.0s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.463775 | time=0.0s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.462822 | time=0.1s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.462785 | time=0.1s
06:28:06 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(0.4525, device='cuda:0', requires_grad=True)
06:28:06 INFO:birdwatch.diligence_model:Low diligence training loss: 2.4250, 1.2451, 0.4628
06:28:06 INFO:birdwatch.scorer:MFGroupScorer_4 Low Diligence MF elapsed time: 0.98 secs (0.02 mins)
06:28:07 INFO:birdwatch.note_ratings:dropped 0 out of 190008 ratings due to NaN factor.
06:28:10 INFO:birdwatch.note_ratings:dropped 0 out of 1317 population sampled ratings due to NaN factor.
06:28:10 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:28:10 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:28:11 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:28:11 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:28:11 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:28:11 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:28:11 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:28:11 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:28:12 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:28:12 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:28:12 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:28:12 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:28:12 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:28:12 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:28:13 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:28:13 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:28:13 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:28:14 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:29:08 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 54.22 secs (0.90 mins)
06:29:13 INFO:birdwatch.constants:MFGroupScorer_4: Compute tag thresholds for percentiles elapsed time: 4.31 secs (0.07 mins)
06:29:25 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_3 set to: 4
06:29:26 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_3.  Original rating length: 19679338
06:29:26 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:29:29 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:29:30 INFO:birdwatch.scorer:  Ratings after group filter: 914651
06:29:30 INFO:birdwatch.scorer:MFGroupScorer_3 Filter input elapsed time: 4.40 secs (0.07 mins)
06:29:30 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_3: fff63ee48b6ea00e46f4ecbded4b178ef25bb62f565135026b0dee1c08fc44de
06:29:30 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 396977, Num Unique Notes Rated: 35143, Num Unique Raters: 14898
06:29:30 INFO:birdwatch.scorer:MFGroupScorer_3 Prepare ratings elapsed time: 0.17 secs (0.00 mins)
06:29:31 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_3: 2156575ca945a5d2f579f2ec3f0c0e7fced5641deb8bd7398487d6b84b454144
06:29:32 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_3: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:29:32 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_3: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:29:32 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:29:32 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:29:32 INFO:birdwatch.wandb_utils:W&B is disabled
06:29:32 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:29:32 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:29:32 DEBUG:wandb:no default config file found in config-defaults.yaml
06:29:32 INFO:birdwatch.matrix_factorization:------------------
06:29:32 INFO:birdwatch.matrix_factorization:Users: 14898, Notes: 35143
06:29:32 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:29:32 INFO:birdwatch.matrix_factorization:cuda:0
06:29:32 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 11.29604757704237
06:29:32 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 26.646328366223653
06:29:32 INFO:birdwatch.matrix_factorization:epoch 0 6.407333850860596
06:29:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 5.922914981842041
06:29:32 INFO:birdwatch.matrix_factorization:epoch 20 0.2444831132888794
06:29:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.18989592790603638
06:29:32 INFO:birdwatch.matrix_factorization:epoch 40 0.12396717816591263
06:29:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.08239559829235077
06:29:32 INFO:birdwatch.matrix_factorization:epoch 60 0.09484493732452393
06:29:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.058028414845466614
06:29:33 INFO:birdwatch.matrix_factorization:epoch 80 0.09091076999902725
06:29:33 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.054145872592926025
06:29:33 INFO:birdwatch.matrix_factorization:epoch 100 0.09037481993436813
06:29:33 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0538821667432785
06:29:33 INFO:birdwatch.matrix_factorization:epoch 120 0.09030622243881226
06:29:33 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05386729538440704
06:29:33 INFO:birdwatch.matrix_factorization:epoch 140 0.09029742330312729
06:29:33 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05386936664581299
06:29:33 INFO:birdwatch.matrix_factorization:Num epochs: 142
06:29:33 INFO:birdwatch.matrix_factorization:epoch 142 0.09029732644557953
06:29:33 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05386168137192726
06:29:33 INFO:birdwatch.matrix_factorization:Global Intercept: 0.18393225967884064
06:29:33 INFO:birdwatch.wandb_utils:Finishing W&B run
06:29:33 INFO:birdwatch.scorer:MFGroupScorer_3 First MF/stable init elapsed time: 0.67 secs (0.01 mins)
06:29:33 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_3
06:29:35 INFO:birdwatch.note_ratings:dropped 0 out of 676079 ratings due to NaN factor.
06:29:43 INFO:birdwatch.note_ratings:dropped 0 out of 5890 population sampled ratings due to NaN factor.
06:29:43 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:29:43 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:29:44 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:29:44 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:29:44 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:29:45 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.84 secs (0.01 mins)
06:29:45 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:29:45 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:29:45 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:29:45 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:29:45 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:29:46 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.65 secs (0.01 mins)
06:29:46 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:29:46 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:29:47 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.65 secs (0.01 mins)
06:29:47 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:29:47 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:29:48 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.78 secs (0.01 mins)
06:30:41 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 53.15 secs (0.89 mins)
06:30:41 INFO:birdwatch.scorer:MFGroupScorer_3 Compute scored notes elapsed time: 68.30 secs (1.14 mins)
06:30:42 INFO:birdwatch.note_ratings:Total ratings: 914545 post-tombstones and 106 pre-tombstones
06:30:42 INFO:birdwatch.note_ratings:Total ratings created before statuses: 693774, including 693774 post-tombstones and 0 pre-tombstones.
06:30:42 INFO:birdwatch.note_ratings:Total valid ratings: 33908
06:30:42 INFO:birdwatch.scorer:MFGroupScorer_3 Compute valid ratings elapsed time: 0.97 secs (0.02 mins)
06:30:42 INFO:birdwatch.scorer:MFGroupScorer_3 Helpfulness scores pre-harassment  elapsed time: 0.05 secs (0.00 mins)
06:30:42 INFO:birdwatch.helpfulness_scores:Unique Raters: 14898
06:30:42 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 25273
06:30:42 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 14750
06:30:42 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 8928
06:30:42 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 396977
06:30:42 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 270845
06:30:42 INFO:birdwatch.scorer:MFGroupScorer_3 Filtering by helpfulness score elapsed time: 0.05 secs (0.00 mins)
06:30:42 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:30:42 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    187893
1      9656
dtype: int64
06:30:42 INFO:birdwatch.tag_consensus:Number of rows with no tag label 73296
06:30:42 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 114074, Num Unique Notes Rated: 12215, Num Unique Raters: 4932
06:30:42 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    110062
1      4012
dtype: int64
06:30:42 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:30:42 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.03517015270789137
06:30:42 INFO:birdwatch.matrix_factorization:Using pos weight: 27.433200398803592 with BCEWithLogitsLoss
06:30:42 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:30:42 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:30:42 INFO:birdwatch.wandb_utils:W&B is disabled
06:30:42 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:30:42 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:30:42 DEBUG:wandb:no default config file found in config-defaults.yaml
06:30:42 INFO:birdwatch.matrix_factorization:------------------
06:30:42 INFO:birdwatch.matrix_factorization:Users: 4932, Notes: 12215
06:30:42 INFO:birdwatch.matrix_factorization:initializing notes
06:30:42 INFO:birdwatch.matrix_factorization:initializing users
06:30:42 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:30:42 INFO:birdwatch.matrix_factorization:cuda:0
06:30:42 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 9.338845681539091
06:30:42 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 23.129359286293592
06:30:42 INFO:birdwatch.matrix_factorization:epoch 0 3.204444408416748
06:30:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.3195112943649292
06:30:42 INFO:birdwatch.matrix_factorization:epoch 20 0.7129182815551758
06:30:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.33108052611351013
06:30:42 INFO:birdwatch.matrix_factorization:epoch 40 0.46364057064056396
06:30:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2572668790817261
06:30:42 INFO:birdwatch.matrix_factorization:epoch 60 0.4206271171569824
06:30:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23826241493225098
06:30:43 INFO:birdwatch.matrix_factorization:epoch 80 0.4118605852127075
06:30:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23359139263629913
06:30:43 INFO:birdwatch.matrix_factorization:epoch 100 0.4072788953781128
06:30:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.23024006187915802
06:30:43 INFO:birdwatch.matrix_factorization:epoch 120 0.404913991689682
06:30:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.22878922522068024
06:30:43 INFO:birdwatch.matrix_factorization:Num epochs: 132
06:30:43 INFO:birdwatch.matrix_factorization:epoch 132 0.4037185311317444
06:30:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2280137538909912
06:30:43 INFO:birdwatch.matrix_factorization:Global Intercept: -0.36482417583465576
06:30:43 INFO:birdwatch.wandb_utils:Finishing W&B run
06:30:43 INFO:birdwatch.scorer:MFGroupScorer_3 Harassment tag consensus elapsed time: 0.55 secs (0.01 mins)
06:30:46 INFO:birdwatch.scorer:MFGroupScorer_3 Helpfulness scores post-harassment elapsed time: 0.08 secs (0.00 mins)
06:30:49 INFO:birdwatch.helpfulness_scores:Unique Raters: 14898
06:30:49 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 25273
06:30:49 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 14553
06:30:49 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 8731
06:30:49 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 396977
06:30:49 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 258422
06:30:52 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:30:52 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:30:52 INFO:birdwatch.wandb_utils:W&B is disabled
06:30:52 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:30:52 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:30:52 DEBUG:wandb:no default config file found in config-defaults.yaml
06:30:52 INFO:birdwatch.matrix_factorization:------------------
06:30:52 INFO:birdwatch.matrix_factorization:Users: 8731, Notes: 35084
06:30:52 INFO:birdwatch.matrix_factorization:initializing notes
06:30:53 INFO:birdwatch.matrix_factorization:initializing users
06:30:53 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:30:53 INFO:birdwatch.matrix_factorization:cuda:0
06:30:53 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 7.365807775624216
06:30:53 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 29.598213263085558
06:30:53 INFO:birdwatch.matrix_factorization:epoch 0 0.38061121106147766
06:30:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.302501916885376
06:30:53 INFO:birdwatch.matrix_factorization:epoch 20 0.08778492361307144
06:30:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04800159111618996
06:30:53 INFO:birdwatch.matrix_factorization:epoch 40 0.08453954011201859
06:30:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04882293939590454
06:30:53 INFO:birdwatch.matrix_factorization:epoch 60 0.08339235931634903
06:30:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04637446254491806
06:30:53 INFO:birdwatch.matrix_factorization:epoch 80 0.08332878351211548
06:30:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04635219648480415
06:30:53 INFO:birdwatch.matrix_factorization:epoch 100 0.08331114053726196
06:30:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.046091869473457336
06:30:53 INFO:birdwatch.matrix_factorization:Num epochs: 103
06:30:53 INFO:birdwatch.matrix_factorization:epoch 103 0.08331115543842316
06:30:53 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.046246279031038284
06:30:53 INFO:birdwatch.matrix_factorization:Global Intercept: 0.18466590344905853
06:30:53 INFO:birdwatch.wandb_utils:Finishing W&B run
06:30:53 INFO:birdwatch.constants:Final round MF elapsed time: 3.39 secs (0.06 mins)
06:30:53 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_3 prescoring, about to call diligence with 258422 final round ratings.
06:30:53 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
      raterParticipantId  internalRaterFactor1
0                     32             -0.710444
1                     37              0.481428
2                     39              0.655926
3                     42             -0.600918
4                    146              0.033643
...                  ...                   ...
8726              814958              0.456963
8727              836866             -0.436618
8728              841324             -0.699419
8729              841637             -0.071458
8730              853365             -0.473776

[8731 rows x 2 columns]
06:30:53 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:30:53 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 8731, vs. num we are initializing: 8731
06:30:53 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:30:53 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 8731
06:30:53 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:30:53 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:30:53 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:30:53 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:30:53 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:30:53 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=15.141386 | time=0.0s
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.054973 | time=0.1s
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.610294 | time=0.1s
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.501540 | time=0.2s
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.456010 | time=0.2s
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.430130 | time=0.3s
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.413443 | time=0.4s
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.402675 | time=0.4s
06:30:53 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.395379 | time=0.5s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.390359 | time=0.5s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.386908 | time=0.6s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.8355, device='cuda:0', requires_grad=True)
06:30:54 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.386816 | time=0.0s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.196752 | time=0.1s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.189623 | time=0.1s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.188601 | time=0.2s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.188571 | time=0.2s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.524418 | time=0.0s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.456799 | time=0.0s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.455892 | time=0.1s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.455856 | time=0.1s
06:30:54 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-0.3125, device='cuda:0', requires_grad=True)
06:30:54 INFO:birdwatch.diligence_model:Low diligence training loss: 2.3869, 1.1886, 0.4559
06:30:54 INFO:birdwatch.scorer:MFGroupScorer_3 Low Diligence MF elapsed time: 1.15 secs (0.02 mins)
06:30:56 INFO:birdwatch.note_ratings:dropped 0 out of 676079 ratings due to NaN factor.
06:31:01 INFO:birdwatch.note_ratings:dropped 0 out of 5890 population sampled ratings due to NaN factor.
06:31:01 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:31:01 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:31:02 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:31:02 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:31:02 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:31:03 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.72 secs (0.01 mins)
06:31:03 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:31:03 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:31:03 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:31:03 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:31:03 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:31:04 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:31:04 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:31:04 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:31:04 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:31:04 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:31:04 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:31:05 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.68 secs (0.01 mins)
06:31:53 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.65 secs (0.79 mins)
06:31:56 INFO:birdwatch.constants:MFGroupScorer_3: Compute tag thresholds for percentiles elapsed time: 3.17 secs (0.05 mins)
06:32:05 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_2 set to: 4
06:32:05 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_2.  Original rating length: 19679338
06:32:05 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:32:07 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:32:08 INFO:birdwatch.scorer:  Ratings after group filter: 204727
06:32:08 INFO:birdwatch.scorer:MFGroupScorer_2 Filter input elapsed time: 2.86 secs (0.05 mins)
06:32:08 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_2: 8cb30e0358ce74e27e9e433bcf2ec3711d208dc0c6cf4f426ccf85b867c51945
06:32:08 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 10168, Num Unique Notes Rated: 1441, Num Unique Raters: 942
06:32:08 INFO:birdwatch.scorer:MFGroupScorer_2 Prepare ratings elapsed time: 0.03 secs (0.00 mins)
06:32:08 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_2: 6c945c682e95076708fce097123577283816d0c669b1f5179605c8c6a8832b65
06:32:09 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_2: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:32:09 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_2: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:32:09 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:32:09 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:32:09 INFO:birdwatch.wandb_utils:W&B is disabled
06:32:09 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:32:09 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:32:09 DEBUG:wandb:no default config file found in config-defaults.yaml
06:32:09 INFO:birdwatch.matrix_factorization:------------------
06:32:09 INFO:birdwatch.matrix_factorization:Users: 942, Notes: 1441
06:32:09 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:32:09 INFO:birdwatch.matrix_factorization:cuda:0
06:32:09 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 7.056210964607911
06:32:09 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 10.794055201698514
06:32:09 INFO:birdwatch.matrix_factorization:epoch 0 6.923319339752197
06:32:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.415637493133545
06:32:09 INFO:birdwatch.matrix_factorization:epoch 20 0.25035059452056885
06:32:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.18580488860607147
06:32:09 INFO:birdwatch.matrix_factorization:epoch 40 0.1318454146385193
06:32:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.08775968849658966
06:32:09 INFO:birdwatch.matrix_factorization:epoch 60 0.10559336841106415
06:32:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06348326057195663
06:32:09 INFO:birdwatch.matrix_factorization:epoch 80 0.0903172641992569
06:32:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04880467429757118
06:32:09 INFO:birdwatch.matrix_factorization:epoch 100 0.08350801467895508
06:32:09 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.043068256229162216
06:32:10 INFO:birdwatch.matrix_factorization:epoch 120 0.08186662942171097
06:32:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04168814793229103
06:32:10 INFO:birdwatch.matrix_factorization:epoch 140 0.08127078413963318
06:32:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.040979091078042984
06:32:10 INFO:birdwatch.matrix_factorization:epoch 160 0.08094372600317001
06:32:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04057399556040764
06:32:10 INFO:birdwatch.matrix_factorization:epoch 180 0.08079558610916138
06:32:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04023366421461105
06:32:10 INFO:birdwatch.matrix_factorization:epoch 200 0.08078010380268097
06:32:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04027669504284859
06:32:10 INFO:birdwatch.matrix_factorization:Num epochs: 207
06:32:10 INFO:birdwatch.matrix_factorization:epoch 207 0.08077920228242874
06:32:10 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04026732221245766
06:32:10 INFO:birdwatch.matrix_factorization:Global Intercept: 0.183371439576149
06:32:10 INFO:birdwatch.wandb_utils:Finishing W&B run
06:32:10 INFO:birdwatch.scorer:MFGroupScorer_2 First MF/stable init elapsed time: 0.51 secs (0.01 mins)
06:32:10 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_2
06:32:11 INFO:birdwatch.note_ratings:dropped 0 out of 90806 ratings due to NaN factor.
06:32:13 INFO:birdwatch.note_ratings:dropped 0 out of 301 population sampled ratings due to NaN factor.
06:32:13 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:32:13 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:32:14 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:32:14 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:32:14 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:32:15 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:32:15 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:32:15 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:32:15 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:32:15 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:32:15 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:32:16 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:32:16 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:32:16 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:32:16 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:32:16 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:32:17 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:32:17 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:33:05 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.92 secs (0.80 mins)
06:33:05 INFO:birdwatch.scorer:MFGroupScorer_2 Compute scored notes elapsed time: 55.66 secs (0.93 mins)
06:33:06 INFO:birdwatch.note_ratings:Total ratings: 204676 post-tombstones and 51 pre-tombstones
06:33:06 INFO:birdwatch.note_ratings:Total ratings created before statuses: 163489, including 163489 post-tombstones and 0 pre-tombstones.
06:33:06 INFO:birdwatch.note_ratings:Total valid ratings: 1338
06:33:06 INFO:birdwatch.scorer:MFGroupScorer_2 Compute valid ratings elapsed time: 0.57 secs (0.01 mins)
06:33:06 INFO:birdwatch.scorer:MFGroupScorer_2 Helpfulness scores pre-harassment  elapsed time: 0.03 secs (0.00 mins)
06:33:06 INFO:birdwatch.helpfulness_scores:Unique Raters: 942
06:33:06 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 1758
06:33:06 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 848
06:33:06 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 428
06:33:06 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 10168
06:33:06 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 5482
06:33:06 INFO:birdwatch.scorer:MFGroupScorer_2 Filtering by helpfulness score elapsed time: 0.01 secs (0.00 mins)
06:33:06 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:33:06 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    3672
1     131
dtype: int64
06:33:06 INFO:birdwatch.tag_consensus:Number of rows with no tag label 1679
06:33:06 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 0, Num Unique Notes Rated: 0, Num Unique Raters: 0
06:33:06 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown Series([], dtype: int64)
06:33:06 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:33:06 INFO:birdwatch.tag_consensus:No valid data for notHelpfulSpamHarassmentOrAbuse, returning None and aborting notHelpfulSpamHarassmentOrAbuse model training.
06:33:06 INFO:birdwatch.scorer:MFGroupScorer_2 Harassment tag consensus elapsed time: 0.01 secs (0.00 mins)
06:33:09 INFO:birdwatch.scorer:MFGroupScorer_2 Helpfulness scores post-harassment elapsed time: 0.04 secs (0.00 mins)
06:33:12 INFO:birdwatch.helpfulness_scores:Unique Raters: 942
06:33:12 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 1758
06:33:12 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 848
06:33:12 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 428
06:33:12 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 10168
06:33:12 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 5482
06:33:15 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:33:15 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:33:15 INFO:birdwatch.wandb_utils:W&B is disabled
06:33:15 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:33:15 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:33:15 DEBUG:wandb:no default config file found in config-defaults.yaml
06:33:15 INFO:birdwatch.matrix_factorization:------------------
06:33:15 INFO:birdwatch.matrix_factorization:Users: 428, Notes: 1421
06:33:15 INFO:birdwatch.matrix_factorization:initializing notes
06:33:15 INFO:birdwatch.matrix_factorization:initializing users
06:33:15 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:33:15 INFO:birdwatch.matrix_factorization:cuda:0
06:33:15 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 3.857846586910626
06:33:15 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 12.80841121495327
06:33:15 INFO:birdwatch.matrix_factorization:epoch 0 0.3708012104034424
06:33:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.28879788517951965
06:33:15 INFO:birdwatch.matrix_factorization:epoch 20 0.07301073521375656
06:33:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03016354888677597
06:33:15 INFO:birdwatch.matrix_factorization:epoch 40 0.06981359422206879
06:33:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03041721135377884
06:33:15 INFO:birdwatch.matrix_factorization:epoch 60 0.06802913546562195
06:33:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02656719461083412
06:33:15 INFO:birdwatch.matrix_factorization:epoch 80 0.06788469105958939
06:33:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.026961039751768112
06:33:15 INFO:birdwatch.matrix_factorization:epoch 100 0.06783492118120193
06:33:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0266298558562994
06:33:15 INFO:birdwatch.matrix_factorization:Num epochs: 102
06:33:15 INFO:birdwatch.matrix_factorization:epoch 102 0.06783677637577057
06:33:15 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02669198252260685
06:33:15 INFO:birdwatch.matrix_factorization:Global Intercept: 0.1795894205570221
06:33:15 INFO:birdwatch.wandb_utils:Finishing W&B run
06:33:15 INFO:birdwatch.constants:Final round MF elapsed time: 3.13 secs (0.05 mins)
06:33:15 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_2 prescoring, about to call diligence with 5482 final round ratings.
06:33:15 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
     raterParticipantId  internalRaterFactor1
0                    44             -0.702758
1                   779              0.581464
2                   950              0.416292
3                  1363             -0.721772
4                  1554              0.607537
..                  ...                   ...
423              577951             -0.715420
424              606405             -0.527538
425              607407             -0.114703
426              620544              0.544872
427              904475              0.598060

[428 rows x 2 columns]
06:33:15 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:33:15 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 428, vs. num we are initializing: 428
06:33:15 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:33:15 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 428
06:33:15 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:33:15 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:33:15 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:33:15 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:33:15 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:33:15 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=17.212467 | time=0.0s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=2.902334 | time=0.1s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.438072 | time=0.1s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.299357 | time=0.2s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.231142 | time=0.2s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.189063 | time=0.3s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.161530 | time=0.3s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.144085 | time=0.4s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.132412 | time=0.5s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.124356 | time=0.5s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.118583 | time=0.6s
06:33:15 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-1.0948, device='cuda:0', requires_grad=True)
06:33:15 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:33:15 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.118420 | time=0.0s
06:33:16 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.818100 | time=0.1s
06:33:16 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.811190 | time=0.1s
06:33:16 INFO:birdwatch.reputation_matrix_factorization:epoch=080 | loss=0.810258 | time=0.2s
06:33:16 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:33:16 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.468480 | time=0.0s
06:33:16 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.404216 | time=0.0s
06:33:16 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.403341 | time=0.1s
06:33:16 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.403306 | time=0.1s
06:33:16 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-1.6858, device='cuda:0', requires_grad=True)
06:33:16 INFO:birdwatch.diligence_model:Low diligence training loss: 2.1186, 0.8103, 0.4033
06:33:16 INFO:birdwatch.scorer:MFGroupScorer_2 Low Diligence MF elapsed time: 0.90 secs (0.02 mins)
06:33:17 INFO:birdwatch.note_ratings:dropped 0 out of 90806 ratings due to NaN factor.
06:33:19 INFO:birdwatch.note_ratings:dropped 0 out of 301 population sampled ratings due to NaN factor.
06:33:19 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:33:19 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:33:20 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:33:20 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:33:20 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:33:21 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:33:21 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:33:21 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:33:21 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:33:21 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:33:21 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:33:22 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:33:22 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:33:22 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:33:22 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:33:22 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:33:23 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:33:23 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.68 secs (0.01 mins)
06:34:11 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.80 secs (0.80 mins)
06:34:14 INFO:birdwatch.constants:MFGroupScorer_2: Compute tag thresholds for percentiles elapsed time: 2.89 secs (0.05 mins)
06:34:23 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_1 set to: 4
06:34:23 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_1.  Original rating length: 19679338
06:34:23 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:34:25 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:34:26 INFO:birdwatch.scorer:  Ratings after group filter: 1258680
06:34:26 INFO:birdwatch.scorer:MFGroupScorer_1 Filter input elapsed time: 2.94 secs (0.05 mins)
06:34:26 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_1: 48658356bf30fbe7184770fe8f267864bae15abba5ce51dc22475a8b647f2e4f
06:34:27 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 631910, Num Unique Notes Rated: 48709, Num Unique Raters: 23555
06:34:27 INFO:birdwatch.scorer:MFGroupScorer_1 Prepare ratings elapsed time: 0.17 secs (0.00 mins)
06:34:27 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_1: 537389ceb50ab87ba465aa37a843868cda9a901a0f7df996714386f1d5a7bb67
06:34:28 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_1: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:34:28 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_1: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:34:28 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:34:28 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:34:28 INFO:birdwatch.wandb_utils:W&B is disabled
06:34:28 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:34:28 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:34:28 DEBUG:wandb:no default config file found in config-defaults.yaml
06:34:28 INFO:birdwatch.matrix_factorization:------------------
06:34:28 INFO:birdwatch.matrix_factorization:Users: 23555, Notes: 48709
06:34:28 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:34:28 INFO:birdwatch.matrix_factorization:cuda:0
06:34:28 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 12.973167176497157
06:34:28 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 26.827000636807472
06:34:28 INFO:birdwatch.matrix_factorization:epoch 0 6.5440473556518555
06:34:28 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.068451404571533
06:34:28 INFO:birdwatch.matrix_factorization:epoch 20 0.2755745053291321
06:34:28 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.21748201549053192
06:34:28 INFO:birdwatch.matrix_factorization:epoch 40 0.12591911852359772
06:34:28 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.08665254712104797
06:34:28 INFO:birdwatch.matrix_factorization:epoch 60 0.0944499671459198
06:34:28 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.059466686099767685
06:34:28 INFO:birdwatch.matrix_factorization:epoch 80 0.09012554585933685
06:34:28 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05538006126880646
06:34:28 INFO:birdwatch.matrix_factorization:epoch 100 0.0895603746175766
06:34:28 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.054995011538267136
06:34:28 INFO:birdwatch.matrix_factorization:epoch 120 0.08948734402656555
06:34:28 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05499556288123131
06:34:29 INFO:birdwatch.matrix_factorization:epoch 140 0.08947785198688507
06:34:29 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05496464669704437
06:34:29 INFO:birdwatch.matrix_factorization:Num epochs: 146
06:34:29 INFO:birdwatch.matrix_factorization:epoch 146 0.0894773006439209
06:34:29 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05497528612613678
06:34:29 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17004454135894775
06:34:29 INFO:birdwatch.wandb_utils:Finishing W&B run
06:34:29 INFO:birdwatch.scorer:MFGroupScorer_1 First MF/stable init elapsed time: 0.57 secs (0.01 mins)
06:34:29 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_1
06:34:30 INFO:birdwatch.note_ratings:dropped 0 out of 920905 ratings due to NaN factor.
06:34:36 INFO:birdwatch.note_ratings:dropped 0 out of 12625 population sampled ratings due to NaN factor.
06:34:37 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:34:37 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:34:37 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:34:37 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:34:37 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:34:38 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.72 secs (0.01 mins)
06:34:38 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:34:38 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:34:39 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:34:39 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:34:39 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:34:39 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.57 secs (0.01 mins)
06:34:39 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:34:39 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:34:40 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:34:40 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:34:40 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:34:40 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.68 secs (0.01 mins)
06:35:28 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.10 secs (0.80 mins)
06:35:29 INFO:birdwatch.scorer:MFGroupScorer_1 Compute scored notes elapsed time: 60.20 secs (1.00 mins)
06:35:29 INFO:birdwatch.note_ratings:Total ratings: 1258522 post-tombstones and 158 pre-tombstones
06:35:29 INFO:birdwatch.note_ratings:Total ratings created before statuses: 980186, including 980186 post-tombstones and 0 pre-tombstones.
06:35:30 INFO:birdwatch.note_ratings:Total valid ratings: 46779
06:35:30 INFO:birdwatch.scorer:MFGroupScorer_1 Compute valid ratings elapsed time: 0.88 secs (0.01 mins)
06:35:30 INFO:birdwatch.scorer:MFGroupScorer_1 Helpfulness scores pre-harassment  elapsed time: 0.06 secs (0.00 mins)
06:35:30 INFO:birdwatch.helpfulness_scores:Unique Raters: 23555
06:35:30 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 36523
06:35:30 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 22600
06:35:30 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 13048
06:35:30 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 631910
06:35:30 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 404638
06:35:30 INFO:birdwatch.scorer:MFGroupScorer_1 Filtering by helpfulness score elapsed time: 0.06 secs (0.00 mins)
06:35:30 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:35:30 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    253278
1     22371
dtype: int64
06:35:30 INFO:birdwatch.tag_consensus:Number of rows with no tag label 128989
06:35:30 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 159049, Num Unique Notes Rated: 16420, Num Unique Raters: 7367
06:35:30 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    147868
1     11181
dtype: int64
06:35:30 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:35:30 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.07029909021748015
06:35:30 INFO:birdwatch.matrix_factorization:Using pos weight: 13.224935157857077 with BCEWithLogitsLoss
06:35:30 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:35:30 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:35:30 INFO:birdwatch.wandb_utils:W&B is disabled
06:35:30 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:35:30 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:35:30 DEBUG:wandb:no default config file found in config-defaults.yaml
06:35:30 INFO:birdwatch.matrix_factorization:------------------
06:35:30 INFO:birdwatch.matrix_factorization:Users: 7367, Notes: 16420
06:35:30 INFO:birdwatch.matrix_factorization:initializing notes
06:35:30 INFO:birdwatch.matrix_factorization:initializing users
06:35:30 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:35:30 INFO:birdwatch.matrix_factorization:cuda:0
06:35:30 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 9.686297198538368
06:35:30 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 21.58938509569703
06:35:30 INFO:birdwatch.matrix_factorization:epoch 0 3.2993531227111816
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.432893991470337
06:35:30 INFO:birdwatch.matrix_factorization:epoch 20 0.8228509426116943
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.4460950195789337
06:35:30 INFO:birdwatch.matrix_factorization:epoch 40 0.5532814264297485
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.34279799461364746
06:35:30 INFO:birdwatch.matrix_factorization:epoch 60 0.45498067140579224
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2712247669696808
06:35:30 INFO:birdwatch.matrix_factorization:epoch 80 0.36699914932250977
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.18939077854156494
06:35:30 INFO:birdwatch.matrix_factorization:epoch 100 0.34917157888412476
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.18264658749103546
06:35:30 INFO:birdwatch.matrix_factorization:epoch 120 0.3463449478149414
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.181656152009964
06:35:30 INFO:birdwatch.matrix_factorization:epoch 140 0.34596437215805054
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.18163739144802094
06:35:30 INFO:birdwatch.matrix_factorization:Num epochs: 150
06:35:30 INFO:birdwatch.matrix_factorization:epoch 150 0.34594136476516724
06:35:30 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.18162962794303894
06:35:30 INFO:birdwatch.matrix_factorization:Global Intercept: -0.25644925236701965
06:35:30 INFO:birdwatch.wandb_utils:Finishing W&B run
06:35:30 INFO:birdwatch.scorer:MFGroupScorer_1 Harassment tag consensus elapsed time: 0.56 secs (0.01 mins)
06:35:33 INFO:birdwatch.scorer:MFGroupScorer_1 Helpfulness scores post-harassment elapsed time: 0.08 secs (0.00 mins)
06:35:36 INFO:birdwatch.helpfulness_scores:Unique Raters: 23555
06:35:36 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 36523
06:35:36 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 22547
06:35:36 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 12995
06:35:36 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 631910
06:35:36 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 399725
06:35:39 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:35:39 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:35:39 INFO:birdwatch.wandb_utils:W&B is disabled
06:35:39 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:35:39 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:35:39 DEBUG:wandb:no default config file found in config-defaults.yaml
06:35:39 INFO:birdwatch.matrix_factorization:------------------
06:35:39 INFO:birdwatch.matrix_factorization:Users: 12995, Notes: 48616
06:35:39 INFO:birdwatch.matrix_factorization:initializing notes
06:35:39 INFO:birdwatch.matrix_factorization:initializing users
06:35:39 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:35:39 INFO:birdwatch.matrix_factorization:cuda:0
06:35:39 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 8.222087378640778
06:35:39 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 30.759907656791075
06:35:39 INFO:birdwatch.matrix_factorization:epoch 0 0.4045495390892029
06:35:39 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.329781174659729
06:35:39 INFO:birdwatch.matrix_factorization:epoch 20 0.0884946659207344
06:35:39 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05077420920133591
06:35:39 INFO:birdwatch.matrix_factorization:epoch 40 0.08504962176084518
06:35:39 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.051550328731536865
06:35:39 INFO:birdwatch.matrix_factorization:epoch 60 0.08397926390171051
06:35:39 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04930920526385307
06:35:39 INFO:birdwatch.matrix_factorization:epoch 80 0.08390332758426666
06:35:39 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.049124911427497864
06:35:39 INFO:birdwatch.matrix_factorization:epoch 100 0.08389081060886383
06:35:39 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04894787818193436
06:35:39 INFO:birdwatch.matrix_factorization:Num epochs: 103
06:35:39 INFO:birdwatch.matrix_factorization:epoch 103 0.08388829976320267
06:35:39 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04909064248204231
06:35:39 INFO:birdwatch.matrix_factorization:Global Intercept: 0.16857470571994781
06:35:39 INFO:birdwatch.wandb_utils:Finishing W&B run
06:35:39 INFO:birdwatch.constants:Final round MF elapsed time: 3.21 secs (0.05 mins)
06:35:39 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_1 prescoring, about to call diligence with 399725 final round ratings.
06:35:39 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
       raterParticipantId  internalRaterFactor1
0                       5              0.703527
1                      52              0.725783
2                      54              0.492675
3                     130             -0.665197
4                     137              0.691497
...                   ...                   ...
12990              860484              0.155976
12991              865568              0.505473
12992              886108             -0.452902
12993              892103             -0.559906
12994              895553              0.471842

[12995 rows x 2 columns]
06:35:39 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:35:39 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 12995, vs. num we are initializing: 12995
06:35:39 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:35:39 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 12995
06:35:39 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:35:39 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:35:39 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:35:39 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:35:39 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:35:39 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:35:39 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=21.594496 | time=0.0s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.445397 | time=0.1s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.841943 | time=0.1s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.708493 | time=0.2s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.662299 | time=0.2s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.639757 | time=0.3s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.626405 | time=0.4s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.617605 | time=0.4s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.611542 | time=0.5s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.607240 | time=0.5s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.603906 | time=0.6s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(0.1567, device='cuda:0', requires_grad=True)
06:35:40 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.603808 | time=0.0s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.429353 | time=0.1s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.420566 | time=0.1s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.419751 | time=0.2s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.419726 | time=0.2s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.523603 | time=0.0s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.443985 | time=0.0s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.442926 | time=0.1s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.442884 | time=0.1s
06:35:40 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(0.7838, device='cuda:0', requires_grad=True)
06:35:40 INFO:birdwatch.diligence_model:Low diligence training loss: 2.6039, 1.4197, 0.4429
06:35:40 INFO:birdwatch.scorer:MFGroupScorer_1 Low Diligence MF elapsed time: 1.25 secs (0.02 mins)
06:35:42 INFO:birdwatch.note_ratings:dropped 0 out of 920905 ratings due to NaN factor.
06:35:48 INFO:birdwatch.note_ratings:dropped 0 out of 12625 population sampled ratings due to NaN factor.
06:35:48 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:35:48 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:35:49 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:35:49 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:35:49 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:35:50 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.86 secs (0.01 mins)
06:35:50 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:35:50 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:35:51 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.97 secs (0.02 mins)
06:35:51 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:35:51 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:35:52 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.88 secs (0.01 mins)
06:35:52 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:35:52 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:35:53 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.91 secs (0.02 mins)
06:35:53 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:35:53 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.17 secs (0.00 mins)
06:35:54 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 1.03 secs (0.02 mins)
06:36:46 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 52.13 secs (0.87 mins)
06:36:50 INFO:birdwatch.constants:MFGroupScorer_1: Compute tag thresholds for percentiles elapsed time: 3.55 secs (0.06 mins)
06:36:59 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_14 set to: 4
06:37:00 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_14.  Original rating length: 19679338
06:37:00 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:37:02 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:37:03 INFO:birdwatch.scorer:  Ratings after group filter: 1603465
06:37:03 INFO:birdwatch.scorer:MFGroupScorer_14 Filter input elapsed time: 3.28 secs (0.05 mins)
06:37:04 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_14: 8141dede0620cbfa726f1de2920c390a9efa809439378b7161ae9107524a7d30
06:37:04 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 661655, Num Unique Notes Rated: 65940, Num Unique Raters: 18939
06:37:04 INFO:birdwatch.scorer:MFGroupScorer_14 Prepare ratings elapsed time: 0.23 secs (0.00 mins)
06:37:04 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_14: fd14110312b23154f17bc3d3b23f8e28a4b0c3d0e8eea2e4b7a61bf6f6f73b63
06:37:05 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_14: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:37:05 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_14: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:37:05 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:37:05 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:37:05 INFO:birdwatch.wandb_utils:W&B is disabled
06:37:05 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:37:05 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:37:05 DEBUG:wandb:no default config file found in config-defaults.yaml
06:37:05 INFO:birdwatch.matrix_factorization:------------------
06:37:05 INFO:birdwatch.matrix_factorization:Users: 18939, Notes: 65940
06:37:05 INFO:birdwatch.matrix_factorization:learning rate set to :0.02
06:37:05 INFO:birdwatch.matrix_factorization:cuda:0
06:37:05 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 10.034197755535335
06:37:05 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 34.93611067110196
06:37:05 INFO:birdwatch.matrix_factorization:epoch 0 0.5172685980796814
06:37:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.5166035294532776
06:37:05 INFO:birdwatch.matrix_factorization:epoch 20 0.20479482412338257
06:37:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.14317584037780762
06:37:06 INFO:birdwatch.matrix_factorization:epoch 40 0.1687021702528
06:37:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.12484674900770187
06:37:06 INFO:birdwatch.matrix_factorization:epoch 60 0.1254551261663437
06:37:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0817018374800682
06:37:06 INFO:birdwatch.matrix_factorization:epoch 80 0.10009116679430008
06:37:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06339631229639053
06:37:06 INFO:birdwatch.matrix_factorization:epoch 100 0.09286712110042572
06:37:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06042815372347832
06:37:06 INFO:birdwatch.matrix_factorization:epoch 120 0.09111227095127106
06:37:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.060344256460666656
06:37:06 INFO:birdwatch.matrix_factorization:epoch 140 0.09060131758451462
06:37:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06049254536628723
06:37:06 INFO:birdwatch.matrix_factorization:epoch 160 0.09039812535047531
06:37:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06063583120703697
06:37:06 INFO:birdwatch.matrix_factorization:Num epochs: 177
06:37:06 INFO:birdwatch.matrix_factorization:epoch 177 0.09032369405031204
06:37:06 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06073365733027458
06:37:07 INFO:birdwatch.matrix_factorization:------------------
06:37:07 INFO:birdwatch.matrix_factorization:Users: 18939, Notes: 65940
06:37:07 INFO:birdwatch.matrix_factorization:learning rate set to :0.02
06:37:07 INFO:birdwatch.matrix_factorization:cuda:0
06:37:07 INFO:birdwatch.matrix_factorization:epoch 0 0.1980668157339096
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.5166428089141846
06:37:07 INFO:birdwatch.matrix_factorization:epoch 20 0.09468701481819153
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.16201993823051453
06:37:07 INFO:birdwatch.matrix_factorization:epoch 40 0.08615437150001526
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1629304736852646
06:37:07 INFO:birdwatch.matrix_factorization:epoch 60 0.06493376940488815
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09254971146583557
06:37:07 INFO:birdwatch.matrix_factorization:epoch 80 0.05457356199622154
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07419759780168533
06:37:07 INFO:birdwatch.matrix_factorization:epoch 100 0.05128168314695358
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07271518558263779
06:37:07 INFO:birdwatch.matrix_factorization:epoch 120 0.05040286108851433
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07323064655065536
06:37:07 INFO:birdwatch.matrix_factorization:epoch 140 0.05009950324892998
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07330192625522614
06:37:07 INFO:birdwatch.matrix_factorization:epoch 160 0.0499381497502327
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07338272035121918
06:37:07 INFO:birdwatch.matrix_factorization:Num epochs: 172
06:37:07 INFO:birdwatch.matrix_factorization:epoch 172 0.04987877979874611
06:37:07 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07344205677509308
06:37:07 INFO:birdwatch.matrix_factorization:Global Intercept: 0.19306039810180664
06:37:07 INFO:birdwatch.wandb_utils:Finishing W&B run
06:37:07 INFO:birdwatch.scorer:MFGroupScorer_14 First MF/stable init elapsed time: 2.19 secs (0.04 mins)
06:37:07 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_14
06:37:10 INFO:birdwatch.note_ratings:dropped 0 out of 1287721 ratings due to NaN factor.
06:37:23 INFO:birdwatch.note_ratings:dropped 0 out of 2808 population sampled ratings due to NaN factor.
06:37:24 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:37:24 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:37:24 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.66 secs (0.01 mins)
06:37:24 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:37:24 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:37:25 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.76 secs (0.01 mins)
06:37:25 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:37:25 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:37:26 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:37:26 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:37:26 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:37:26 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:37:26 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:37:26 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:37:27 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:37:27 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:37:27 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:37:28 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.73 secs (0.01 mins)
06:38:19 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 51.64 secs (0.86 mins)
06:38:20 INFO:birdwatch.scorer:MFGroupScorer_14 Compute scored notes elapsed time: 72.39 secs (1.21 mins)
06:38:21 INFO:birdwatch.note_ratings:Total ratings: 1603078 post-tombstones and 387 pre-tombstones
06:38:21 INFO:birdwatch.note_ratings:Total ratings created before statuses: 1315016, including 1314992 post-tombstones and 24 pre-tombstones.
06:38:21 INFO:birdwatch.note_ratings:Total valid ratings: 24943
06:38:21 INFO:birdwatch.scorer:MFGroupScorer_14 Compute valid ratings elapsed time: 1.17 secs (0.02 mins)
06:38:21 INFO:birdwatch.scorer:MFGroupScorer_14 Helpfulness scores pre-harassment  elapsed time: 0.06 secs (0.00 mins)
06:38:21 INFO:birdwatch.helpfulness_scores:Unique Raters: 18939
06:38:21 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 42184
06:38:21 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 11445
06:38:21 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 8307
06:38:21 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 661655
06:38:21 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 393989
06:38:21 INFO:birdwatch.scorer:MFGroupScorer_14 Filtering by helpfulness score elapsed time: 0.07 secs (0.00 mins)
06:38:21 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:38:21 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    226646
1     16854
dtype: int64
06:38:21 INFO:birdwatch.tag_consensus:Number of rows with no tag label 150489
06:38:21 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 107970, Num Unique Notes Rated: 13006, Num Unique Raters: 4234
06:38:21 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    103121
1      4849
dtype: int64
06:38:21 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:38:21 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.044910623321292954
06:38:21 INFO:birdwatch.matrix_factorization:Using pos weight: 21.26644669003918 with BCEWithLogitsLoss
06:38:21 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:38:21 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:38:21 INFO:birdwatch.wandb_utils:W&B is disabled
06:38:21 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:38:21 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:38:21 DEBUG:wandb:no default config file found in config-defaults.yaml
06:38:21 INFO:birdwatch.matrix_factorization:------------------
06:38:21 INFO:birdwatch.matrix_factorization:Users: 4234, Notes: 13006
06:38:21 INFO:birdwatch.matrix_factorization:initializing notes
06:38:21 INFO:birdwatch.matrix_factorization:initializing users
06:38:21 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:38:21 INFO:birdwatch.matrix_factorization:cuda:0
06:38:21 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 8.301553129324928
06:38:21 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 25.500708549834673
06:38:21 INFO:birdwatch.matrix_factorization:epoch 0 3.0112791061401367
06:38:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.1640849113464355
06:38:21 INFO:birdwatch.matrix_factorization:epoch 20 0.622956395149231
06:38:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1982877254486084
06:38:21 INFO:birdwatch.matrix_factorization:epoch 40 0.36401689052581787
06:38:21 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1633164882659912
06:38:22 INFO:birdwatch.matrix_factorization:epoch 60 0.32502231001853943
06:38:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.15599703788757324
06:38:22 INFO:birdwatch.matrix_factorization:epoch 80 0.31965285539627075
06:38:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1559324562549591
06:38:22 INFO:birdwatch.matrix_factorization:epoch 100 0.31891798973083496
06:38:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.15605267882347107
06:38:22 INFO:birdwatch.matrix_factorization:epoch 120 0.31881260871887207
06:38:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.15607085824012756
06:38:22 INFO:birdwatch.matrix_factorization:epoch 140 0.31879717111587524
06:38:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1560683399438858
06:38:22 INFO:birdwatch.matrix_factorization:Num epochs: 149
06:38:22 INFO:birdwatch.matrix_factorization:epoch 149 0.31879597902297974
06:38:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.15607205033302307
06:38:22 INFO:birdwatch.matrix_factorization:Global Intercept: -0.2857557237148285
06:38:22 INFO:birdwatch.wandb_utils:Finishing W&B run
06:38:22 INFO:birdwatch.scorer:MFGroupScorer_14 Harassment tag consensus elapsed time: 0.72 secs (0.01 mins)
06:38:25 INFO:birdwatch.scorer:MFGroupScorer_14 Helpfulness scores post-harassment elapsed time: 0.12 secs (0.00 mins)
06:38:29 INFO:birdwatch.helpfulness_scores:Unique Raters: 18939
06:38:29 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 42184
06:38:29 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 11432
06:38:29 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 8294
06:38:29 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 661655
06:38:29 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 391808
06:38:32 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:38:32 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:38:32 INFO:birdwatch.wandb_utils:W&B is disabled
06:38:32 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:38:32 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:38:32 DEBUG:wandb:no default config file found in config-defaults.yaml
06:38:32 INFO:birdwatch.matrix_factorization:------------------
06:38:32 INFO:birdwatch.matrix_factorization:Users: 8294, Notes: 65645
06:38:32 INFO:birdwatch.matrix_factorization:initializing notes
06:38:32 INFO:birdwatch.matrix_factorization:initializing users
06:38:32 INFO:birdwatch.matrix_factorization:learning rate set to :0.02
06:38:32 INFO:birdwatch.matrix_factorization:cuda:0
06:38:32 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 5.968588620610862
06:38:32 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 47.23993248131179
06:38:32 INFO:birdwatch.matrix_factorization:epoch 0 0.1320914328098297
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.10781469941139221
06:38:32 INFO:birdwatch.matrix_factorization:epoch 20 0.09114164113998413
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06016411632299423
06:38:32 INFO:birdwatch.matrix_factorization:epoch 40 0.08718524873256683
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05698546767234802
06:38:32 INFO:birdwatch.matrix_factorization:epoch 60 0.08656343817710876
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05650116503238678
06:38:32 INFO:birdwatch.matrix_factorization:Num epochs: 76
06:38:32 INFO:birdwatch.matrix_factorization:epoch 76 0.0864628404378891
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.056377001106739044
06:38:32 INFO:birdwatch.matrix_factorization:------------------
06:38:32 INFO:birdwatch.matrix_factorization:Users: 8294, Notes: 65645
06:38:32 INFO:birdwatch.matrix_factorization:initializing users
06:38:32 INFO:birdwatch.matrix_factorization:learning rate set to :0.02
06:38:32 INFO:birdwatch.matrix_factorization:cuda:0
06:38:32 INFO:birdwatch.matrix_factorization:epoch 0 0.11628654599189758
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.28818070888519287
06:38:32 INFO:birdwatch.matrix_factorization:epoch 20 0.05691533908247948
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.08219165354967117
06:38:32 INFO:birdwatch.matrix_factorization:epoch 40 0.04915892705321312
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07051507383584976
06:38:32 INFO:birdwatch.matrix_factorization:epoch 60 0.04727623611688614
06:38:32 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0719250813126564
06:38:33 INFO:birdwatch.matrix_factorization:epoch 80 0.04676495119929314
06:38:33 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07228386402130127
06:38:33 INFO:birdwatch.matrix_factorization:epoch 100 0.046572282910346985
06:38:33 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07242128252983093
06:38:33 INFO:birdwatch.matrix_factorization:Num epochs: 106
06:38:33 INFO:birdwatch.matrix_factorization:epoch 106 0.04654739052057266
06:38:33 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07248679548501968
06:38:33 INFO:birdwatch.matrix_factorization:Global Intercept: 0.18104930222034454
06:38:33 INFO:birdwatch.wandb_utils:Finishing W&B run
06:38:33 INFO:birdwatch.constants:Final round MF elapsed time: 3.96 secs (0.07 mins)
06:38:33 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_14 prescoring, about to call diligence with 391808 final round ratings.
06:38:33 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
      raterParticipantId  internalRaterFactor1
0                     60              0.874546
1                     94             -0.485274
2                    126             -0.913360
3                    259              0.387056
4                    296              0.522208
...                  ...                   ...
8289              765520              0.513638
8290              780105              0.609663
8291              799195             -0.653405
8292              816103             -0.697941
8293              821362             -0.956940

[8294 rows x 2 columns]
06:38:33 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:38:33 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 8294, vs. num we are initializing: 8294
06:38:33 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:38:33 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 8294
06:38:33 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:38:33 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:38:33 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:38:33 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:38:33 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:38:33 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=18.641945 | time=0.0s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.266162 | time=0.1s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.740690 | time=0.1s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.617977 | time=0.2s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.569060 | time=0.2s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.542084 | time=0.3s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.524836 | time=0.4s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.513061 | time=0.4s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.504890 | time=0.5s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.499074 | time=0.5s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.494919 | time=0.6s
06:38:33 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.3946, device='cuda:0', requires_grad=True)
06:38:33 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.494802 | time=0.0s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.347541 | time=0.1s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.339012 | time=0.1s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.338143 | time=0.2s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.338143 | time=0.2s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.529448 | time=0.0s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.464834 | time=0.0s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.463961 | time=0.1s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.463927 | time=0.1s
06:38:34 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(0.0751, device='cuda:0', requires_grad=True)
06:38:34 INFO:birdwatch.diligence_model:Low diligence training loss: 2.4949, 1.3381, 0.4639
06:38:34 INFO:birdwatch.scorer:MFGroupScorer_14 Low Diligence MF elapsed time: 1.24 secs (0.02 mins)
06:38:36 INFO:birdwatch.note_ratings:dropped 0 out of 1287721 ratings due to NaN factor.
06:38:49 INFO:birdwatch.note_ratings:dropped 0 out of 2808 population sampled ratings due to NaN factor.
06:38:49 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:38:49 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:38:50 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:38:50 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:38:50 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:38:50 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:38:50 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:38:50 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:38:51 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:38:51 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:38:51 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:38:52 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:38:52 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:38:52 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:38:52 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:38:52 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:38:52 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:38:53 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.68 secs (0.01 mins)
06:39:42 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.75 secs (0.81 mins)
06:39:46 INFO:birdwatch.constants:MFGroupScorer_14: Compute tag thresholds for percentiles elapsed time: 3.34 secs (0.06 mins)
06:39:55 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFGroupScorer_33 set to: 4
06:39:55 INFO:birdwatch.scorer:Filtering ratings for MFGroupScorer_33.  Original rating length: 19679338
06:39:55 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:39:57 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:39:59 INFO:birdwatch.scorer:  Ratings after group filter: 60293
06:39:59 INFO:birdwatch.scorer:MFGroupScorer_33 Filter input elapsed time: 4.79 secs (0.08 mins)
06:39:59 INFO:birdwatch.mf_base_scorer:ratings summary MFGroupScorer_33: 6c6420bdd00fe728f13e0dd6e04f2cc7fd4902091e6a37aff30f5fd935fc3cf1
06:39:59 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 23982, Num Unique Notes Rated: 2488, Num Unique Raters: 1348
06:39:59 INFO:birdwatch.scorer:MFGroupScorer_33 Prepare ratings elapsed time: 0.01 secs (0.00 mins)
06:39:59 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFGroupScorer_33: d7174e29df80c43060ad6e27977f8e35a412879702c0ec9653ea77aea36f4808
06:40:00 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFGroupScorer_33: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:40:00 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFGroupScorer_33: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:40:00 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:40:00 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:40:00 INFO:birdwatch.wandb_utils:W&B is disabled
06:40:00 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:40:00 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:40:00 DEBUG:wandb:no default config file found in config-defaults.yaml
06:40:00 INFO:birdwatch.matrix_factorization:------------------
06:40:00 INFO:birdwatch.matrix_factorization:Users: 1348, Notes: 2488
06:40:00 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:40:00 INFO:birdwatch.matrix_factorization:cuda:0
06:40:00 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 9.639067524115756
06:40:01 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 17.79080118694362
06:40:01 INFO:birdwatch.matrix_factorization:epoch 0 6.677217483520508
06:40:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.171086311340332
06:40:01 INFO:birdwatch.matrix_factorization:epoch 20 0.20682036876678467
06:40:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.14142465591430664
06:40:01 INFO:birdwatch.matrix_factorization:epoch 40 0.09093178808689117
06:40:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.047566454857587814
06:40:01 INFO:birdwatch.matrix_factorization:epoch 60 0.06037850305438042
06:40:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.022905893623828888
06:40:01 INFO:birdwatch.matrix_factorization:epoch 80 0.057076141238212585
06:40:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.019723789766430855
06:40:01 INFO:birdwatch.matrix_factorization:epoch 100 0.056596655398607254
06:40:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.019623417407274246
06:40:01 INFO:birdwatch.matrix_factorization:epoch 120 0.05653370916843414
06:40:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.019555164501070976
06:40:01 INFO:birdwatch.matrix_factorization:Num epochs: 140
06:40:01 INFO:birdwatch.matrix_factorization:epoch 140 0.056525763124227524
06:40:01 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.019519802182912827
06:40:01 INFO:birdwatch.matrix_factorization:Global Intercept: 0.16740530729293823
06:40:01 INFO:birdwatch.wandb_utils:Finishing W&B run
06:40:01 INFO:birdwatch.scorer:MFGroupScorer_33 First MF/stable init elapsed time: 0.38 secs (0.01 mins)
06:40:01 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFGroupScorer_33
06:40:02 INFO:birdwatch.note_ratings:dropped 0 out of 35658 ratings due to NaN factor.
06:40:03 INFO:birdwatch.note_ratings:dropped 0 out of 406 population sampled ratings due to NaN factor.
06:40:03 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:40:03 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:40:04 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:40:04 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:40:04 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:40:05 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.69 secs (0.01 mins)
06:40:05 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:40:05 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:40:05 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:40:05 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:40:05 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:40:06 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:40:06 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:40:06 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:40:06 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:40:06 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:40:07 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:40:07 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.67 secs (0.01 mins)
06:40:55 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 47.85 secs (0.80 mins)
06:40:55 INFO:birdwatch.scorer:MFGroupScorer_33 Compute scored notes elapsed time: 54.53 secs (0.91 mins)
06:40:56 INFO:birdwatch.note_ratings:Total ratings: 60293 post-tombstones and 0 pre-tombstones
06:40:56 INFO:birdwatch.note_ratings:Total ratings created before statuses: 45550, including 45550 post-tombstones and 0 pre-tombstones.
06:40:56 INFO:birdwatch.note_ratings:Total valid ratings: 2492
06:40:56 INFO:birdwatch.scorer:MFGroupScorer_33 Compute valid ratings elapsed time: 0.53 secs (0.01 mins)
06:40:56 INFO:birdwatch.scorer:MFGroupScorer_33 Helpfulness scores pre-harassment  elapsed time: 0.03 secs (0.00 mins)
06:40:56 INFO:birdwatch.helpfulness_scores:Unique Raters: 1348
06:40:56 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 2218
06:40:56 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 1573
06:40:56 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 684
06:40:56 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 23982
06:40:56 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 13601
06:40:56 INFO:birdwatch.scorer:MFGroupScorer_33 Filtering by helpfulness score elapsed time: 0.01 secs (0.00 mins)
06:40:56 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:40:56 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    9772
1     627
dtype: int64
06:40:56 INFO:birdwatch.tag_consensus:Number of rows with no tag label 3202
06:40:56 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 3046, Num Unique Notes Rated: 462, Num Unique Raters: 246
06:40:56 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    2954
1      92
dtype: int64
06:40:56 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:40:56 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.030203545633617858
06:40:56 INFO:birdwatch.matrix_factorization:Using pos weight: 32.108695652173914 with BCEWithLogitsLoss
06:40:56 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:40:56 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:40:56 INFO:birdwatch.wandb_utils:W&B is disabled
06:40:56 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:40:56 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:40:56 DEBUG:wandb:no default config file found in config-defaults.yaml
06:40:56 INFO:birdwatch.matrix_factorization:------------------
06:40:56 INFO:birdwatch.matrix_factorization:Users: 246, Notes: 462
06:40:56 INFO:birdwatch.matrix_factorization:initializing notes
06:40:56 INFO:birdwatch.matrix_factorization:initializing users
06:40:56 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:40:56 INFO:birdwatch.matrix_factorization:cuda:0
06:40:56 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 6.593073593073593
06:40:56 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 12.382113821138212
06:40:56 INFO:birdwatch.matrix_factorization:epoch 0 2.4511218070983887
06:40:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.6006280779838562
06:40:56 INFO:birdwatch.matrix_factorization:epoch 20 0.6553530693054199
06:40:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.17159703373908997
06:40:56 INFO:birdwatch.matrix_factorization:epoch 40 0.3307188153266907
06:40:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1093185544013977
06:40:56 INFO:birdwatch.matrix_factorization:epoch 60 0.27354004979133606
06:40:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0984400138258934
06:40:56 INFO:birdwatch.matrix_factorization:epoch 80 0.26571106910705566
06:40:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09921130537986755
06:40:56 INFO:birdwatch.matrix_factorization:epoch 100 0.2634319067001343
06:40:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09777290374040604
06:40:56 INFO:birdwatch.matrix_factorization:Num epochs: 111
06:40:56 INFO:birdwatch.matrix_factorization:epoch 111 0.2585209608078003
06:40:56 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0940713882446289
06:40:56 INFO:birdwatch.matrix_factorization:Global Intercept: -0.2199801206588745
06:40:56 INFO:birdwatch.wandb_utils:Finishing W&B run
06:40:56 INFO:birdwatch.scorer:MFGroupScorer_33 Harassment tag consensus elapsed time: 0.29 secs (0.00 mins)
06:40:59 INFO:birdwatch.scorer:MFGroupScorer_33 Helpfulness scores post-harassment elapsed time: 0.04 secs (0.00 mins)
06:41:02 INFO:birdwatch.helpfulness_scores:Unique Raters: 1348
06:41:02 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 2218
06:41:02 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 1573
06:41:02 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 684
06:41:02 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 23982
06:41:02 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 13601
06:41:05 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:41:05 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:41:05 INFO:birdwatch.wandb_utils:W&B is disabled
06:41:05 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:41:05 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:41:05 DEBUG:wandb:no default config file found in config-defaults.yaml
06:41:05 INFO:birdwatch.matrix_factorization:------------------
06:41:05 INFO:birdwatch.matrix_factorization:Users: 684, Notes: 2469
06:41:05 INFO:birdwatch.matrix_factorization:initializing notes
06:41:05 INFO:birdwatch.matrix_factorization:initializing users
06:41:05 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:41:05 INFO:birdwatch.matrix_factorization:cuda:0
06:41:05 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 5.508707978938841
06:41:05 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 19.88450292397661
06:41:05 INFO:birdwatch.matrix_factorization:epoch 0 0.4512677788734436
06:41:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.3716180622577667
06:41:05 INFO:birdwatch.matrix_factorization:epoch 20 0.062635637819767
06:41:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.020057063549757004
06:41:05 INFO:birdwatch.matrix_factorization:epoch 40 0.05458931624889374
06:41:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.017739366739988327
06:41:05 INFO:birdwatch.matrix_factorization:epoch 60 0.053215742111206055
06:41:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.017106859013438225
06:41:05 INFO:birdwatch.matrix_factorization:epoch 80 0.05293654650449753
06:41:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.01605110429227352
06:41:05 INFO:birdwatch.matrix_factorization:epoch 100 0.05292348563671112
06:41:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.01598719321191311
06:41:05 INFO:birdwatch.matrix_factorization:Num epochs: 101
06:41:05 INFO:birdwatch.matrix_factorization:epoch 101 0.05292348563671112
06:41:05 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.01598719321191311
06:41:05 INFO:birdwatch.matrix_factorization:Global Intercept: 0.1664188802242279
06:41:05 INFO:birdwatch.wandb_utils:Finishing W&B run
06:41:05 INFO:birdwatch.constants:Final round MF elapsed time: 3.09 secs (0.05 mins)
06:41:05 INFO:birdwatch.mf_base_scorer:In MFGroupScorer_33 prescoring, about to call diligence with 13601 final round ratings.
06:41:05 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
     raterParticipantId  internalRaterFactor1
0                   397              0.468199
1                   543             -0.920323
2                   566              0.536621
3                   592             -0.594105
4                   876             -0.744420
..                  ...                   ...
679              648292             -0.633696
680              648697             -0.607807
681              672032             -0.722638
682              680626             -0.692994
683              712267             -0.628838

[684 rows x 2 columns]
06:41:05 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:41:05 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 684, vs. num we are initializing: 684
06:41:05 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:41:05 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 684
06:41:05 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:41:05 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:41:05 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:41:05 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:41:05 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:41:05 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=14.753464 | time=0.0s
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=2.672352 | time=0.1s
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.316918 | time=0.1s
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.213938 | time=0.2s
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.162820 | time=0.2s
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.128273 | time=0.3s
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.104868 | time=0.4s
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.088034 | time=0.4s
06:41:05 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.075672 | time=0.5s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.066681 | time=0.5s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.060382 | time=0.6s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-1.2862, device='cuda:0', requires_grad=True)
06:41:06 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.060210 | time=0.0s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.705573 | time=0.1s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.700707 | time=0.1s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.699450 | time=0.2s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=0.699410 | time=0.2s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.376728 | time=0.0s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.329467 | time=0.0s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.328802 | time=0.1s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:epoch=070 | loss=0.328780 | time=0.1s
06:41:06 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-1.8951, device='cuda:0', requires_grad=True)
06:41:06 INFO:birdwatch.diligence_model:Low diligence training loss: 2.0604, 0.6994, 0.3288
06:41:06 INFO:birdwatch.scorer:MFGroupScorer_33 Low Diligence MF elapsed time: 0.94 secs (0.02 mins)
06:41:07 INFO:birdwatch.note_ratings:dropped 0 out of 35658 ratings due to NaN factor.
06:41:08 INFO:birdwatch.note_ratings:dropped 0 out of 406 population sampled ratings due to NaN factor.
06:41:09 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:41:09 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:41:09 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.59 secs (0.01 mins)
06:41:09 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:41:09 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:41:10 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:41:10 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:41:10 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:41:10 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:41:10 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:41:10 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:41:11 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.56 secs (0.01 mins)
06:41:11 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:41:11 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:41:12 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:41:12 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:41:12 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:41:12 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.68 secs (0.01 mins)
06:42:02 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 50.10 secs (0.84 mins)
06:42:06 INFO:birdwatch.constants:MFGroupScorer_33: Compute tag thresholds for percentiles elapsed time: 3.46 secs (0.06 mins)
06:42:15 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFTopicScorer_Unassigned set to: 4
06:42:16 INFO:birdwatch.scorer:Filtering ratings for MFTopicScorer_Unassigned.  Original rating length: 19679338
06:42:16 INFO:birdwatch.scorer:  Ratings after topic filter: 0
06:42:16 INFO:birdwatch.scorer:  Ratings after group filter: 0
06:42:16 INFO:birdwatch.scorer:MFTopicScorer_Unassigned Filter input elapsed time: 0.38 secs (0.01 mins)
06:42:19 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFTopicScorer_UkraineConflict set to: 4
06:42:19 INFO:birdwatch.scorer:Filtering ratings for MFTopicScorer_UkraineConflict.  Original rating length: 19679338
06:42:21 INFO:birdwatch.scorer:  Ratings after topic filter: 642853
06:42:21 INFO:birdwatch.scorer:  Ratings after group filter: 642853
06:42:21 INFO:birdwatch.scorer:MFTopicScorer_UkraineConflict Filter input elapsed time: 2.11 secs (0.04 mins)
06:42:21 INFO:birdwatch.mf_base_scorer:ratings summary MFTopicScorer_UkraineConflict: a46d0566f8ab6bbc4e28aaf98c212ec12b6aea1c4693d2325af9d251bf5fe96d
06:42:21 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 209018, Num Unique Notes Rated: 14059, Num Unique Raters: 10944
06:42:21 INFO:birdwatch.scorer:MFTopicScorer_UkraineConflict Prepare ratings elapsed time: 0.09 secs (0.00 mins)
06:42:21 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFTopicScorer_UkraineConflict: cbb48f31451e6748de0e0758d25aaf50151577a3eadadeea0a727a090b6c8048
06:42:21 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFTopicScorer_UkraineConflict: 5d51867a991cfab61931b2a767cf65dd284bca178c5a2f6eaa8b4d42ef28ab70
06:42:22 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFTopicScorer_UkraineConflict: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:42:22 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:42:22 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:42:22 INFO:birdwatch.wandb_utils:W&B is disabled
06:42:22 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:42:22 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:42:22 DEBUG:wandb:no default config file found in config-defaults.yaml
06:42:22 INFO:birdwatch.matrix_factorization:------------------
06:42:22 INFO:birdwatch.matrix_factorization:Users: 10944, Notes: 14059
06:42:22 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:42:22 INFO:birdwatch.matrix_factorization:cuda:0
06:42:22 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 14.867202503734262
06:42:22 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 19.098866959064328
06:42:22 INFO:birdwatch.matrix_factorization:epoch 0 7.135273456573486
06:42:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.645074844360352
06:42:22 INFO:birdwatch.matrix_factorization:epoch 20 0.25451669096946716
06:42:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.19952011108398438
06:42:22 INFO:birdwatch.matrix_factorization:epoch 40 0.09521693736314774
06:42:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05928845331072807
06:42:22 INFO:birdwatch.matrix_factorization:epoch 60 0.07302774488925934
06:42:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.039090584963560104
06:42:22 INFO:birdwatch.matrix_factorization:epoch 80 0.07003532350063324
06:42:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.037049662321805954
06:42:22 INFO:birdwatch.matrix_factorization:epoch 100 0.06965861469507217
06:42:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.036691226065158844
06:42:22 INFO:birdwatch.matrix_factorization:epoch 120 0.0696069747209549
06:42:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03673755005002022
06:42:22 INFO:birdwatch.matrix_factorization:Num epochs: 136
06:42:22 INFO:birdwatch.matrix_factorization:epoch 136 0.06960104405879974
06:42:22 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.036699775606393814
06:42:22 INFO:birdwatch.matrix_factorization:Global Intercept: 0.14706790447235107
06:42:22 INFO:birdwatch.wandb_utils:Finishing W&B run
06:42:22 INFO:birdwatch.scorer:MFTopicScorer_UkraineConflict First MF/stable init elapsed time: 0.40 secs (0.01 mins)
06:42:22 INFO:birdwatch.mf_base_scorer:Skipping rep-filtering in prescoring for MFTopicScorer_UkraineConflict
06:42:22 INFO:birdwatch.mf_base_scorer:In MFTopicScorer_UkraineConflict prescoring, about to call diligence with 209018 final round ratings.
06:42:22 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
       raterParticipantId  internalRaterFactor1
0                      97              0.610932
1                     435              0.430045
2                     780             -0.678525
3                     939             -0.283762
4                    1089              0.579552
...                   ...                   ...
10939               30002             -0.503036
10940               18983             -0.659027
10941                 382              0.484392
10942               61529              0.448925
10943               15636              0.515114

[10944 rows x 2 columns]
06:42:22 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:42:22 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 10944, vs. num we are initializing: 10944
06:42:22 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:42:22 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 10944
06:42:22 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:42:22 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:42:22 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:42:22 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:42:22 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:42:22 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:42:22 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=20.876020 | time=0.0s
06:42:22 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.524007 | time=0.1s
06:42:22 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.933809 | time=0.1s
06:42:22 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.814421 | time=0.2s
06:42:22 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.776054 | time=0.2s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.758008 | time=0.3s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.747678 | time=0.4s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.741004 | time=0.4s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.736469 | time=0.5s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.733276 | time=0.5s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.730928 | time=0.6s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(0.2712, device='cuda:0', requires_grad=True)
06:42:23 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.730860 | time=0.0s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.435399 | time=0.1s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.427861 | time=0.1s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.427861 | time=0.1s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.452441 | time=0.0s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.351754 | time=0.0s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.350518 | time=0.1s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.350465 | time=0.1s
06:42:23 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(1.5613, device='cuda:0', requires_grad=True)
06:42:23 INFO:birdwatch.diligence_model:Low diligence training loss: 2.7309, 1.4279, 0.3505
06:42:23 INFO:birdwatch.scorer:MFTopicScorer_UkraineConflict Low Diligence MF elapsed time: 1.03 secs (0.02 mins)
06:42:23 INFO:birdwatch.note_ratings:dropped 0 out of 253641 ratings due to NaN factor.
06:42:24 INFO:birdwatch.note_ratings:dropped 0 out of 218 population sampled ratings due to NaN factor.
06:42:24 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:42:24 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:24 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:42:24 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:42:24 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:24 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:42:24 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:42:24 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:24 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:42:24 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:42:24 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:24 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:42:24 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:42:24 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:24 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:42:24 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:42:24 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:24 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:42:25 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 0.79 secs (0.01 mins)
06:42:28 INFO:birdwatch.constants:MFTopicScorer_UkraineConflict: Compute tag thresholds for percentiles elapsed time: 3.27 secs (0.05 mins)
06:42:37 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFTopicScorer_GazaConflict set to: 4
06:42:37 INFO:birdwatch.scorer:Filtering ratings for MFTopicScorer_GazaConflict.  Original rating length: 19679338
06:42:39 INFO:birdwatch.scorer:  Ratings after topic filter: 1449309
06:42:39 INFO:birdwatch.scorer:  Ratings after group filter: 1449309
06:42:39 INFO:birdwatch.scorer:MFTopicScorer_GazaConflict Filter input elapsed time: 1.82 secs (0.03 mins)
06:42:40 INFO:birdwatch.mf_base_scorer:ratings summary MFTopicScorer_GazaConflict: 085205df3a14b6419a7d49251fb3994a1661f08705b8ab0430a20f1b7b8dfaed
06:42:40 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 741251, Num Unique Notes Rated: 46986, Num Unique Raters: 27697
06:42:40 INFO:birdwatch.scorer:MFTopicScorer_GazaConflict Prepare ratings elapsed time: 0.20 secs (0.00 mins)
06:42:40 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFTopicScorer_GazaConflict: dc9fae2481090bf28eec376388c44040cede9661017b3ac0d75543f178bfa1c7
06:42:40 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFTopicScorer_GazaConflict: 47fd4c6de8c162179d2d6060ecc3224936066ba4db18451f90c874dd1d49220a
06:42:41 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFTopicScorer_GazaConflict: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:42:41 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:42:41 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:42:41 INFO:birdwatch.wandb_utils:W&B is disabled
06:42:41 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:42:41 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:42:41 DEBUG:wandb:no default config file found in config-defaults.yaml
06:42:41 INFO:birdwatch.matrix_factorization:------------------
06:42:41 INFO:birdwatch.matrix_factorization:Users: 27697, Notes: 46986
06:42:41 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:42:41 INFO:birdwatch.matrix_factorization:cuda:0
06:42:41 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 15.775997105520794
06:42:41 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 26.762862403870454
06:42:41 INFO:birdwatch.matrix_factorization:epoch 0 6.942385673522949
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.467983722686768
06:42:41 INFO:birdwatch.matrix_factorization:epoch 20 0.2908686399459839
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.2343737930059433
06:42:41 INFO:birdwatch.matrix_factorization:epoch 40 0.09416388720273972
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05894807353615761
06:42:41 INFO:birdwatch.matrix_factorization:epoch 60 0.0706193819642067
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03746803104877472
06:42:41 INFO:birdwatch.matrix_factorization:epoch 80 0.06752541661262512
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03503613546490669
06:42:41 INFO:birdwatch.matrix_factorization:epoch 100 0.06711463630199432
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03465430065989494
06:42:41 INFO:birdwatch.matrix_factorization:epoch 120 0.06706157326698303
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03461996838450432
06:42:41 INFO:birdwatch.matrix_factorization:epoch 140 0.06705465912818909
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03459688648581505
06:42:41 INFO:birdwatch.matrix_factorization:Num epochs: 141
06:42:41 INFO:birdwatch.matrix_factorization:epoch 141 0.06705465912818909
06:42:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03459688648581505
06:42:41 INFO:birdwatch.matrix_factorization:Global Intercept: 0.1452772617340088
06:42:41 INFO:birdwatch.wandb_utils:Finishing W&B run
06:42:41 INFO:birdwatch.scorer:MFTopicScorer_GazaConflict First MF/stable init elapsed time: 0.60 secs (0.01 mins)
06:42:41 INFO:birdwatch.mf_base_scorer:Skipping rep-filtering in prescoring for MFTopicScorer_GazaConflict
06:42:41 INFO:birdwatch.mf_base_scorer:In MFTopicScorer_GazaConflict prescoring, about to call diligence with 741251 final round ratings.
06:42:42 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
       raterParticipantId  internalRaterFactor1
0                       5             -0.494397
1                      12             -0.672721
2                      53              0.624982
3                      99              0.580592
4                     102             -0.675370
...                   ...                   ...
27692               61242              0.542738
27693              141322              0.635114
27694               55553              0.485688
27695               50119              0.499891
27696               72158              0.620525

[27697 rows x 2 columns]
06:42:42 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:42:42 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 27697, vs. num we are initializing: 27697
06:42:42 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:42:42 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 27697
06:42:42 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:42:42 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:42:42 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:42:42 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:42:42 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:42:42 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=26.520197 | time=0.0s
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.770749 | time=0.1s
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=3.028643 | time=0.2s
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.884522 | time=0.2s
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.844680 | time=0.3s
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.828335 | time=0.4s
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.819882 | time=0.5s
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.814940 | time=0.6s
06:42:42 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.811874 | time=0.6s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.809898 | time=0.7s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.808535 | time=0.8s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(0.8069, device='cuda:0', requires_grad=True)
06:42:43 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.808497 | time=0.0s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.510778 | time=0.1s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.504041 | time=0.2s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=080 | loss=1.503151 | time=0.2s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.417062 | time=0.0s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.325519 | time=0.0s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.324368 | time=0.1s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.324321 | time=0.1s
06:42:43 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(2.2967, device='cuda:0', requires_grad=True)
06:42:43 INFO:birdwatch.diligence_model:Low diligence training loss: 2.8085, 1.5032, 0.3243
06:42:43 INFO:birdwatch.scorer:MFTopicScorer_GazaConflict Low Diligence MF elapsed time: 1.74 secs (0.03 mins)
06:42:44 INFO:birdwatch.note_ratings:dropped 0 out of 836586 ratings due to NaN factor.
06:42:46 INFO:birdwatch.note_ratings:dropped 0 out of 828 population sampled ratings due to NaN factor.
06:42:46 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:42:46 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:46 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:42:46 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:42:46 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:42:46 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.03 secs (0.00 mins)
06:42:46 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:42:46 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:46 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.03 secs (0.00 mins)
06:42:46 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:42:46 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:46 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:42:46 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:42:46 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:42:46 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.02 secs (0.00 mins)
06:42:46 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:42:46 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:42:46 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.03 secs (0.00 mins)
06:42:48 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 1.56 secs (0.03 mins)
06:42:51 INFO:birdwatch.constants:MFTopicScorer_GazaConflict: Compute tag thresholds for percentiles elapsed time: 3.50 secs (0.06 mins)
06:43:00 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFTopicScorer_MessiRonaldo set to: 4
06:43:00 INFO:birdwatch.scorer:Filtering ratings for MFTopicScorer_MessiRonaldo.  Original rating length: 19679338
06:43:02 INFO:birdwatch.scorer:  Ratings after topic filter: 29608
06:43:02 INFO:birdwatch.scorer:  Ratings after group filter: 29608
06:43:02 INFO:birdwatch.scorer:MFTopicScorer_MessiRonaldo Filter input elapsed time: 1.48 secs (0.02 mins)
06:43:02 INFO:birdwatch.mf_base_scorer:ratings summary MFTopicScorer_MessiRonaldo: 9d107e758ff5577e3ba1a68cfc087de88faf46431c0105a539d7cb5ea238dcab
06:43:02 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 37, Num Unique Notes Rated: 7, Num Unique Raters: 29
06:43:02 INFO:birdwatch.scorer:MFTopicScorer_MessiRonaldo Prepare ratings elapsed time: 0.01 secs (0.00 mins)
06:43:02 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFTopicScorer_MessiRonaldo: dded86f6dac76b4718fea26aeb56de22bf970af50d67382d976558b2e609cfb4
06:43:02 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFTopicScorer_MessiRonaldo: bc2e666733476978b22a19b2c1c16002785fb804650cdef116ccf6df88e9117a
06:43:02 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFTopicScorer_MessiRonaldo: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:43:02 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:43:02 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:43:02 INFO:birdwatch.wandb_utils:W&B is disabled
06:43:02 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:43:02 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:43:02 DEBUG:wandb:no default config file found in config-defaults.yaml
06:43:02 INFO:birdwatch.matrix_factorization:------------------
06:43:02 INFO:birdwatch.matrix_factorization:Users: 29, Notes: 7
06:43:02 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:43:02 INFO:birdwatch.matrix_factorization:cuda:0
06:43:02 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 5.285714285714286
06:43:02 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 1.2758620689655173
06:43:02 INFO:birdwatch.matrix_factorization:epoch 0 7.281660556793213
06:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.76763391494751
06:43:02 INFO:birdwatch.matrix_factorization:epoch 20 0.15466462075710297
06:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07802902162075043
06:43:02 INFO:birdwatch.matrix_factorization:epoch 40 0.06471042335033417
06:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.015309596434235573
06:43:02 INFO:birdwatch.matrix_factorization:epoch 60 0.044908903539180756
06:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0057196165435016155
06:43:02 INFO:birdwatch.matrix_factorization:epoch 80 0.040981393307447433
06:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0019994487520307302
06:43:02 INFO:birdwatch.matrix_factorization:Num epochs: 99
06:43:02 INFO:birdwatch.matrix_factorization:epoch 99 0.0404999665915966
06:43:02 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0017257280414924026
06:43:02 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17738643288612366
06:43:02 INFO:birdwatch.wandb_utils:Finishing W&B run
06:43:02 INFO:birdwatch.scorer:MFTopicScorer_MessiRonaldo First MF/stable init elapsed time: 0.24 secs (0.00 mins)
06:43:02 INFO:birdwatch.mf_base_scorer:Skipping rep-filtering in prescoring for MFTopicScorer_MessiRonaldo
06:43:02 INFO:birdwatch.mf_base_scorer:In MFTopicScorer_MessiRonaldo prescoring, about to call diligence with 37 final round ratings.
06:43:02 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
    raterParticipantId  internalRaterFactor1
0               141669             -0.217640
1                 3332              0.548360
2                95266             -0.614587
3               183471             -0.628516
4                49950             -0.107669
5                16003              0.613362
6               108584             -0.742477
7                40077             -0.700533
8                61419             -0.776977
9               122505             -0.728102
10               64723              0.611937
11               92345             -0.585331
12               72846             -0.614354
13               87452             -0.128100
14              381555              0.317085
15               50529             -0.694454
16               12740              0.613704
17              137931              0.531161
18               38222              0.324079
19               77267              0.405332
20               91842             -0.054569
21              124851              0.255307
22               18690              0.256057
23              115257              0.253641
24                5689             -0.591846
25                7295             -0.603303
26                 499             -0.588632
27               27311             -0.585806
28                3493             -0.586836
06:43:02 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:43:02 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 29, vs. num we are initializing: 29
06:43:02 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:43:02 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 29
06:43:02 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:43:02 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:43:02 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:43:02 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:43:02 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:43:02 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:43:02 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=12.377754 | time=0.0s
06:43:02 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=2.008904 | time=0.0s
06:43:02 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.912320 | time=0.1s
06:43:02 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.821950 | time=0.1s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=1.756069 | time=0.2s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=1.706751 | time=0.2s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=1.673434 | time=0.3s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=1.649886 | time=0.3s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=1.633970 | time=0.4s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=1.624249 | time=0.4s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=1.618305 | time=0.5s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-3.1437, device='cuda:0', requires_grad=True)
06:43:03 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=1.618152 | time=0.0s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.116985 | time=0.0s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.116348 | time=0.1s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.114623 | time=0.1s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=110 | loss=0.114549 | time=0.2s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.099722 | time=0.0s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.094244 | time=0.0s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:epoch=045 | loss=0.094080 | time=0.1s
06:43:03 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-4.7111, device='cuda:0', requires_grad=True)
06:43:03 INFO:birdwatch.diligence_model:Low diligence training loss: 1.6183, 0.1145, 0.0941
06:43:03 INFO:birdwatch.scorer:MFTopicScorer_MessiRonaldo Low Diligence MF elapsed time: 0.75 secs (0.01 mins)
06:43:03 INFO:birdwatch.note_ratings:dropped 0 out of 598 ratings due to NaN factor.
06:43:03 INFO:birdwatch.note_ratings:dropped 0 out of 0 population sampled ratings due to NaN factor.
06:43:03 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:43:03 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:03 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:03 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:43:03 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:03 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:03 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:43:03 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:03 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:03 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:43:03 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:03 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:03 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:43:03 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:03 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:03 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:43:03 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:03 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:03 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 0.10 secs (0.00 mins)
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulOtherAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulIncorrectAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulSourcesMissingOrUnreliableAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulOpinionSpeculationOrBiasAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulMissingKeyPointsAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulOutdatedAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulHardToUnderstandAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulArgumentativeOrBiasedAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulOffTopicAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulSpamHarassmentOrAbuseAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulIrrelevantSourcesAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulOpinionSpeculationAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:03 INFO:birdwatch.tag_filter:Warning: No ratings for column notHelpfulNoteNotNeededAdjustedRatio in get_tag_thresholds. Setting threshold to 0.0 arbitrarily.
06:43:06 INFO:birdwatch.constants:MFTopicScorer_MessiRonaldo: Compute tag thresholds for percentiles elapsed time: 2.86 secs (0.05 mins)
06:43:15 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFTopicScorer_Scams set to: 4
06:43:15 INFO:birdwatch.scorer:Filtering ratings for MFTopicScorer_Scams.  Original rating length: 19679338
06:43:16 INFO:birdwatch.scorer:  Ratings after topic filter: 1077455
06:43:16 INFO:birdwatch.scorer:  Ratings after group filter: 1077455
06:43:16 INFO:birdwatch.scorer:MFTopicScorer_Scams Filter input elapsed time: 1.73 secs (0.03 mins)
06:43:17 INFO:birdwatch.mf_base_scorer:ratings summary MFTopicScorer_Scams: b3b6c6bb32432173bac6a904b752ad6740fcc8567a5866dc2033a99d618d1a73
06:43:17 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 229891, Num Unique Notes Rated: 15368, Num Unique Raters: 13674
06:43:17 INFO:birdwatch.scorer:MFTopicScorer_Scams Prepare ratings elapsed time: 0.14 secs (0.00 mins)
06:43:17 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFTopicScorer_Scams: ce358a2b01fe03829c0ebd337dbbb440294fad9c078647943c6cba384c0c5efb
06:43:17 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFTopicScorer_Scams: d34c538efdd7cf8ac2deb3f825b32de991e6cc2d69cc5d44729ce09ef47a321d
06:43:18 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFTopicScorer_Scams: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:43:18 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:43:18 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:43:18 INFO:birdwatch.wandb_utils:W&B is disabled
06:43:18 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:43:18 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:43:18 DEBUG:wandb:no default config file found in config-defaults.yaml
06:43:18 INFO:birdwatch.matrix_factorization:------------------
06:43:18 INFO:birdwatch.matrix_factorization:Users: 13674, Notes: 15368
06:43:18 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:43:18 INFO:birdwatch.matrix_factorization:cuda:0
06:43:18 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 14.959070796460177
06:43:18 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 16.812271464092436
06:43:18 INFO:birdwatch.matrix_factorization:epoch 0 7.2728271484375
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.78587532043457
06:43:18 INFO:birdwatch.matrix_factorization:epoch 20 0.2541784644126892
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.19976995885372162
06:43:18 INFO:birdwatch.matrix_factorization:epoch 40 0.11129078269004822
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0747087225317955
06:43:18 INFO:birdwatch.matrix_factorization:epoch 60 0.08787111192941666
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.055829428136348724
06:43:18 INFO:birdwatch.matrix_factorization:epoch 80 0.08369994163513184
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.052050042897462845
06:43:18 INFO:birdwatch.matrix_factorization:epoch 100 0.08318308740854263
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05179843679070473
06:43:18 INFO:birdwatch.matrix_factorization:epoch 120 0.08311222493648529
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05169077590107918
06:43:18 INFO:birdwatch.matrix_factorization:epoch 140 0.08309668302536011
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.05165867134928703
06:43:18 INFO:birdwatch.matrix_factorization:epoch 160 0.08309318125247955
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.051649581640958786
06:43:18 INFO:birdwatch.matrix_factorization:Num epochs: 171
06:43:18 INFO:birdwatch.matrix_factorization:epoch 171 0.0830891877412796
06:43:18 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.051641661673784256
06:43:18 INFO:birdwatch.matrix_factorization:Global Intercept: 0.15057706832885742
06:43:18 INFO:birdwatch.wandb_utils:Finishing W&B run
06:43:18 INFO:birdwatch.scorer:MFTopicScorer_Scams First MF/stable init elapsed time: 0.48 secs (0.01 mins)
06:43:18 INFO:birdwatch.mf_base_scorer:Skipping rep-filtering in prescoring for MFTopicScorer_Scams
06:43:18 INFO:birdwatch.mf_base_scorer:In MFTopicScorer_Scams prescoring, about to call diligence with 229891 final round ratings.
06:43:18 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
       raterParticipantId  internalRaterFactor1
0                      13             -0.556560
1                      84             -0.624231
2                      95              0.661923
3                     198             -0.489678
4                     218              0.120631
...                   ...                   ...
13669              217864              0.665655
13670               46890             -0.306864
13671                2382             -0.110838
13672               40975              0.539552
13673               16034             -0.578169

[13674 rows x 2 columns]
06:43:18 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:43:18 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 13674, vs. num we are initializing: 13674
06:43:18 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:43:18 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 13674
06:43:18 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:43:18 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:43:18 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:43:18 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:43:18 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:43:18 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:43:18 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=18.431442 | time=0.0s
06:43:18 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.532232 | time=0.1s
06:43:18 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.974380 | time=0.1s
06:43:18 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.850488 | time=0.2s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.802817 | time=0.2s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.777943 | time=0.3s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.762961 | time=0.4s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.753036 | time=0.4s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.746233 | time=0.5s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.741481 | time=0.5s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.737859 | time=0.6s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.3982, device='cuda:0', requires_grad=True)
06:43:19 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.737756 | time=0.0s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.435631 | time=0.1s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.427623 | time=0.1s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.426469 | time=0.2s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.426433 | time=0.2s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.472396 | time=0.0s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.360598 | time=0.0s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.359358 | time=0.1s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:epoch=080 | loss=0.359291 | time=0.1s
06:43:19 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(0.8824, device='cuda:0', requires_grad=True)
06:43:19 INFO:birdwatch.diligence_model:Low diligence training loss: 2.7379, 1.4264, 0.3593
06:43:19 INFO:birdwatch.scorer:MFTopicScorer_Scams Low Diligence MF elapsed time: 1.18 secs (0.02 mins)
06:43:20 INFO:birdwatch.note_ratings:dropped 0 out of 313319 ratings due to NaN factor.
06:43:21 INFO:birdwatch.note_ratings:dropped 0 out of 941 population sampled ratings due to NaN factor.
06:43:21 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:43:21 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:21 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.03 secs (0.00 mins)
06:43:21 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:43:21 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:21 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.04 secs (0.00 mins)
06:43:21 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:43:21 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:21 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.03 secs (0.00 mins)
06:43:21 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:43:21 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:21 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.03 secs (0.00 mins)
06:43:21 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:43:21 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
06:43:21 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.03 secs (0.00 mins)
06:43:21 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:43:21 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:21 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.04 secs (0.00 mins)
06:43:23 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 1.98 secs (0.03 mins)
06:43:27 INFO:birdwatch.constants:MFTopicScorer_Scams: Compute tag thresholds for percentiles elapsed time: 3.16 secs (0.05 mins)
06:43:35 INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFMultiGroupScorer_1 set to: 4
06:43:35 INFO:birdwatch.scorer:Filtering ratings for MFMultiGroupScorer_1.  Original rating length: 19679338
06:43:35 INFO:birdwatch.scorer:  Ratings after topic filter: 19679338
06:43:38 INFO:birdwatch.scorer:  Ratings without assigned group: 0
06:43:38 INFO:birdwatch.scorer:  Ratings after group filter: 976158
06:43:38 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Filter input elapsed time: 3.15 secs (0.05 mins)
06:43:39 INFO:birdwatch.mf_base_scorer:ratings summary MFMultiGroupScorer_1: 6143bc95ee8f212817b5771b178d6816a0fc27f5d2dd053190097aef5d1d7e17
06:43:39 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 282567, Num Unique Notes Rated: 30885, Num Unique Raters: 14119
06:43:39 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Prepare ratings elapsed time: 0.12 secs (0.00 mins)
06:43:39 INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFMultiGroupScorer_1: 6fe8687c8fc7b7df1b1931688516cb8db9726d59d811e2d2f0146865729b6abb
06:43:40 INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFMultiGroupScorer_1: cef745da18e4d1baf835c290139b819dbaa498a4d668de1d119a9c0ee71b70e4
06:43:40 INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFMultiGroupScorer_1: 625b15a606b0a16575ddb706237da8edaf2477568c6288c03ea4d2709af7ebe5
06:43:40 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:43:40 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:43:40 INFO:birdwatch.wandb_utils:W&B is disabled
06:43:40 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:43:40 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:43:40 DEBUG:wandb:no default config file found in config-defaults.yaml
06:43:40 INFO:birdwatch.matrix_factorization:------------------
06:43:40 INFO:birdwatch.matrix_factorization:Users: 14119, Notes: 30885
06:43:40 INFO:birdwatch.matrix_factorization:learning rate set to :1.0
06:43:40 INFO:birdwatch.matrix_factorization:cuda:0
06:43:40 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 9.149004371053909
06:43:40 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 20.01324456406261
06:43:40 INFO:birdwatch.matrix_factorization:epoch 0 6.560535907745361
06:43:40 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.074732780456543
06:43:40 INFO:birdwatch.matrix_factorization:epoch 20 0.2571883499622345
06:43:40 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.19924232363700867
06:43:40 INFO:birdwatch.matrix_factorization:epoch 40 0.1152668446302414
06:43:40 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.07316712290048599
06:43:40 INFO:birdwatch.matrix_factorization:epoch 60 0.08837981522083282
06:43:40 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.050945959985256195
06:43:40 INFO:birdwatch.matrix_factorization:epoch 80 0.08468055725097656
06:43:40 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.047160666435956955
06:43:41 INFO:birdwatch.matrix_factorization:epoch 100 0.08418929576873779
06:43:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.046927276998758316
06:43:41 INFO:birdwatch.matrix_factorization:epoch 120 0.08412796258926392
06:43:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0468815378844738
06:43:41 INFO:birdwatch.matrix_factorization:epoch 140 0.0841197818517685
06:43:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04691202938556671
06:43:41 INFO:birdwatch.matrix_factorization:Num epochs: 141
06:43:41 INFO:birdwatch.matrix_factorization:epoch 141 0.0841197818517685
06:43:41 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04691202938556671
06:43:41 INFO:birdwatch.matrix_factorization:Global Intercept: 0.18059197068214417
06:43:41 INFO:birdwatch.wandb_utils:Finishing W&B run
06:43:41 INFO:birdwatch.scorer:MFMultiGroupScorer_1 First MF/stable init elapsed time: 0.42 secs (0.01 mins)
06:43:41 INFO:birdwatch.mf_base_scorer:Performing rep-filtering for MFMultiGroupScorer_1
06:43:42 INFO:birdwatch.note_ratings:dropped 0 out of 645205 ratings due to NaN factor.
06:43:48 INFO:birdwatch.note_ratings:dropped 0 out of 6386 population sampled ratings due to NaN factor.
06:43:49 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:43:49 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:49 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.62 secs (0.01 mins)
06:43:49 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:43:50 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:43:50 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.73 secs (0.01 mins)
06:43:50 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:43:50 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:51 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.64 secs (0.01 mins)
06:43:51 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:43:51 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:51 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:43:51 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:43:51 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:43:52 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:43:52 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:43:52 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:43:53 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:44:41 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.31 secs (0.81 mins)
06:44:41 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Compute scored notes elapsed time: 60.73 secs (1.01 mins)
06:44:42 INFO:birdwatch.note_ratings:Total ratings: 976066 post-tombstones and 92 pre-tombstones
06:44:42 INFO:birdwatch.note_ratings:Total ratings created before statuses: 777609, including 777609 post-tombstones and 0 pre-tombstones.
06:44:42 INFO:birdwatch.note_ratings:Total valid ratings: 33267
06:44:42 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Compute valid ratings elapsed time: 0.80 secs (0.01 mins)
06:44:42 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Helpfulness scores pre-harassment  elapsed time: 0.05 secs (0.00 mins)
06:44:42 INFO:birdwatch.helpfulness_scores:Unique Raters: 14119
06:44:42 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 30171
06:44:42 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 16172
06:44:42 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 9021
06:44:42 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 282567
06:44:42 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 199390
06:44:42 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Filtering by helpfulness score elapsed time: 0.03 secs (0.00 mins)
06:44:42 INFO:birdwatch.tag_consensus:-------------------Training for tag notHelpfulSpamHarassmentOrAbuse-------------------
06:44:42 INFO:birdwatch.tag_consensus:Pre-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    128718
1     13864
dtype: int64
06:44:42 INFO:birdwatch.tag_consensus:Number of rows with no tag label 56808
06:44:42 INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 47098, Num Unique Notes Rated: 6256, Num Unique Raters: 3384
06:44:42 INFO:birdwatch.tag_consensus:Post-filtering tag label breakdown notHelpfulSpamHarassmentOrAbuseLabel
0    43453
1     3645
dtype: int64
06:44:42 INFO:birdwatch.tag_consensus:Number of rows with no tag label 0
06:44:42 INFO:birdwatch.tag_consensus:notHelpfulSpamHarassmentOrAbuse Positive Rate: 0.07739182130876046
06:44:42 INFO:birdwatch.matrix_factorization:Using pos weight: 11.921262002743484 with BCEWithLogitsLoss
06:44:42 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:44:42 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:44:42 INFO:birdwatch.wandb_utils:W&B is disabled
06:44:42 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:44:42 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:44:42 DEBUG:wandb:no default config file found in config-defaults.yaml
06:44:42 INFO:birdwatch.matrix_factorization:------------------
06:44:42 INFO:birdwatch.matrix_factorization:Users: 3384, Notes: 6256
06:44:42 INFO:birdwatch.matrix_factorization:initializing notes
06:44:42 INFO:birdwatch.matrix_factorization:initializing users
06:44:42 INFO:birdwatch.matrix_factorization:learning rate set to :2.0
06:44:42 INFO:birdwatch.matrix_factorization:cuda:0
06:44:42 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 7.528452685421995
06:44:42 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 13.917848699763594
06:44:42 INFO:birdwatch.matrix_factorization:epoch 0 3.3684346675872803
06:44:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 1.4982218742370605
06:44:42 INFO:birdwatch.matrix_factorization:epoch 20 0.700904369354248
06:44:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.29580357670783997
06:44:42 INFO:birdwatch.matrix_factorization:epoch 40 0.4056825339794159
06:44:42 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.19036665558815002
06:44:43 INFO:birdwatch.matrix_factorization:epoch 60 0.35330307483673096
06:44:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1755065619945526
06:44:43 INFO:birdwatch.matrix_factorization:epoch 80 0.34192341566085815
06:44:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.16896893084049225
06:44:43 INFO:birdwatch.matrix_factorization:epoch 100 0.33886659145355225
06:44:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1670255810022354
06:44:43 INFO:birdwatch.matrix_factorization:Num epochs: 120
06:44:43 INFO:birdwatch.matrix_factorization:epoch 120 0.33726930618286133
06:44:43 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.16557887196540833
06:44:43 INFO:birdwatch.matrix_factorization:Global Intercept: -0.26783499121665955
06:44:43 INFO:birdwatch.wandb_utils:Finishing W&B run
06:44:43 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Harassment tag consensus elapsed time: 0.41 secs (0.01 mins)
06:44:46 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Helpfulness scores post-harassment elapsed time: 0.07 secs (0.00 mins)
06:44:48 INFO:birdwatch.helpfulness_scores:Unique Raters: 14119
06:44:48 INFO:birdwatch.helpfulness_scores:People (Authors or Raters) With Helpfulness Scores: 30171
06:44:48 INFO:birdwatch.helpfulness_scores:Raters Included Based on Helpfulness Scores: 16139
06:44:48 INFO:birdwatch.helpfulness_scores:Included Raters who have rated at least 1 note in the final dataset: 8988
06:44:48 INFO:birdwatch.helpfulness_scores:Number of Ratings Used For 1st Training: 282567
06:44:48 INFO:birdwatch.helpfulness_scores:Number of Ratings for Final Training: 197942
06:44:51 INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
06:44:51 INFO:birdwatch.wandb_utils:Reinitializing W&B run
06:44:51 INFO:birdwatch.wandb_utils:W&B is disabled
06:44:51 DEBUG:git.util:sys.platform='linux', git_executable='git'
06:44:51 DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/lambda/nfs/xnotes/communitynotes-mod, stdin=None, shell=False, universal_newlines=False)
06:44:51 DEBUG:wandb:no default config file found in config-defaults.yaml
06:44:51 INFO:birdwatch.matrix_factorization:------------------
06:44:51 INFO:birdwatch.matrix_factorization:Users: 8988, Notes: 30852
06:44:51 INFO:birdwatch.matrix_factorization:initializing notes
06:44:51 INFO:birdwatch.matrix_factorization:initializing users
06:44:51 INFO:birdwatch.matrix_factorization:learning rate set to :0.2
06:44:51 INFO:birdwatch.matrix_factorization:cuda:0
06:44:51 INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 6.415856346428108
06:44:51 INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 22.022919448153093
06:44:51 INFO:birdwatch.matrix_factorization:epoch 0 0.38246509432792664
06:44:51 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.30420446395874023
06:44:52 INFO:birdwatch.matrix_factorization:epoch 20 0.08158130943775177
06:44:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04121788963675499
06:44:52 INFO:birdwatch.matrix_factorization:epoch 40 0.07884186506271362
06:44:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.042526669800281525
06:44:52 INFO:birdwatch.matrix_factorization:epoch 60 0.07769910991191864
06:44:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04015316441655159
06:44:52 INFO:birdwatch.matrix_factorization:epoch 80 0.0776260569691658
06:44:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04001588374376297
06:44:52 INFO:birdwatch.matrix_factorization:epoch 100 0.07761606574058533
06:44:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.039803918451070786
06:44:52 INFO:birdwatch.matrix_factorization:Num epochs: 103
06:44:52 INFO:birdwatch.matrix_factorization:epoch 103 0.07761340588331223
06:44:52 INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03996403515338898
06:44:52 INFO:birdwatch.matrix_factorization:Global Intercept: 0.17964327335357666
06:44:52 INFO:birdwatch.wandb_utils:Finishing W&B run
06:44:52 INFO:birdwatch.constants:Final round MF elapsed time: 3.28 secs (0.05 mins)
06:44:52 INFO:birdwatch.mf_base_scorer:In MFMultiGroupScorer_1 prescoring, about to call diligence with 197942 final round ratings.
06:44:52 INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
      raterParticipantId  internalRaterFactor1
0                    104              0.724092
1                    139             -0.770045
2                    199             -0.740523
3                    264              0.735006
4                    297              0.647354
...                  ...                   ...
8983              813042              0.779013
8984              819827              0.127069
8985              827740              0.358172
8986              839637             -0.404800
8987              858897              0.455890

[8988 rows x 2 columns]
06:44:52 INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
06:44:52 INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 8988, vs. num we are initializing: 8988
06:44:52 INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
06:44:52 INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 8988
06:44:52 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
06:44:52 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
06:44:52 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
06:44:52 INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
06:44:52 INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
06:44:52 INFO:birdwatch.reputation_matrix_factorization:Round 1:
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=19.498829 | time=0.0s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=3.234252 | time=0.1s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=2.685947 | time=0.1s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=2.551520 | time=0.2s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=2.497174 | time=0.2s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=2.466822 | time=0.3s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=2.447721 | time=0.4s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=2.434412 | time=0.4s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=2.424906 | time=0.5s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=2.418144 | time=0.5s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=2.413244 | time=0.6s
06:44:52 INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-0.3243, device='cuda:0', requires_grad=True)
06:44:52 INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
06:44:52 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.413104 | time=0.0s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.253095 | time=0.1s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.245803 | time=0.1s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.244825 | time=0.2s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:epoch=100 | loss=1.244794 | time=0.2s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
06:44:53 INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.561530 | time=0.0s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.487110 | time=0.0s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.486104 | time=0.1s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:epoch=075 | loss=0.486065 | time=0.1s
06:44:53 INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-0.0942, device='cuda:0', requires_grad=True)
06:44:53 INFO:birdwatch.diligence_model:Low diligence training loss: 2.4132, 1.2448, 0.4861
06:44:53 INFO:birdwatch.scorer:MFMultiGroupScorer_1 Low Diligence MF elapsed time: 1.11 secs (0.02 mins)
06:44:55 INFO:birdwatch.note_ratings:dropped 0 out of 645205 ratings due to NaN factor.
06:45:01 INFO:birdwatch.note_ratings:dropped 0 out of 6386 population sampled ratings due to NaN factor.
06:45:01 INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
06:45:01 INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:45:02 INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:45:02 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
06:45:02 INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.11 secs (0.00 mins)
06:45:02 INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.70 secs (0.01 mins)
06:45:02 INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
06:45:02 INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:45:03 INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.61 secs (0.01 mins)
06:45:03 INFO:birdwatch.scoring_rules:Applying scoring rule: UcbCRNH (v1.0)
06:45:03 INFO:birdwatch.constants:Calling score_notes: UcbCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:45:04 INFO:birdwatch.constants:Applying scoring rule: UcbCRNH (v1.0) elapsed time: 0.58 secs (0.01 mins)
06:45:04 INFO:birdwatch.scoring_rules:Applying scoring rule: RatioCRNH (v1.0)
06:45:04 INFO:birdwatch.constants:Calling score_notes: RatioCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
06:45:04 INFO:birdwatch.constants:Applying scoring rule: RatioCRNH (v1.0) elapsed time: 0.60 secs (0.01 mins)
06:45:04 INFO:birdwatch.scoring_rules:Applying scoring rule: NmCRNH (v1.0)
06:45:04 INFO:birdwatch.constants:Calling score_notes: NmCRNH (v1.0) elapsed time: 0.10 secs (0.00 mins)
06:45:05 INFO:birdwatch.constants:Applying scoring rule: NmCRNH (v1.0) elapsed time: 0.71 secs (0.01 mins)
06:45:53 INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 48.46 secs (0.81 mins)
06:45:57 INFO:birdwatch.constants:MFMultiGroupScorer_1: Compute tag thresholds for percentiles elapsed time: 3.21 secs (0.05 mins)
06:46:06 INFO:birdwatch.run_scoring:----
    Completed individual scorers. Ran in parallel: False.  Succeeded in 3999.06 seconds. 
    Individual scorers: (name, runtime): [('MFCoreWithTopicsScorer', '6.63 mins'), ('MFCoreScorer', '5.38 mins'), ('MFExpansionScorer', '6.83 mins'), ('MFExpansionPlusScorer', '6.97 mins'), ('ReputationScorer', '0.75 mins'), ('MFGroupScorer_13', '3.84 mins'), ('MFGroupScorer_12', '2.25 mins'), ('MFGroupScorer_11', '2.43 mins'), ('MFGroupScorer_10', '2.27 mins'), ('MFGroupScorer_9', '2.38 mins'), ('MFGroupScorer_8', '0.05 mins'), ('MFGroupScorer_7', '2.32 mins'), ('MFGroupScorer_6', '2.42 mins'), ('MFGroupScorer_5', '2.22 mins'), ('MFGroupScorer_4', '2.45 mins'), ('MFGroupScorer_3', '2.62 mins'), ('MFGroupScorer_2', '2.25 mins'), ('MFGroupScorer_1', '2.56 mins'), ('MFGroupScorer_14', '2.87 mins'), ('MFGroupScorer_33', '2.30 mins'), ('MFTopicScorer_Unassigned', '0.01 mins'), ('MFTopicScorer_UkraineConflict', '0.26 mins'), ('MFTopicScorer_GazaConflict', '0.34 mins'), ('MFTopicScorer_MessiRonaldo', '0.19 mins'), ('MFTopicScorer_Scams', '0.30 mins'), ('MFMultiGroupScorer_1', '2.47 mins')]
    ----
06:46:13 INFO:birdwatch.run_scoring:notes total RAM: 188055369 bytes (0.188 GB)
                                    column     dtype       RAM
0                                   noteId     int64  19043544
1                  noteAuthorParticipantId     int64  19043544
2                          createdAtMillis     int64  19043544
3                                  tweetId    object  19043544
4                           classification    object  19043544
5                               believable  category   2380567
6                                  harmful  category   2380567
7                     validationDifficulty  category   2380567
8                          misleadingOther      Int8   4760886
9                   misleadingFactualError      Int8   4760886
10              misleadingManipulatedMedia      Int8   4760886
11           misleadingOutdatedInformation      Int8   4760886
12       misleadingMissingImportantContext      Int8   4760886
13         misleadingUnverifiedClaimAsFact      Int8   4760886
14                        misleadingSatire      Int8   4760886
15                      notMisleadingOther      Int8   4760886
16           notMisleadingFactuallyCorrect      Int8   4760886
17  notMisleadingOutdatedButNotWhenWritten      Int8   4760886
18              notMisleadingClearlySatire      Int8   4760886
19            notMisleadingPersonalOpinion      Int8   4760886
20                      trustworthySources      Int8   4760886
21                                 summary    object  19043544
22                             isMediaNote      Int8   4760886
06:46:13 INFO:birdwatch.run_scoring:ratings total RAM: 2263124126 bytes (2.263 GB)
                                  column     dtype        RAM
0                                  agree      Int8   39358676
1                        createdAtMillis     int64  157434704
2                               disagree      Int8   39358676
3                                helpful      Int8   39358676
4                  helpfulAddressesClaim      Int8   39358676
5                           helpfulClear      Int8   39358676
6                      helpfulEmpathetic      Int8   39358676
7                     helpfulGoodSources      Int8   39358676
8                helpfulImportantContext      Int8   39358676
9                     helpfulInformative      Int8   39358676
10                            helpfulNum   float64  157434704
11                          helpfulOther      Int8   39358676
12               helpfulUnbiasedLanguage      Int8   39358676
13                  helpfulUniqueContext      Int8   39358676
14                      helpfulnessLevel  category   19679470
15                       highVolumeRater      bool   19679338
16                            notHelpful      Int8   39358676
17       notHelpfulArgumentativeOrBiased      Int8   39358676
18            notHelpfulHardToUnderstand      Int8   39358676
19                   notHelpfulIncorrect      Int8   39358676
20           notHelpfulIrrelevantSources      Int8   39358676
21            notHelpfulMissingKeyPoints      Int8   39358676
22               notHelpfulNoteNotNeeded      Int8   39358676
23                    notHelpfulOffTopic      Int8   39358676
24          notHelpfulOpinionSpeculation      Int8   39358676
25    notHelpfulOpinionSpeculationOrBias      Int8   39358676
26                       notHelpfulOther      Int8   39358676
27                    notHelpfulOutdated      Int8   39358676
28  notHelpfulSourcesMissingOrUnreliable      Int8   39358676
29       notHelpfulSpamHarassmentOrAbuse      Int8   39358676
30                                noteId     int64  157434704
31                        ratedOnTweetId     int64  157434704
32                    raterParticipantId     Int64  177114042
33                  ratingSourceBucketed  category   19679462
34                               version      Int8   39358676
35                       correlatedRater      bool   19679338
36                    postSelectionValue   float64  157434704
37        postSelectionValue_note_author   float64  157434704
06:46:13 INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 351729096 bytes (0.352 GB)
                                            column     dtype       RAM
0                                           noteId     int64  21644704
1                          noteAuthorParticipantId     Int64  24350292
2                                  createdAtMillis   float64  21644704
3               timestampMillisOfFirstNonNMRStatus   float64  21644704
4                                firstNonNMRStatus  category   2705712
5                   timestampMillisOfCurrentStatus   float64  21644704
6                                    currentStatus  category   2705720
7              timestampMillisOfLatestNonNMRStatus   float64  21644704
8                           mostRecentNonNMRStatus  category   2705712
9                      timestampMillisOfStatusLock   float64  21644704
10                                    lockedStatus  category   2705720
11                      timestampMillisOfRetroLock   float64  21644704
12                               currentCoreStatus  category   2705800
13                          currentExpansionStatus  category   2705800
14                              currentGroupStatus  category   2705792
15                                currentDecidedBy  category   2706900
16                            currentModelingGroup   float64  21644704
17         timestampMillisOfMostRecentStatusChange   float64  21644704
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  21644704
19                         currentMultiGroupStatus  category   2705792
20                       currentModelingMultiGroup   float64  21644704
21             timestampMinuteOfFinalScoringOutput   float64  21644704
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  21644704
23                                  classification    object  21644704
06:46:13 INFO:birdwatch.run_scoring:userEnrollment total RAM: 79573754 bytes (0.080 GB)
                           column     dtype       RAM
0                   participantId     Int64  12347631
1                 enrollmentState    object  10975672
2  successfulRatingNeededToEarnIn     int64  10975672
3      timestampOfLastStateChange     int64  10975672
4          timestampOfLastEarnOut   float64  10975672
5              modelingPopulation  category   1372091
6                   modelingGroup   float64  10975672
7          numberOfTimesEarnedOut     int64  10975672
06:46:13 INFO:birdwatch.run_scoring:prescoringNoteModelOutput total RAM: 279446904 bytes (0.279 GB)
                            column    dtype       RAM
0                           noteId    int64  50808528
1            internalNoteIntercept  float32  25404264
2              internalNoteFactor1  float32  25404264
3                       scorerName   object  50808528
4        lowDiligenceNoteIntercept  float32  25404264
5          lowDiligenceNoteFactor1  float32  25404264
6  lowDiligenceNoteInterceptRound2  float32  25404264
7          harassmentNoteIntercept  float32  25404264
8            harassmentNoteFactor1  float32  25404264
06:46:13 INFO:birdwatch.run_scoring:prescoringRaterModelOutput total RAM: 367818982 bytes (0.368 GB)
                                          column    dtype       RAM
0                             raterParticipantId    Int64  19941993
1                         internalRaterIntercept  float32   8863108
2                           internalRaterFactor1  float32   8863108
3               internalFirstRoundRaterIntercept  float32   8863108
4                 internalFirstRoundRaterFactor1  float32   8863108
5                         crhCrnhRatioDifference  float64  17726216
6                                  meanNoteScore  float64  17726216
7                                raterAgreeRatio  float64  17726216
8                      aboveHelpfulnessThreshold   object  17726216
9                                     scorerName   object  17726216
10                       internalRaterReputation  float32   8863108
11                    lowDiligenceRaterIntercept  float32   8863108
12                      lowDiligenceRaterFactor1  float32   8863108
13                   lowDiligenceRaterReputation  float32   8863108
14              lowDiligenceRaterInterceptRound2  float32   8863108
15                incorrectTagRatingsMadeByRater    Int64  19941993
16                       totalRatingsMadeByRater  float64  17726216
17                            postSelectionValue  float64  17726216
18                  successfulRatingHelpfulCount  float64  17726216
19               successfulRatingNotHelpfulCount  float64  17726216
20                unsuccessfulRatingHelpfulCount  float64  17726216
21             unsuccessfulRatingNotHelpfulCount  float64  17726216
22                 totalHelpfulHarassmentPenalty  float64  17726216
23  raterAgreeRatioKeyWithHarassmentAbusePenalty  float64  17726216
24                              quasiCliqueValue  float64  17726216
06:46:13 INFO:birdwatch.constants:Logging Prescoring Results RAM usage (before conversion) elapsed time: 0.08 secs (0.00 mins)
06:46:13 INFO:birdwatch.run_scoring:Restoring int64 IDs from Int64.
06:46:13 INFO:birdwatch.run_scoring:Restoration of int64 IDs complete.
06:46:13 INFO:birdwatch.run_scoring:notes total RAM: 188055369 bytes (0.188 GB)
                                    column     dtype       RAM
0                                   noteId     int64  19043544
1                  noteAuthorParticipantId     int64  19043544
2                          createdAtMillis     int64  19043544
3                                  tweetId    object  19043544
4                           classification    object  19043544
5                               believable  category   2380567
6                                  harmful  category   2380567
7                     validationDifficulty  category   2380567
8                          misleadingOther      Int8   4760886
9                   misleadingFactualError      Int8   4760886
10              misleadingManipulatedMedia      Int8   4760886
11           misleadingOutdatedInformation      Int8   4760886
12       misleadingMissingImportantContext      Int8   4760886
13         misleadingUnverifiedClaimAsFact      Int8   4760886
14                        misleadingSatire      Int8   4760886
15                      notMisleadingOther      Int8   4760886
16           notMisleadingFactuallyCorrect      Int8   4760886
17  notMisleadingOutdatedButNotWhenWritten      Int8   4760886
18              notMisleadingClearlySatire      Int8   4760886
19            notMisleadingPersonalOpinion      Int8   4760886
20                      trustworthySources      Int8   4760886
21                                 summary    object  19043544
22                             isMediaNote      Int8   4760886
06:46:13 INFO:birdwatch.run_scoring:ratings total RAM: 2243444788 bytes (2.243 GB)
                                  column     dtype        RAM
0                                  agree      Int8   39358676
1                        createdAtMillis     int64  157434704
2                               disagree      Int8   39358676
3                                helpful      Int8   39358676
4                  helpfulAddressesClaim      Int8   39358676
5                           helpfulClear      Int8   39358676
6                      helpfulEmpathetic      Int8   39358676
7                     helpfulGoodSources      Int8   39358676
8                helpfulImportantContext      Int8   39358676
9                     helpfulInformative      Int8   39358676
10                            helpfulNum   float64  157434704
11                          helpfulOther      Int8   39358676
12               helpfulUnbiasedLanguage      Int8   39358676
13                  helpfulUniqueContext      Int8   39358676
14                      helpfulnessLevel  category   19679470
15                       highVolumeRater      bool   19679338
16                            notHelpful      Int8   39358676
17       notHelpfulArgumentativeOrBiased      Int8   39358676
18            notHelpfulHardToUnderstand      Int8   39358676
19                   notHelpfulIncorrect      Int8   39358676
20           notHelpfulIrrelevantSources      Int8   39358676
21            notHelpfulMissingKeyPoints      Int8   39358676
22               notHelpfulNoteNotNeeded      Int8   39358676
23                    notHelpfulOffTopic      Int8   39358676
24          notHelpfulOpinionSpeculation      Int8   39358676
25    notHelpfulOpinionSpeculationOrBias      Int8   39358676
26                       notHelpfulOther      Int8   39358676
27                    notHelpfulOutdated      Int8   39358676
28  notHelpfulSourcesMissingOrUnreliable      Int8   39358676
29       notHelpfulSpamHarassmentOrAbuse      Int8   39358676
30                                noteId     int64  157434704
31                        ratedOnTweetId     int64  157434704
32                    raterParticipantId     int64  157434704
33                  ratingSourceBucketed  category   19679462
34                               version      Int8   39358676
35                       correlatedRater      bool   19679338
36                    postSelectionValue   float64  157434704
37        postSelectionValue_note_author   float64  157434704
06:46:13 INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 349023508 bytes (0.349 GB)
                                            column     dtype       RAM
0                                           noteId     int64  21644704
1                          noteAuthorParticipantId     int64  21644704
2                                  createdAtMillis   float64  21644704
3               timestampMillisOfFirstNonNMRStatus   float64  21644704
4                                firstNonNMRStatus  category   2705712
5                   timestampMillisOfCurrentStatus   float64  21644704
6                                    currentStatus  category   2705720
7              timestampMillisOfLatestNonNMRStatus   float64  21644704
8                           mostRecentNonNMRStatus  category   2705712
9                      timestampMillisOfStatusLock   float64  21644704
10                                    lockedStatus  category   2705720
11                      timestampMillisOfRetroLock   float64  21644704
12                               currentCoreStatus  category   2705800
13                          currentExpansionStatus  category   2705800
14                              currentGroupStatus  category   2705792
15                                currentDecidedBy  category   2706900
16                            currentModelingGroup   float64  21644704
17         timestampMillisOfMostRecentStatusChange   float64  21644704
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  21644704
19                         currentMultiGroupStatus  category   2705792
20                       currentModelingMultiGroup   float64  21644704
21             timestampMinuteOfFinalScoringOutput   float64  21644704
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  21644704
23                                  classification    object  21644704
06:46:13 INFO:birdwatch.run_scoring:userEnrollment total RAM: 78201795 bytes (0.078 GB)
                           column     dtype       RAM
0                   participantId     int64  10975672
1                 enrollmentState    object  10975672
2  successfulRatingNeededToEarnIn     int64  10975672
3      timestampOfLastStateChange     int64  10975672
4          timestampOfLastEarnOut   float64  10975672
5              modelingPopulation  category   1372091
6                   modelingGroup   float64  10975672
7          numberOfTimesEarnedOut     int64  10975672
06:46:13 INFO:birdwatch.run_scoring:prescoringNoteModelOutput total RAM: 279446904 bytes (0.279 GB)
                            column    dtype       RAM
0                           noteId    int64  50808528
1            internalNoteIntercept  float32  25404264
2              internalNoteFactor1  float32  25404264
3                       scorerName   object  50808528
4        lowDiligenceNoteIntercept  float32  25404264
5          lowDiligenceNoteFactor1  float32  25404264
6  lowDiligenceNoteInterceptRound2  float32  25404264
7          harassmentNoteIntercept  float32  25404264
8            harassmentNoteFactor1  float32  25404264
06:46:13 INFO:birdwatch.run_scoring:prescoringRaterModelOutput total RAM: 365603205 bytes (0.366 GB)
                                          column    dtype       RAM
0                             raterParticipantId    int64  17726216
1                         internalRaterIntercept  float32   8863108
2                           internalRaterFactor1  float32   8863108
3               internalFirstRoundRaterIntercept  float32   8863108
4                 internalFirstRoundRaterFactor1  float32   8863108
5                         crhCrnhRatioDifference  float64  17726216
6                                  meanNoteScore  float64  17726216
7                                raterAgreeRatio  float64  17726216
8                      aboveHelpfulnessThreshold   object  17726216
9                                     scorerName   object  17726216
10                       internalRaterReputation  float32   8863108
11                    lowDiligenceRaterIntercept  float32   8863108
12                      lowDiligenceRaterFactor1  float32   8863108
13                   lowDiligenceRaterReputation  float32   8863108
14              lowDiligenceRaterInterceptRound2  float32   8863108
15                incorrectTagRatingsMadeByRater    Int64  19941993
16                       totalRatingsMadeByRater  float64  17726216
17                            postSelectionValue  float64  17726216
18                  successfulRatingHelpfulCount  float64  17726216
19               successfulRatingNotHelpfulCount  float64  17726216
20                unsuccessfulRatingHelpfulCount  float64  17726216
21             unsuccessfulRatingNotHelpfulCount  float64  17726216
22                 totalHelpfulHarassmentPenalty  float64  17726216
23  raterAgreeRatioKeyWithHarassmentAbusePenalty  float64  17726216
24                              quasiCliqueValue  float64  17726216
06:46:13 INFO:birdwatch.constants:Logging Prescoring Results RAM usage (after conversion) elapsed time: 0.08 secs (0.00 mins)
06:46:14 INFO:birdwatch.run_scoring:prescoringRaterModelOutput total RAM: 370047117 bytes (0.370 GB)
                                          column    dtype       RAM
0                             raterParticipantId    int64  17726808
1                         internalRaterIntercept  float32   8863404
2                           internalRaterFactor1  float32   8863404
3               internalFirstRoundRaterIntercept  float32   8863404
4                 internalFirstRoundRaterFactor1  float32   8863404
5                         crhCrnhRatioDifference  float64  17726808
6                                  meanNoteScore  float64  17726808
7                                raterAgreeRatio  float64  17726808
8                      aboveHelpfulnessThreshold   object  17726808
9                                     scorerName   object  17726808
10                       internalRaterReputation  float32   8863404
11                    lowDiligenceRaterIntercept  float32   8863404
12                      lowDiligenceRaterFactor1  float32   8863404
13                   lowDiligenceRaterReputation  float32   8863404
14              lowDiligenceRaterInterceptRound2  float32   8863404
15                incorrectTagRatingsMadeByRater    Int64  19942659
16                       totalRatingsMadeByRater  float64  17726808
17                            postSelectionValue    Int64  19942659
18                  successfulRatingHelpfulCount  float64  17726808
19               successfulRatingNotHelpfulCount  float64  17726808
20                unsuccessfulRatingHelpfulCount  float64  17726808
21             unsuccessfulRatingNotHelpfulCount  float64  17726808
22                 totalHelpfulHarassmentPenalty  float64  17726808
23  raterAgreeRatioKeyWithHarassmentAbusePenalty  float64  17726808
24                              quasiCliqueValue  Float64  19942659
06:46:14 INFO:birdwatch.constants:Logging Prescoring Results RAM usage (after concatenation) elapsed time: 0.02 secs (0.00 mins)
06:46:22 INFO:birdwatch.pflip_plus_model:labels before ScoringDriftGuard:
LABEL
CRH     98003
FLIP    39210
Name: count, dtype: int64
06:46:22 INFO:birdwatch.pflip_plus_model:labels after ScoringDriftGuard:
LABEL
CRH     95622
FLIP    39210
Name: count, dtype: int64
06:46:29 INFO:birdwatch.constants:Fitting pflip model elapsed time: 15.72 secs (0.26 mins)
